import{d as e,P as s,r as n,aH as a,aI as t,aJ as o,i,L as l,o as d,a as r,b as c,l as p,aK as m,aL as u,aM as h,aN as v,aO as g,aP as w,aQ as _,aR as E,aS as f,aT as x,aU as b,am as y,aV as M,aW as j}from"./vendor-ebf5717c.js";import{c as k,a as L,b as S,d as $,e as C,l as T}from"./mixins-37ca2295.js";import{a as P,c as z}from"./modules-8e459763.js";import{_ as H}from"./_plugin-vue_export-helper-1b428a4d.js";const O={title:"cssd2",order:20},W={class:"page h-100"},A=H(e({__name:"index",setup(e){const H=P(),O=z();let A;s((()=>H.sidebar.opened),(()=>{clearTimeout(A),A=setTimeout(K,300)}));const N=n(),D=new a;let F,I,R,q,B,G,J;D.background=new t("#fff");const K=()=>{const e=N.value;if(!F)return;const s=(null==e?void 0:e.clientWidth)??0,n=(null==e?void 0:e.clientHeight)??0,a=s/n;F.aspect=a,F.updateProjectionMatrix(),I.setSize(s,n),ee&&ee.setSize(s,n)};let Q;const U=()=>{Q=requestAnimationFrame(U),Y(),I.render(D,F)},V=new g;let X;const Y=()=>{m(),ee.render(D,F);const e=V.getElapsedTime();X&&X.position.set(200*Math.sin(e),0,200*Math.cos(e))},Z=n("217");let ee;const se=new o,ne=()=>{const e=new E(50,160,160),s=new f({specular:3355443,shininess:5,map:se.load(`${O.oss}/textures/planets/earth_atmos_2048.jpg`),specularMap:se.load(`${O.oss}/textures/planets/earth_specular_2048.jpg`),normalMap:se.load(`${O.oss}/textures/planets/earth_normal_2048.jpg`),normalScale:new x(.85,.85)}),n=new b(e,s);n.name="earth",D.add(n);const a=document.createElement("div");a.className="dot",a.innerHTML='\n    <div class="bg"></div>\n    <span class="inner">Earth</span>\n  ',a.style.pointerEvents="auto",a.addEventListener("click",(e=>{y.success("click Earth ！")}));const t=new M(a);t.position.set(0,50,0),n.add(t)},ae=()=>{const e=new E(40,160,160),s=new f({shininess:5,map:se.load(`${O.oss}/textures/planets/moon_1024.jpg`)});X=new b(e,s),X.position.set(0,100,0),D.add(X);const n=document.createElement("div");n.className="dot",n.innerHTML='\n    <div class="bg"></div>\n    <span class="inner">Moon</span>\n  ',n.style.pointerEvents="auto",n.addEventListener("click",(e=>{y.success("click Moon ！")}));const a=new M(n);a.position.set(0,40,0),X.add(a)},te=()=>{const e=N.value;I=k(e),F=L(e,1,1e6),B=new h(16777215,1.5),D.add(B),G=C(16777215,1.5),D.add(G),J=new v(16777215,1.5),J.position.set(-500,800,-500),D.add(J),R=S(F,I),R.maxPolarAngle=.45*Math.PI,R.screenSpacePanning=!1,q=$(),D.add(q);let s=new u(50);D.add(s),(()=>{T(D,`${O.oss}/img/sky/${Z.value}`),I.shadowMap.enabled=!0,I.shadowMap.type=w;const e=N.value;ee=new _,ee.domElement.style.pointerEvents="none";const s=(null==e?void 0:e.clientWidth)??0,n=(null==e?void 0:e.clientHeight)??0;ee.setSize(s,n),ee.domElement.style.position="absolute",ee.domElement.style.top="0px";const a=N.value;null==a||a.appendChild(ee.domElement),ne(),ae()})(),(e=>{const s=new j,n={background:"217",display:()=>{D.children.forEach((e=>{if(e.isMesh){const s=e.children.find((e=>e.isCSS2DObject));s.visible=!s.visible}}))},earth:()=>{const e=D.children.find((e=>"earth"==e.name));e?(e.clear(),D.remove(e)):ne()}};s.add(n,"background").options(["216","217","218","219","220","221","222","223","224","225"]).name("切换背景").onChange((e=>{Z.value=e,T(D,`${O.oss}/img/sky/${Z.value}`)})),s.add(n,"display").name("隐藏/展示"),s.add(n,"earth").name("删除/添加地球"),s.domElement.style="position: absolute; top: 10px; right: 10px",e.appendChild(s.domElement)})(e)};return i((()=>{te(),U(),window.addEventListener("resize",K,!1)})),l((()=>{clearTimeout(A),window.addEventListener("resize",K,!1),cancelAnimationFrame(Q);try{D.clear(),I.dispose(),I.forceContextLoss(),I.content=null;let e=I.domElement.getContext("webgl");e&&e.getExtension("WEBGL_lose_context").loseContext()}catch(e){}})),(e,s)=>(d(),r("div",W,[c("div",{ref_key:"containerRef",ref:N,class:p(e.$style.container)},null,2)]))}}),[["__cssModules",{$style:{container:"_container_1kxrr_2"}}]]),N=Object.freeze(Object.defineProperty({__proto__:null,default:A},Symbol.toStringTag,{value:"Module"}));export{O as _,N as i};
