import{d as a,j as e,_ as s,e as o,x as r,s as l,k as d,aw as t,o as n,f as w,u,M as p,b as i,ar as c,as as f,ax as m,an as _,p as g,i as b}from"./vendor-965a3406.js";import{u as v,b as P}from"./index-c44fa773.js";import{_ as h}from"./common-5c3e9118.js";const $={class:"content"},V=(a=>(g("data-v-27ad2f5b"),a=a(),b(),a))((()=>w("div",{class:"clearfix"},[w("span",null,"修改密码")],-1))),y={class:"change-pwd"},x=h(a({__name:"index",setup(a){const g=e(null),b=s({password:"",newPassword:"",confirmNewPassword:""}),h=e(!1),x={password:[{required:!0,trigger:"blur",message:"请输入旧密码。"}],newPassword:[{trigger:"blur",required:!0,validator:(a,e,s)=>{if(""===e)s(new Error("请输入密码"));else{const a=g.value;""!==b.confirmNewPassword&&a.validateField("confirmNewPassword"),(e.length<6||e.length>24)&&s(new Error("确保至少包含6个或最多24个字符"));/^(?![a-zA-Z]+$)(?![A-Z0-9]+$)(?![A-Z\W_!@#$%^&*`~()-+=]+$)(?![a-z0-9]+$)(?![a-z\W_!@#$%^&*`~()-+=]+$)(?![0-9\W_!@#$%^&*`~()-+=]+$)[a-zA-Z0-9\W_!@#$%^&*`~()-+=]/.test(e)||s(new Error("密码必须包含数字，特殊字符，小写字母，大写字母其中三项")),e===b.password&&s(new Error("新密码不能与旧密码相同")),s()}}}],confirmNewPassword:[{trigger:"blur",required:!0,validator:(a,e,s)=>{""===e?s(new Error("请再次输入密码")):e!==b.newPassword?s(new Error("两个输入不匹配！")):s()}}]},N=v(),E=d(),j=()=>{g.value.validate((a=>{if(!a)return!1;h.value=!0;const e={...b};N.changePwd(e).then((async()=>{i({type:"success",title:"提示",message:"密码修改成功！"}),await N.logout(),E.push(`${P}/login`)}))}))},k=()=>{g.value.resetFields()};return(a,e)=>{const s=c,d=f,i=m,v=_,P=t;return n(),o("div",$,[r(P,{class:"box-card"},{header:l((()=>[V])),default:l((()=>[w("div",y,[r(v,{ref_key:"formRef",ref:g,model:u(b),rules:x,"status-icon":"","label-position":"top"},{default:l((()=>[r(d,{label:"旧密码",prop:"password"},{default:l((()=>[r(s,{modelValue:u(b).password,"onUpdate:modelValue":e[0]||(e[0]=a=>u(b).password=a),type:"password",placeholder:"旧密码",clearable:"","show-password":"",autocomplete:"off"},null,8,["modelValue"])])),_:1}),r(d,{label:"新密码",prop:"newPassword"},{default:l((()=>[r(s,{modelValue:u(b).newPassword,"onUpdate:modelValue":e[1]||(e[1]=a=>u(b).newPassword=a),type:"password",placeholder:"新密码",clearable:"","show-password":"",autocomplete:"off"},null,8,["modelValue"])])),_:1}),r(d,{label:"确认新密码",prop:"confirmNewPassword"},{default:l((()=>[r(s,{modelValue:u(b).confirmNewPassword,"onUpdate:modelValue":e[2]||(e[2]=a=>u(b).confirmNewPassword=a),type:"password",placeholder:"确认密码",clearable:"","show-password":"",autocomplete:"off"},null,8,["modelValue"])])),_:1}),r(d,null,{default:l((()=>[r(i,{type:"primary",loading:u(h),onClick:j},{default:l((()=>[p("提交")])),_:1},8,["loading"]),r(i,{onClick:k},{default:l((()=>[p("重置")])),_:1})])),_:1})])),_:1},8,["model"])])])),_:1})])}}}),[["__scopeId","data-v-27ad2f5b"]]);export{x as default};
