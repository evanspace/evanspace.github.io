import{e,j as t,_ as a,w as l,m as i,af as o,g as n,o as s,f as r,x as d,u as c,h,s as u,l as m,k as g,aQ as f,a9 as p,bL as x,bM as w,O as y,bN as v,at as b,aS as k,aR as _}from"./vendor-24f1517a.js";import{f as M,A as z,g as R}from"./common-eab4d250.js";const C=e({__name:"title",props:{name:String,height:Number,color:{type:String,default:"#ffffff"},size:{type:Number,default:80},mouseRadius:{type:Number,default:30}},setup(e){const r=window.requestAnimationFrame||window.requestAnimationFrame||window.requestAnimationFrame||window.requestAnimationFrame||window.requestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},d=e,c=t("canvasRef"),h={x:null,y:null},u=a({sizeX:2,sizeY:2,oldColor:""}),m=a([]),g=t([]);let f,p,x;const w=()=>{let e=c.value;f=e,p=e.getContext("2d"),f.width=window.innerWidth,f.height=d.height||window.innerHeight;let t=document.createElement("canvas");t.width=600,t.height=200;let a=t.getContext("2d");a.textAlign="center",a.textBaseline="middle",a.font=`bold ${d.size}px 微软雅黑`,a.fillStyle=d.color,a.fillText(d.name||"平台",t.width/2,t.height/2),x=t,y()},y=()=>{b(),k(),R()},v=a({ite:0,start:0,end:0}),b=()=>{m.length=0,g.length=0,g.values=[],v.ite=100,v.start=0,v.end=v.start+v.ite},k=()=>{let e=f,t=x,a=(e.width-t.width)/2,l=(e.height-t.height)/2;p.clearRect(0,0,e.width,e.height),p.drawImage(t,a,l,t.width,t.height);const i=p.getImageData(a,l,t.width,t.height);for(let o=0;o<t.width;o+=u.sizeX)for(let e=0;e<t.height;e+=u.sizeY){const n=4*(e*i.width+o);if(i.data[n+3]>=125){const s=`rgba(${i.data[n]} , ${i.data[n+1]} ,  ${i.data[n+2]} , ${i.data[n+3]})`;let r,d=o+20*Math.random(),c=200*-Math.random()+400,h=t.height/2-40*Math.random()+20;r=h<l+t.height/2?300*Math.random():300*-Math.random(),m.push({x:d+a,y:h+l,ex:o+a,ey:e+l,vx:c,vy:r,color:s,a:1500,width:u.sizeX,height:u.sizeY,stop:!1,checkLength:5,maxCheckTimes:10,checkTimes:0});let g=m[m.length-1];_(g)}}},_=e=>{u.oldColor!=e.color&&(p.fillStyle=e.color,u.oldColor=e.color),p.fillRect(e.x-e.width/2,e.y-e.height/2,e.width,e.height)},M=e=>{"WORD_CANVAS"==e.target.id?(h.x=e.clientX-e.target.getBoundingClientRect().left,h.y=e.clientY-e.target.getBoundingClientRect().top):(h.x=null,h.y=null)};let z=!1;const R=()=>{m.sort(((e,t)=>e.ex-t.ex)),z||(z=!0,C((e=>{if(g.length<m.length){v.end>m.length-1&&(v.end=m.length-1);let e=m.slice(v.start,v.end);g.values=g.values.concat(e),v.start+=v.ite,v.end+=v.ite}g.values.forEach((t=>{q(t,e)}))})))},C=e=>{if("function"==typeof e){let t=16;p.clearRect(0,0,f.width,f.height),e(t),r((()=>{C(e)}))}},q=(e,t)=>{A(e,t),_(e),V(e)},A=(e,t)=>{if(e.stop)e.x=e.ex,e.y=e.ey;else{t/=1e3;const a=e.ex-e.x,l=e.ey-e.y,i=Math.atan(l/a);let o=Math.abs(e.a*Math.cos(i));o=e.x>e.ex?-o:o;let n=Math.abs(e.a*Math.sin(i));n=e.y>e.ey?-n:n,e.vx+=o*t,e.vy+=n*t,e.vx*=.95,e.vy*=.95,e.x+=e.vx*t,e.y+=e.vy*t,Math.abs(e.x-e.ex)<=e.checkLength&&Math.abs(e.y-e.ey)<=e.checkLength?(e.checkTimes++,e.checkTimes>=e.maxCheckTimes&&(e.stop=!0)):e.checkTimes=0}},V=e=>{if(!h.x)return void i();const t=d.mouseRadius,a=Math.sqrt(Math.pow(h.x-e.x,2)+Math.pow(h.y-e.y,2)),l=Math.atan((h.y-e.y)/(h.x-e.x));if(a<t){e.stop=!1,e.checkTimes=0,e.recordX||(e.recordX=e.ex,e.recordY=e.ey),e.a=2e3+1e3*(1-a/t);let i=Math.abs((t-a)*Math.cos(l)),o=Math.abs((t-a)*Math.sin(l));i=h.x>e.x?-i:i,o=h.y>e.y?-o:o,e.ex=e.x+i,e.ey=e.y+o}else i();function i(){e.recordX&&(e.stop=!1,e.checkTimes=0,e.a=1500,e.ex=e.recordX,e.ey=e.recordY,e.recordX=null,e.recordY=null)}};return l(d,(()=>{w()})),i((()=>{window.addEventListener("mousemove",M,!1),w(),window.addEventListener("resize",w,!1)})),o((()=>{window.removeEventListener("mousemove",M),window.removeEventListener("resize",w)})),(e,t)=>(s(),n("canvas",{ref_key:"canvasRef",ref:c,id:"WORD_CANVAS",style:{position:"relative","z-index":"2"}},null,512))}}),q={class:"login-page"},A={class:"login-page__panel flex flex-ac"},V={class:"login-page__left f-x"},L=["src"],T={class:"login-page__right"},S=h("div",{class:"bg"},null,-1),X=h("h1",{class:"title"},[h("span",null,"请登录！")],-1),E=e({__name:"index",setup(e){const i={mounted:e=>{e.querySelector("input").focus()}},o=new URL("/imgs/login-icon.png",self.location).href,E=a({username:"",password:"",code:"",randomStr:""}),Y=a({username:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],code:[{required:!0,validator:(e,t,a)=>{!t&&(t=""),""==t?a(new Error("请输入验证码!")):a()},trigger:"blur"}]}),N=t(!1),$=t(""),F=t({}),O=t(null),U=t(null),j=M(),B=m(),K=g(),D=r((()=>z.base.title));l(B,(({query:e})=>{e&&($.value="error"!=e.redirect&&e.redirect||"",F.value=(e=>Object.keys(e).reduce(((t,a)=>("redirect"!==a&&(t[a]=e[a]),t)),{}))(e))}),{immediate:!0});const I=()=>{const e=O.value;e&&e.validate((e=>{e&&j.login(E,U.value).then((e=>{$.value.indexOf(z.base.domian)<0?K.push({path:$.value||`${R}/`,query:F.value}):window.location.href=decodeURIComponent($.value)}))}))},W=({shiftKey:e,key:t,keyCode:a}={})=>{13!=a?(t&&1===t.length&&(N.value=!!(e&&t>="a"&&t<="z"||!e&&t>="A"&&t<="Z")),"CapsLock"===t&&!0===N.value&&(N.value=!1)):I()};return(e,t)=>{const a=b,l=k,r=_,m=f;return s(),n("div",q,[d(C,{name:c(D),height:200,color:"#ffffff",size:35,"mouse-radius":50},null,8,["name"]),h("div",A,[h("div",V,[h("img",{src:c(o),alt:""},null,8,L)]),h("div",T,[h("div",{class:"login-page--right_form",ref_key:"loadingRef",ref:U},[S,X,d(m,{class:"form",ref_key:"loginRef",ref:O,model:c(E),rules:c(Y)},{default:u((()=>[d(l,{prop:"username",key:"username"},{default:u((()=>[p(d(a,{clearable:"",modelValue:c(E).username,"onUpdate:modelValue":t[0]||(t[0]=e=>c(E).username=e),placeholder:"账户",tabindex:"1",size:"large","prefix-icon":c(x),onKeyup:w(I,["enter"])},null,8,["modelValue","prefix-icon"]),[[i]])])),_:1}),d(r,{visible:c(N),content:"大小写锁定",placement:"right",manual:""},{default:u((()=>[d(l,{prop:"password",key:"password"},{default:u((()=>[d(a,{clearable:"",placeholder:"密码",tabindex:"2",modelValue:c(E).password,"onUpdate:modelValue":t[1]||(t[1]=e=>c(E).password=e),type:"password","show-password":"",size:"large","prefix-icon":c(y),onKeyup:W,onBlur:t[2]||(t[2]=e=>N.value=!1)},null,8,["modelValue","prefix-icon"])])),_:1})])),_:1},8,["visible"]),d(l,{prop:"code",key:"code"},{default:u((()=>[d(a,{modelValue:c(E).code,"onUpdate:modelValue":t[3]||(t[3]=e=>c(E).code=e),clearable:"",placeholder:"验证码",maxlength:"6",tabindex:"3",size:"large","prefix-icon":c(v),onKeyup:w(I,["enter"])},null,8,["modelValue","prefix-icon"])])),_:1}),h("div",{class:"btn-wrap"},[h("div",{class:"btn",onClick:I},"login")])])),_:1},8,["model","rules"])],512)])])])}}});export{E as default};
