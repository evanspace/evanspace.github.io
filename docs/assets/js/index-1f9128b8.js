import{e,w as s,i as n,bD as t,bj as a,bE as o,l as i,ag as l,o as d,g as c,h as r,n as p,bF as m,bG as u,bH as h,bI as b,bJ as v,bK as w,bL as g,bb as E,bM as x,bN as _,be as f,c as y,bO as M,bf as k,_ as j}from"./vendor-509147fa.js";import{c as $,a as L,b as C,d as S,e as T,l as z}from"./common-6920ecd0.js";import{c as H,d as P}from"./index-e7e71650.js";const A={class:"page h-100"},F=j(e({__name:"index",setup(e){const j=H(),F=P();let N;s((()=>j.sidebar.opened),(()=>{clearTimeout(N),N=setTimeout(R,300)}));const W=n(),D=new t;let G,I,O,q,B,J,K;D.background=new a("#fff");const R=()=>{const e=W.value;if(!G)return;const s=(null==e?void 0:e.clientWidth)??0,n=(null==e?void 0:e.clientHeight)??0,t=s/n;G.aspect=t,G.updateProjectionMatrix(),I.setSize(s,n),ee&&ee.setSize(s,n)};let Z;const Q=()=>{Z=requestAnimationFrame(Q),X(),I.render(D,G)},U=new v;let V;const X=()=>{m(),ee.render(D,G);const e=U.getElapsedTime();V&&V.position.set(200*Math.sin(e),0,200*Math.cos(e))},Y=n("217");let ee;const se=new o,ne=()=>{const e=new E(50,160,160),s=new x({specular:3355443,shininess:5,map:se.load(`${F.oss}/textures/planets/earth_atmos_2048.jpg`),specularMap:se.load(`${F.oss}/textures/planets/earth_specular_2048.jpg`),normalMap:se.load(`${F.oss}/textures/planets/earth_normal_2048.jpg`),normalScale:new _(.85,.85)}),n=new f(e,s);n.name="earth",D.add(n);const t=document.createElement("div");t.className="dot",t.innerHTML='\n    <div class="bg"></div>\n    <span class="inner">Earth</span>\n  ',t.style.pointerEvents="auto",t.addEventListener("click",(e=>{y.success("click Earth ！")}));const a=new M(t);a.position.set(0,50,0),n.add(a)},te=()=>{const e=new E(40,160,160),s=new x({shininess:5,map:se.load(`${F.oss}/textures/planets/moon_1024.jpg`)});V=new f(e,s),V.position.set(0,100,0),D.add(V);const n=document.createElement("div");n.className="dot",n.innerHTML='\n    <div class="bg"></div>\n    <span class="inner">Moon</span>\n  ',n.style.pointerEvents="auto",n.addEventListener("click",(e=>{y.success("click Moon ！")}));const t=new M(n);t.position.set(0,40,0),V.add(t)},ae=()=>{const e=W.value;I=$(e),G=L(e,1,1e6),B=new h(16777215,1.5),D.add(B),J=T(16777215,1.5),D.add(J),K=new b(16777215,1.5),K.position.set(-500,800,-500),D.add(K),O=C(G,I),O.maxPolarAngle=.45*Math.PI,O.screenSpacePanning=!1,q=S(),D.add(q);let s=new u(50);D.add(s),(()=>{z(D,`${F.oss}/img/sky/${Y.value}`),I.shadowMap.enabled=!0,I.shadowMap.type=w;const e=W.value;ee=new g,ee.domElement.style.pointerEvents="none";const s=(null==e?void 0:e.clientWidth)??0,n=(null==e?void 0:e.clientHeight)??0;ee.setSize(s,n),ee.domElement.style.position="absolute",ee.domElement.style.top="0px";const t=W.value;null==t||t.appendChild(ee.domElement),ne(),te()})(),(e=>{const s=new k,n={background:"217",display:()=>{D.children.forEach((e=>{if(e.isMesh){const s=e.children.find((e=>e.isCSS2DObject));s.visible=!s.visible}}))},earth:()=>{const e=D.children.find((e=>"earth"==e.name));e?(e.clear(),D.remove(e)):ne()}};s.add(n,"background").options(["216","217","218","219","220","221","222","223","224","225"]).name("切换背景").onChange((e=>{Y.value=e,z(D,`${F.oss}/img/sky/${Y.value}`)})),s.add(n,"display").name("隐藏/展示"),s.add(n,"earth").name("删除/添加地球"),s.domElement.style="position: absolute; top: 10px; right: 10px",e.appendChild(s.domElement)})(e)};return i((()=>{ae(),Q(),window.addEventListener("resize",R,!1)})),l((()=>{clearTimeout(N),window.addEventListener("resize",R,!1),cancelAnimationFrame(Z);try{D.clear(),I.dispose(),I.forceContextLoss(),I.content=null;let e=I.domElement.getContext("webgl");e&&e.getExtension("WEBGL_lose_context").loseContext()}catch(e){}})),(e,s)=>(d(),c("div",A,[r("div",{ref_key:"containerRef",ref:W,class:p(e.$style.container)},null,2)]))}}),[["__cssModules",{$style:{container:"_container_1kxrr_2"}}]]);export{F as default};
