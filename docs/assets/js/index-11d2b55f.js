var e=Object.defineProperty,t=(t,s,n)=>(((t,s,n)=>{s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n})(t,"symbol"!=typeof s?s+"":s,n),n);import{E as s,u as n}from"./scene-resize-ef457d70.js";import{b6 as a,c$ as o,cX as i,be as r,cY as c,bc as d,ba as l,bM as u,cZ as m,e as p,i as h,l as w,o as b,g as f,h as g}from"./vendor-82d05a1b.js";import"./index-a624a9da.js";const v=m,x=new a,N=v.uniform(.2);class y extends s{constructor(e){super(e),t(this,"gui"),t(this,"smokeInstancedSprite"),t(this,"fireInstancedSprite");const s=this.createGround();this.addObject(s),this.addModel(),this.gui=new o,this.addGui()}createRender(){return new i(this.options.render)}addModel(){const e=v.range(.1,1),t=v.range(new r(-2,3,-2),new r(2,5,2)),s=v.time.add(5).mul(N),n=s.mul(e).mod(1),a=v.range(.3,2),o=v.range(.1,4),i=n.div(e),m=v.positionLocal.y.oneMinus().max(.2),p=v.texture(x.load("/oss/textures/effect/smoke1.png"),v.rotateUV(v.uv(),s.mul(o))).a.mul(i.oneMinus()),h=v.mix(v.color(16777215),v.color(2236962),v.positionLocal.y.mul(.5).clamp()),w=new c;w.colorNode=v.mix(v.color(15891724),h,i.mul(2.5).min(1)).mul(m),w.opacityNode=p,w.positionNode=t.mul(n),w.scaleNode=a.mul(n.max(.3)),w.depthWrite=!1,w.transparent=!0;const b=new d(new l(1,1),w);b.scale.setScalar(40),b.count=2e3,b.position.y=10,b.castShadow=!0,this.smokeInstancedSprite=b,this.addObject(b);const f=new l(1,1),g=new c;g.colorNode=v.mix(v.color(12005143),v.color(12005143),i),g.positionNode=v.range(new r(-1,1,-1),new r(1,2,1)).mul(n),g.scaleNode=w.scaleNode,g.opacityNode=p.mul(.5),g.blending=u,g.transparent=!0,g.depthWrite=!1;const y=new d(f,g);y.scale.setScalar(40),y.count=1e3,y.position.y=10,y.castShadow=!0,this.fireInstancedSprite=y,this.addObject(y)}addGui(){var e;const t=this.gui;t.add(N,"value",.01,1,.01).name("烟雾速度"),t.add(this.fireInstancedSprite,"count",200,2e3).name("烟雾浓度").onChange((e=>{this.smokeInstancedSprite.count=2*e})),t.domElement.className+=" gui-wrap",null==(e=this.container.parentNode)||e.appendChild(t.domElement)}}const S={class:"three-page"},j=p({__name:"index",setup(e){const t=h(),s={grid:{visible:!0},axes:{visible:!0},render:{logarithmicDepthBuffer:!1}};let a;return w((()=>{s.container=t.value,a=new y(s),a.run(),n(a).resize()})),(e,s)=>(b(),f("div",S,[g("div",{class:"h-100",ref_key:"containerRef",ref:t},null,512)]))}});export{j as default};
