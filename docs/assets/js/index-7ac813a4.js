import{e,Y as o,i as t,l as a,c as r,o as s,g as n,h as i,q as l,u as c,p as d,I as m,n as p,R as y,aH as u}from"./vendor-eaf8386d.js";import{t as g}from"./index-9e76c09c.js";import{j as f,A as h,k as _,_ as b}from"./common-164461ea.js";import{u as v}from"./scene-resize-5f43ff70.js";import"./raycaster-d24ff307.js";import"./model-loader-f25c4637.js";import"./dialog-2831005f.js";const x={class:"flex flex-ac"},L=b(e({__name:"index",setup(e){const b=_(),L=o({devEnv:!0,baseUrl:"",bgColor:"",colors:{normal:{main:[8954293,2698801],text:12180479,FM:8954293},runing:{main:3045368,FM:22799},error:{FM:11877897}},indexDB:{cache:!0,dbName:"THREE__DEVICE__DB",tbName:"TB",version:2},camera:{far:1e6},cruise:{visible:!0,points:[[450,.1,450],[450,.1,-450],[-450,.1,-450],[-450,.1,450]],offset:10},render:{alpha:!0,preserveDrawingBuffer:!0},controls:{screenSpacePanning:!1,maxDistance:5e3,maxPolarAngle:.46*Math.PI},grid:{visible:!1,gridColor:44469,centerLineColor:44469,fork:!0,forkColor:44469},axes:{visible:!1},ambientLight:{intensity:1.5},directionalLight:{helper:!1},statusOffset:{TEXT:{LDB:{position:{x:0,y:0,z:75},rotation:{x:0,y:90,z:0}},LGJ_3:{position:{x:0,y:16,z:50},rotation:{x:-20,y:0,z:0}},LQT:{position:{x:-55,y:12,z:0}}},WARNING:{LDB:{position:{x:0,y:45,z:4},rotation:{x:0,y:90,z:0}},LQT:{position:{x:0,y:115,z:0}}}},config:{},models:[{key:"JSQ",name:"分集水器",size:2,url:"/分集水器.glb"},{key:"LXJ",name:"离心机",size:1.4,url:"/离心机.glb"},{key:"LGJ",name:"螺杆机",size:1.2,url:"/螺杆机.glb"},{key:"LGJ_3",name:"螺杆机",size:1.2,url:"/螺杆机-三机头.glb"},{key:"LQT",name:"冷却塔",size:.8,url:"/冷却塔.glb"},{key:"LDB",name:"冷冻泵",size:2.5,url:"/冷冻泵.glb"},{key:"LQB",name:"冷却泵",size:2.5,url:"/冷却泵.glb"},{key:"FM",name:"阀门",size:.05,url:"/阀门.glb"},{key:"BSHLQ",name:"板式换热器-制冷",size:.4,url:"/板式换热器-制冷.glb"},{key:"JGBS",name:"警告标识",size:.2,type:"warning",url:"/警告标识.glb"},{key:"COLD_CAMERA",name:"摄像头",type:"sprite",size:1,range:{x:37,y:77},mapUrl:"/sxt.png"},{key:"COLD_ROOM_INLET",name:"房间入口",type:"sprite",size:1,range:{x:37,y:77},mapUrl:"/fjdw.png"},{key:"COLD_GPS",name:"定位",type:"sprite",size:1,range:{x:51,y:56},mapUrl:"/dw.png"},{key:"FONT_WRYH",name:"微软雅黑字体",type:"font",size:26.35,url:"/oss/font/YaHei_Regular.json"}].map((e=>("sprite"!==e.type&&e.url&&e.url.indexOf("/oss")<0&&(e.url="/oss/model/cool"+e.url),e.mapUrl&&(e.mapUrl="/oss/textures/floor"+e.mapUrl),e))),objects:[],dotShowStrict:!0,textChangeColor:!0,mainBodyChangeColor:!1,anchorType:["COLD_CAMERA","COLD_ROOM_INLET","COLD_GPS"],colorMeshName:["电动阀门","叶轮","螺杆A","螺杆B","螺杆C","螺杆D","螺杆E","螺杆F","螺杆G","螺杆H"],animationModelType:["LDB","LQB","SB","LXJ","LGJ","LGJ_3","LQT"],textModelType:["LDB","LQB","JSQ","LXJ","LGJ","LGJ_3","LQT","BSHLQ"]}),C=t(),k=e=>b.formatData(e),z=(e,o)=>{const t=e.deviceCode||"",a=40*Math.random();void 0!==a&&(e.value=a);const r=t.split("_")[0]||"";return o.children.findIndex((e=>{var o;return e.data&&e.data.deviceCode===r&&((null==(o=e.data)?void 0:o.status)||0)>0}))>-1||["SYS","CSC"].includes(r)?e.show=!0:e.show=!1,e.value=Number(Number(e.value||0).toFixed(2)),{value:e.value,show:e.show,font:{...e.font||{},color:"#"+(16777215+1e6*a).toString(16).substring(0,6)}}},M=(e,o)=>{const t=Math.random()>.5?1:0,a=Math.random()>.5?1:0,r=Math.random()>.8?1:0,s=Math.floor(3*Math.random());return{status:r>0?0:t,error:r>0?0:a,remote:1==s?1:0,local:2==s?1:0,disabled:r}},D=e=>{v(e).resize()},S=(e,o)=>{},B=e=>{},j=()=>{const e=[[450,.1,350],[450,.1,-350],[-450,.1,-350],[-450,.1,350]].map((e=>e.map((e=>e*(.2-.2*Math.random()+1)))));L.cruise&&(L.cruise.points=e)},O=()=>{var e;return null==(e=C.value)?void 0:e.exportImage()};return a((()=>{f.get(h.d3.device2).then((e=>{let o=e.JsonList;const t=e.ModelUrl;o.unshift({name:e.Name,type:"",url:t?`${L.baseUrl}${t}`:""});let a={};if(e.ConfigJson instanceof Object)a=e.ConfigJson;else if("string"==typeof e.ConfigJson)try{a=JSON.parse(e.ConfigJson)}catch(s){}a.cruise&&L.cruise&&(L.cruise.points=a.cruise),Object.keys(a).forEach((e=>{L.config&&(L.config[e]=a[e])})),L.objects=o.map((e=>("COLD_ROOM_INLET"===e.type&&(e.onClick=e=>{r.success({message:e.name,grouping:!0})}),e)))}))})),(e,o)=>{const t=y,a=u;return s(),n("div",{class:p([e.$style.page,"h-100 o-h"])},[i("div",{class:p(e.$style.operate)},[i("div",x,[o[1]||(o[1]=i("span",null,"点位：",-1)),l(t,{modelValue:c(L).dotShowStrict,"onUpdate:modelValue":o[0]||(o[0]=e=>c(L).dotShowStrict=e),"active-text":"严格","inactive-text":"全显","inline-prompt":""},null,8,["modelValue"])]),l(a,{type:"success",onClick:j},{default:d((()=>o[2]||(o[2]=[m("切换巡航点位")]))),_:1}),l(a,{type:"primary",size:"small",onClick:O},{default:d((()=>o[3]||(o[3]=[m("导出")]))),_:1})],2),l(g,{ref_key:"threeSceneRef",ref:C,"dev-env":c(L).devEnv,"base-url":c(L).baseUrl,"bg-color":c(L).bgColor,"bg-url":c(L).bgUrl,"sky-code":c(L).skyCode,env:c(L).env,colors:c(L).colors,indexDB:c(L).indexDB,camera:c(L).camera,cruise:c(L).cruise,render:c(L).render,controls:c(L).controls,config:c(L).config,grid:c(L).grid,axes:c(L).axes,"ambient-light":c(L).ambientLight,"directional-light":c(L).directionalLight,"status-offset":c(L).statusOffset,models:c(L).models,objects:c(L).objects,"dot-show-strict":c(L).dotShowStrict,"anchor-type":c(L).anchorType,"text-change-color":c(L).textChangeColor,"main-body-change-color":c(L).mainBodyChangeColor,"color-mesh-name":c(L).colorMeshName,"animation-model-type":c(L).animationModelType,"text-model-type":c(L).textModelType,"format-object":k,"dot-update-object-call":z,"update-object-call":M,onInit:D,onClickDot:S,onDblclick:B},null,8,["dev-env","base-url","bg-color","bg-url","sky-code","env","colors","indexDB","camera","cruise","render","controls","config","grid","axes","ambient-light","directional-light","status-offset","models","objects","dot-show-strict","anchor-type","text-change-color","main-body-change-color","color-mesh-name","animation-model-type","text-model-type"])],2)}}}),[["__cssModules",{$style:{page:"_page_fyyv5_2",operate:"_operate_fyyv5_8","dialog-wrap":"_dialog-wrap_fyyv5_20",circle:"_circle_fyyv5_26",line:"_line_fyyv5_56",content:"_content_fyyv5_82",title:"_title_fyyv5_89",data:"_data_fyyv5_93"}}]]);export{L as default};
