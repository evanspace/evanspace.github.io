var e=Object.defineProperty,t=(t,a,s)=>(((t,a,s)=>{a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s})(t,"symbol"!=typeof a?a+"":a,s),s);import{i as a,S as s,u as i}from"./scene-resize-407aeb45.js";import{eh as n,bz as r,dh as o,dp as d,bC as l,dm as c,bv as u,bx as h,by as m,fm as w,fn as p,dL as v,eg as b,ei as f,f2 as g,f9 as y,c as x,f7 as S,k,o as j,f as C,g as z}from"./vendor-e4ee7844.js";import{u as L}from"./sky-8d6b28da.js";import"./index-1d839e62.js";const O="https://ye6.atomgit.net/3d-demo-data",{backgroundLoad:R}=a.useBackground(O+"/sky/",L().skys),D={elevation:2,azimuth:180};let G;const P=new n,A=new r;let F;class N extends s{constructor(e){super(e),t(this,"water"),t(this,"sky"),t(this,"gui"),t(this,"box"),this.addWater(),this.addSky();const a=new o(30,30,30),s=new d({roughness:0}),i=new l(a,s);this.box=i,this.addObject(i),this.gui=new c,this.addGui(),R(this,"101")}addWater(){const e=new u(1e4,1e4),t=(new h).setPath(O).load("/textures/waternormals.jpg");t.wrapS=t.wrapT=m,this.water=new w(e,{waterNormals:t,sunDirection:new r,sunColor:16777215,waterColor:7695,distortionScale:3}),this.water.rotation.x=.5*-Math.PI,this.addObject(this.water)}addSky(){const e=new p;e.scale.setScalar(1e4),this.sky=e,this.addObject(e),e.turbidity.value=10,e.rayleigh.value=2,e.mieCoefficient.value=5e-4,e.mieDirectionalG.value=.8;const t=this.renderer;G=new y(t),t.init().then((()=>this.updateSun()))}updateSun(){var e;const t=this.sky;if(!t)return;const a=v.degToRad(90-D.elevation),s=v.degToRad(D.azimuth);A.setFromSphericalCoords(1,a,s),t.sunPosition.value.copy(A),null==(e=this.water)||e.sunDirection.value.copy(A).normalize(),void 0!==F&&F.dispose(),P.add(t),F=G.fromScene(P),this.addObject(t),console.log(this),this.scene.environment=F.texture}addGui(){var e;const t=this.gui;if(!t)return;const a=t.addFolder("水面"),s=this.water;a.addColor(null==s?void 0:s.waterColor,"value").name("水面颜色"),a.add(null==s?void 0:s.distortionScale,"value",0,10,.1).name("倒影扭曲强度"),a.add(null==s?void 0:s.size,"value",.1,10,.1).name("水面大小");t.addFolder("天空").add(D,"azimuth",-180,180,.1).name("太阳角度").onChange((()=>this.updateSun())),t.domElement.className+=" gui-wrap",null==(e=this.container.parentNode)||e.appendChild(t.domElement)}modelAnimate(){const e=.001*performance.now();this.box.position.y=20*Math.sin(e)+5,this.box.rotation.x=.5*e,this.box.rotation.y=.5*e}render(){this.renderer.renderAsync(this.scene,this.camera)}createScene(){return new n}createDirectionalLight(e,t){return new b(e,t)}createAmbientLight(e,t){return new f(e,t)}createRender(){return new g(this.options.render)}}const T={class:"three-page"},_=x({__name:"index",setup(e){const t=S("containerRef"),a={grid:{visible:!1},ambientLight:{visible:!1},directionalLight:{visible:!1},axes:{visible:!0}};let s;return k((()=>{a.container=t.value,s=new N(a).run(),i(s).resize()})),(e,a)=>(j(),C("div",T,[z("div",{class:"container",ref_key:"containerRef",ref:t},null,512)]))}});export{_ as default};
