import{e,i as a,dh as n,bl as t,Y as o,l as i,af as s,o as r,g as l,h as d,dk as c,dQ as m,dR as u,bi as p,bg as g,dJ as h,bc as f,dH as w,dS as x,d5 as v,b6 as C,bh as b,b7 as y,be as E}from"./vendor-4c59ff80.js";import{c as S,a as z,b as M,e as D}from"./common-ce28eb54.js";import{d as P}from"./index-7cc312c2.js";const j={class:"page h-100"},F=e({__name:"index",setup(e){const F=P(),G=a(),_=new n;let k,L,R,W;_.background=new t("#fff");const A=()=>{const e=G.value;if(!k)return;const a=e.clientWidth,n=e.clientHeight,t=a/n;k.aspect=t,k.updateProjectionMatrix(),L.setSize(a,n)};let H;const T=()=>{H=requestAnimationFrame(T),I(),L.render(_,k)},I=()=>{let e=.001*performance.now();O.position.y=20*Math.sin(e)+5,O.rotation.x=.5*e,O.rotation.z=.51*e,J.material.uniforms.time.value+=1/60},q=o({turbidity:10,rayleigh:2,mieCoefficient:.005,mieDirectionalG:.2,elevation:2,azimuth:180,exposure:null});let B;let J;const N=()=>{const e=new g(1e4,1e4);J=new h(e,{textureWidth:512,textureHeight:512,waterNormals:(new f).load(`${F.oss}/textures/waternormals.jpg`,(e=>{e.wrapS=e.wrapT=w})),sunDirection:new p,sunColor:16777215,waterColor:7695,distortionScale:3.7,fog:void 0!==_.fog}),J.rotation.x=-Math.PI/2,_.add(J)};let Q;const Y=()=>{Q=new x,Q.scale.setScalar(1e4),_.add(Q)};let $;const K=()=>{const e=Q.material.uniforms;e.turbidity.value=q.turbidity,e.rayleigh.value=q.rayleigh,e.mieCoefficient.value=q.mieCoefficient,e.mieDirectionalG.value=q.mieDirectionalG;const a=v.degToRad(90-q.elevation),n=v.degToRad(q.azimuth);$.setFromSphericalCoords(1,a,n),Q.material.uniforms.sunPosition.value.copy($),J.material.uniforms.sunDirection.value.copy($).normalize(),_.environment=B.fromScene(Q).texture,L.toneMappingExposure=q.exposure};let O;const U=()=>{let e=new C(30,30,30),a=new b({roughness:0,color:1365});O=new y(e,a),_.add(O)},V=()=>{const e=G.value;L=S(e),k=z(e,1,1e6),W=new c(16777215,1.5),_.add(W),D(16777215,1.5),R=M(k,L),R.maxPolarAngle=.45*Math.PI,R.screenSpacePanning=!1,N(),Y(),L.toneMapping=m,L.toneMappingExposure=1,q.exposure=L.toneMappingExposure,B=new u(L),$=new p,K(),U(),(e=>{const a=new E,n=a.addFolder("Sky");n.add(q,"turbidity",0,100,.1).name("浑浊").onChange(K),n.add(q,"rayleigh",0,4,.001).name("锐利").onChange(K),n.add(q,"mieCoefficient",0,.1,.001).name("散射系数").onChange(K),n.add(q,"mieDirectionalG",0,1,.001).name("方向").onChange(K),n.add(q,"elevation",0,90,.1).name("高度").onChange(K),n.add(q,"azimuth",-180,180,.1).name("方位").onChange(K),n.add(q,"exposure",0,1,1e-4).name("光晕强度").onChange(K);const t=a.addFolder("Water"),o=J.material.uniforms;t.add(o.distortionScale,"value",0,100,.1).name("变形尺度"),t.add(o.size,"value",.1,10,.1).name("大小"),a.domElement.style="position: absolute; top: 10px; right: 10px",e.appendChild(a.domElement)})(e)};return i((()=>{V(),T(),window.addEventListener("resize",A,!1)})),s((()=>{window.addEventListener("resize",A,!1),cancelAnimationFrame(H);try{_.clear(),L.dispose(),L.forceContextLoss(),L.content=null;let e=L.domElement.getContext("webgl");e&&e.getExtension("WEBGL_lose_context").loseContext()}catch(e){}})),(e,a)=>(r(),l("div",j,[d("div",{ref_key:"containerRef",ref:G,class:"container h-100",style:{position:"relative"}},null,512)]))}});export{F as default};
