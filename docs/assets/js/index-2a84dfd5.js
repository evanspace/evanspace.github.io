var e=Object.defineProperty,t=(t,s,o)=>(((t,s,o)=>{s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[s]=o})(t,"symbol"!=typeof s?s+"":s,o),o);import{w as s,E as o,u as n}from"./scene-resize-bd4c29f6.js";import{bq as a,bi as i,eD as r,eA as c,eB as u,eC as l,eK as d,be as p,eF as m,bk as h,eE as f,bg as b,dE as g,e as y,i as w,l as x,o as v,g as j,h as P}from"./vendor-f4cca9b5.js";import"./index-dfaab5bf.js";const O=new a,{pass:D,mrt:T,output:B,emissive:I,float:M}=f,{createDiffusion:N}=s.useDiffusion2();class R extends o{constructor(e){super(e),t(this,"group",new i),t(this,"postProcessing"),t(this,"createPostProcessing",((e,t,s,o)=>{const n=D(e,t);o?n.setMRT(T({output:B,emissive:I})):n.setMRT(T({output:B,bloomIntensity:M(.01)}));const a=n.getTextureNode();let i;if(o){const e=n.getTextureNode("emissive");i=c(e,2.5,.5)}else{const e=n.getTextureNode("bloomIntensity");i=c(a.mul(e))}s.toneMapping=u;const r=new l(s);return o?r.outputNode=a.add(i):(r.outputColorTransform=!1,r.outputNode=a.add(i).renderOutput()),r})),this.setDebounceDuration(1e3),this.postProcessing=this.createPostProcessing(this.scene,this.camera,this.renderer),this.addObject(this.group),this.addModel()}render(){var e;null==(e=this.postProcessing)||e.renderAsync()}createRender(){return new r(this.options.render)}addModel(){const e=this.createDiffusion(1,6404586);e.rotation.x=.5*-Math.PI,this.addObject(e),e.geometry.computeBoundingBox();const t=N({textureSrc:"/oss/textures/diffusion/101.png",bloomIntensity:.2},d);t.position.x=3,t.geometry.computeBoundingBox(),this.addObject(t)}createDiffusion(e=1,t){const s=new p(e,e),o=new m({color:t,opacity:.8,map:O.load("/oss/textures/diffusion/101.png"),transparent:!0,depthTest:!0,side:h});o.mrtNode=f.mrt({bloomIntensity:f.uniform(1)});const n=new b(s,o),a=.1;return n.scale.setScalar(a),n.tween1=new g({scale:a,opacity:0}).to({scale:1.6,opacity:1},500).delay(0).onUpdate((e=>{let{scale:t,opacity:s}=e;n.scale.setScalar(t),n.material.opacity=s})),n.tween2=new g({scale:1.6,opacity:1}).to({scale:2.1,opacity:0},500).onUpdate((e=>{let{scale:t,opacity:s}=e;n.scale.setScalar(t),n.material.opacity=s})),n.tween1.chain(n.tween2),n.tween2.chain(n.tween1),n.tween1.start(),n}modelAnimate(){this.debounce((()=>{}))}checkObjects(){this.getVisibleObjects()}getVisibleObjects(){const e=this.getFrustum(),t=[];return this.scene.traverseVisible((s=>{s instanceof b&&this.frustumIntersectsBox(e,s)&&t.push(s)})),t}}const S={class:"three-page"},k=y({__name:"index",setup(e){const t=w(),s={container:t.value,render:{antialias:!0},grid:{visible:!0},camera:{near:1e-10,position:[0,5,2]}};let o=null;return x((()=>{s.container=t.value,o=new R(s).run(),n(o).resize()})),(e,s)=>(v(),j("div",S,[P("div",{class:"h-100",ref_key:"containerRef",ref:t},null,512)]))}});export{k as default};
