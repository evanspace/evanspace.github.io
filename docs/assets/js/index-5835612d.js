import{e,Y as a,o as l,g as s,q as t,p as n,I as i,h as o,u,F as r,r as c,m as p,B as d,n as m,aE as g,P as f,Q as v,ak as x,aI as y,b2 as h,c as j}from"./vendor-b9b94b6b.js";import{_ as w}from"./index-b37449f0.js";const _={class:"flex flex-ac"},b={class:"f-x pl-sm"},V={class:"flex flex-ac"},q={class:"f-x pl-sm"},U={class:"flex flex-ac"},k={class:"f-x pl-sm"},I={class:"flex flex-ac"},C={class:"f-x pl-sm"},E={key:0,class:"mt-sm"},R=w(e({__name:"index",setup(e){const w=a({quality:1,ratio:100,name:"",urls:[],types:["png","jpeg","jpg"],type:"image/jpeg",options:[{label:"png",value:"image/png"},{label:"jpg",value:"image/jpg"},{label:"jpeg",value:"image/jpeg"},{label:"webp",value:"image/webp"}]}),R=()=>{const e=w.name.split(".").pop()||"";return!!w.types.includes(e)||(j.error("图片格式错误，支持"+w.types.join("、")+" 格式"),!1)},D=e=>{const a=e.target.files[0];if(w.urls=[],w.name=a.name,!R())return;const l=new FileReader;l.onload=e=>{const a=e.target.result;w.urls.push(a)},l.readAsDataURL(a)},F=()=>{if(!R())return;const e=new Image;e.onload=function(){const a=w.ratio/100,l=document.createElement("canvas");l.width=e.width*a,l.height=e.height*a;const s=l.getContext("2d");if(!s)return;s.drawImage(e,0,0,l.width,l.height);const t=l.toDataURL(w.type,w.quality);console.log(w.quality);const n=document.createElement("a");n.href=t,w.urls[1]=t,n.download=w.name+"."+w.type.split("/")[1],n.click()},e.src=w.urls[0]};return(e,a)=>{const j=g,R=f,L=v,$=x,z=y,A=h;return l(),s("div",{class:m(e.$style.page)},[t(A,null,{header:n((()=>a[3]||(a[3]=[i("图片转换")]))),default:n((()=>[o("div",_,[a[4]||(a[4]=o("div",{class:"name"},"上传文件",-1)),o("div",b,[o("input",{type:"file",accept:"image/png,image/jpeg,image/jpg",onChange:D},null,32)])]),o("div",V,[a[5]||(a[5]=o("div",{class:"name"},"图片大小占比",-1)),o("div",q,[t(j,{modelValue:u(w).ratio,"onUpdate:modelValue":a[0]||(a[0]=e=>u(w).ratio=e),max:200},null,8,["modelValue"])])]),o("div",U,[a[6]||(a[6]=o("div",{class:"name"},"压缩等级",-1)),o("div",k,[t(j,{modelValue:u(w).quality,"onUpdate:modelValue":a[1]||(a[1]=e=>u(w).quality=e),max:1,step:.01},null,8,["modelValue"])])]),o("div",I,[a[7]||(a[7]=o("div",{class:"name"},"导出格式",-1)),o("div",C,[t(L,{modelValue:u(w).type,"onUpdate:modelValue":a[2]||(a[2]=e=>u(w).type=e)},{default:n((()=>[(l(!0),s(r,null,c(u(w).options,(e=>(l(),p(R,{label:e.label,value:e.value},null,8,["label","value"])))),256))])),_:1},8,["modelValue"])])]),t($,{type:"success",onClick:F},{default:n((()=>a[8]||(a[8]=[i("导出")]))),_:1}),u(w).urls.length?(l(),s("div",E,[(l(!0),s(r,null,c(u(w).urls,(e=>(l(),p(z,{src:e,"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-src-list":u(w).urls,"show-progress":"","initial-index":4,fit:"cover"},null,8,["src","preview-src-list"])))),256))])):d("",!0)])),_:1})],2)}}}),[["__cssModules",{$style:{page:"_page_r82yl_2"}}]]);export{R as default};
