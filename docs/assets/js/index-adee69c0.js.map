{"version":3,"file":"index-adee69c0.js","sources":["../../../code/src/pages/animation/api/index.vue"],"sourcesContent":["<template>\n  <div class=\"page js-animation-api\" ref=\"pageRef\" @click=\"onClick\">\n    <div class=\"ball\" ref=\"ballRef\"></div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nconst pageRef = ref()\nconst ballRef = ref()\n\nconst onClick = e => {\n  const pointer = document.createElement('div')\n  pointer.classList.add('ripple')\n  pointer.style.left = `${e.offsetX}px`\n  pointer.style.top = `${e.offsetY}px`\n  pageRef.value.appendChild(pointer)\n\n  // 动画结束\n  pointer.addEventListener('animationend', _e => {\n    pointer.remove()\n  })\n  // 移动\n  move(e.offsetX, e.offsetY)\n}\n\nconst move = (x, y) => {\n  // console.log(x, y)\n  const ball = ballRef.value\n  const dom = pageRef.value\n  const domRect = dom.getBoundingClientRect()\n  // 元素样式\n  const ballRect = ball.getBoundingClientRect()\n  const initX = ballRect.width / 2 + ballRect.left - domRect.left\n  const initY = ballRect.height / 2 + ballRect.top - domRect.top\n\n  // 计算角度\n  const rad = Math.atan2(y - initY, x - initX)\n  const deg = (rad * 180) / Math.PI\n\n  // 所有动画\n  const animates = ball.getAnimations()\n  // 取消动画\n  animates.forEach(animation => animation.cancel())\n  const animate = ball.animate(\n    [\n      // 关键帧\n      {\n        transform: `translate(${initX}px, ${initY}px) rotate(${deg}deg)`,\n        easing: 'ease-out'\n      },\n      {\n        transform: `translate(${initX}px, ${initY}px) rotate(${deg}deg) scaleX(1.5)`,\n        offset: 0.6\n      },\n      {\n        transform: `translate(${x}px, ${y}px) rotate(${deg}deg) scaleX(1.5)`,\n        offset: 0.8,\n        easing: 'ease-in'\n      },\n      {\n        transform: `translate(${x}px, ${y}px) rotate(${deg}deg)`\n      }\n    ],\n    {\n      // 动画配置\n      duration: 800,\n      fill: 'forwards'\n    }\n  )\n  animate.onfinish = _e => {\n    ElMessage.success({\n      message: '动画结束',\n      grouping: true\n    })\n  }\n}\nconst initPage = () => {\n  const dom = pageRef.value\n  const w = dom.clientWidth,\n    h = dom.clientHeight\n  move(w / 2, h / 2)\n}\n\nonMounted(initPage)\n</script>\n\n<style lang=\"scss\">\n.js-animation-api {\n  height: 100%;\n  overflow: hidden;\n  position: relative;\n  background-color: #000;\n\n  .ripple {\n    width: 0;\n    height: 0;\n    border: 1px solid rgba(255, 255, 255, 0.5);\n    position: absolute;\n    animation: ripple 0.3s;\n    transform: translate(-50%, -50%);\n    border-radius: 50%;\n    pointer-events: none;\n  }\n  @keyframes ripple {\n    0% {\n      width: 0;\n      height: 0;\n    }\n    100% {\n      width: 50px;\n      height: 50px;\n      opacity: 0.5;\n    }\n  }\n\n  .ball {\n    width: 50px;\n    height: 50px;\n    position: absolute;\n    margin-left: -25px;\n    margin-top: -25px;\n    border-radius: 50%;\n    pointer-events: none;\n    background-color: aqua;\n  }\n}\n</style>\n"],"names":["pageRef","ref","ballRef","onClick","e","pointer","document","createElement","classList","add","style","left","offsetX","top","offsetY","value","appendChild","addEventListener","_e","remove","move","x","y","ball","domRect","getBoundingClientRect","ballRect","initX","width","initY","height","deg","Math","atan2","PI","getAnimations","forEach","animation","cancel","animate","transform","easing","offset","duration","fill","onfinish","ElMessage","success","message","grouping","onMounted","dom","w","clientWidth","h","clientHeight"],"mappings":"iHAOA,MAAAA,EAAAC,IACAC,EAAAD,IAEAE,EAAAC,IACE,MAAAC,EAAAC,SAAAC,cAAA,OACAF,EAAAG,UAAAC,IAAA,UACAJ,EAAAK,MAAAC,KAAA,GAAAP,EAAAQ,YACAP,EAAAK,MAAAG,IAAA,GAAAT,EAAAU,YACAd,EAAAe,MAAAC,YAAAX,GAGAA,EAAAY,iBAAA,gBAAAC,IACEb,EAAAc,QAAA,IAGFC,EAAAhB,EAAAQ,QAAAR,EAAAU,QAAA,EAGFM,EAAA,CAAAC,EAAAC,KAEE,MAAAC,EAAArB,EAAAa,MAEAS,EADAxB,EAAAe,MACAU,wBAEAC,EAAAH,EAAAE,wBACAE,EAAAD,EAAAE,MAAA,EAAAF,EAAAf,KAAAa,EAAAb,KACAkB,EAAAH,EAAAI,OAAA,EAAAJ,EAAAb,IAAAW,EAAAX,IAIAkB,EAAA,IADAC,KAAAC,MAAAX,EAAAO,EAAAR,EAAAM,GACAK,KAAAE,GAGAX,EAAAY,gBAEAC,SAAAC,GAAAA,EAAAC,WACAf,EAAAgB,QAAqB,CACnB,CAEEC,UAAA,aAAAb,QAAAE,eAAAE,QAC4DU,OAAA,YAE5D,CACAD,UAAA,aAAAb,QAAAE,eAAAE,oBAC4DW,OAAA,IAE5D,CACAF,UAAA,aAAAnB,QAAAC,eAAAS,oBACoDW,OAAA,GAC1CD,OAAA,WAEV,CACAD,UAAA,aAAAnB,QAAAC,eAAAS,UAGF,CACAY,SAAA,IAEYC,KAAA,aAIdC,SAAA3B,IACE4B,EAAAC,QAAA,CAAkBC,QAAA,OACPC,UAAA,GACC,CACX,SAULC,GAPA,KACE,MAAAC,EAAAnD,EAAAe,MACAqC,EAAAD,EAAAE,YAAAC,EAAAH,EAAAI,aAEAnC,EAAAgC,EAAA,EAAAE,EAAA,EAAA"}