var e=Object.defineProperty,t=(t,s,o)=>(((t,s,o)=>{s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[s]=o})(t,"symbol"!=typeof s?s+"":s,o),o);import{E as s,p as o,u as a}from"./scene-resize-97d24741.js";import{by as n,de as i,bw as r,df as c,dg as l,dh as h,e as d,i as m,l as u,o as b,g as p,h as v,I as f,n as M}from"./vendor-b9b94b6b.js";import{_ as j}from"./index-b37449f0.js";const y=o,{insertEvent:E,destroyEvent:g}=y.useKeyboardState(),{pointer:w,update:_,raycaster:S}=y.useRaycaster();class k extends s{constructor(e){super(e),t(this,"enableSelection",!1),t(this,"select",new n),t(this,"objects",[]),this.addObject(this.select),this.addModel(),this.container.addEventListener("click",this.onClick.bind(this))}addModel(){this.objects=[];const e=new i;for(let t=0;t<200;t++){const t=new r(e,new c({color:16777215*Math.random()}));t.position.set(300*Math.random()-150,150*Math.random()-75,200*Math.random()-100),t.rotation.set(2*Math.random()*Math.PI,2*Math.random()*Math.PI,2*Math.random()*Math.PI),t.scale.set(20*Math.random()+10,20*Math.random()+10,20*Math.random()+10),t.castShadow=!0,t.receiveShadow=!0,this.objects.push(t),this.addObject(t)}this.controls&&(this.controls.objects=[...this.objects])}createConstrols(){const e=new l([],this.camera,this.renderer.domElement);return e.addEventListener("dragstart",(e=>{})),e.addEventListener("dragend",(e=>{})),e.addEventListener("hoveron",(e=>{})),e.addEventListener("hoveroff",(e=>{})),E((e=>{var t;if(this.enableSelection=16===e.keyCode,77===e.keyCode){if(!this.controls)return;this.controls.touches.ONE=(null==(t=this.controls)?void 0:t.touches.ONE)===h.PAN?h.ROTATE:h.PAN}}),(()=>{this.enableSelection=!1})),e}onClick(e){var t;if(this.enableSelection){const s=null==(t=this.controls)?void 0:t.objects;s.length=0,_(e,this.container),S.setFromCamera(w,this.camera);const o=this.objects,a=S.intersectObjects(o,!0);if(a.length>0){const e=a[0].object;console.log(e),this.select.children.includes(e)?(e.material.emissive.set(0),this.scene.attach(e)):(e.material.emissive.set(11184810),this.select.attach(e)),console.log(this.select),this.controls.transformGroup=!0,s.push(this.select)}0===this.select.children.length&&(this.controls.transformGroup=!1,s.push(...o))}}dispose(){g(),super.dispose()}}const C={class:"three-page"},O=j(d({__name:"index",setup(e){const t=m(),s={axes:{visible:!0},camera:{position:[0,0,400]}};let o;return u((()=>{s.container=t.value,o=new k(s).run(),a(o).resize()})),(e,s)=>(b(),p("div",C,[v("div",{class:"h-100",ref_key:"containerRef",ref:t},null,512),v("div",{class:M(e.$style.tip)},s[0]||(s[0]=[f(" 使用“Shift+Click”向组添加对象或从组中删除对象"),v("br",null,null,-1),f(" 使用“M”在旋转和平移模式之间切换（仅限触摸）"),v("br",null,null,-1),f(" 分组对象可以转换为联合。 ")]),2)]))}}),[["__cssModules",{$style:{tip:"_tip_2m92f_2"}}]]);export{O as default};
