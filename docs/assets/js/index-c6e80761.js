var e,t,a,i,s=Object.defineProperty,o=(e,t,a)=>(((e,t,a)=>{t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a})(e,"symbol"!=typeof t?t+"":t,a),a),r=(e,t,a)=>{if(!t.has(e))throw TypeError("Cannot "+a)},n=(e,t,a)=>(r(e,t,"read from private field"),a?a.call(e):t.get(e)),l=(e,t,a)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,a)},c=(e,t,a,i)=>(r(e,t,"write to private field"),i?i.call(e,a):t.set(e,a),a),p=(e,t,a)=>(r(e,t,"access private method"),a);import{bw as d,bg as h,b4 as g,bo as u,bh as m,a_ as f,a$ as C,bm as E,bx as S,cw as A,cx as k,b2 as J,cy as b,bv as I,b3 as v,c1 as y,bq as B,cz as w,bp as U,e as G,i as R,w as Q,l as M,aM as j,o as L,g as K,h as x,n as _,u as D,a9 as O,a5 as F,B as Y,Y as P,q,p as z,I as V,t as $,c as W,ah as T}from"./vendor-eaf8386d.js";import{T as N,d as X,g as H,n as Z,u as ee}from"./scene-resize-5f43ff70.js";import{u as te,b as ae,a as ie,c as se,d as oe,g as re,e as ne,f as le,i as ce,h as pe}from"./convert-data-b205e3ac.js";import{u as de}from"./raycaster-d24ff307.js";import{D as he,u as ge,a as ue}from"./dialog-2831005f.js";import{_ as me,j as fe,A as Ce,n as Ee}from"./common-164461ea.js";const Se={depth:1,scale:40,plateRadius:200,rightClickBackDiffTime:100,areaLabel:!1,markLight:!1,border:!0,mapBg:!0,mapBar:!0,bgOutFactor:1,bgInnerFactor:.9,map:{}},Ae={main:3377879,mainHover:9633791,borderColor:9633791,borderHoverColor:1066618,light:1066618,lightHover:9633791,plateColor:3377879,plateLight:1066618,line:9559027,line2:6421501,gridColor:663606,gridFork:927811,outline:11856636,markColor1:13303807,markColor2:6945023,flyColor1:9559027,flyColor2:6421501,scatterColor1:9559027,scatterColor2:6421501},{initCSS3DRender:ke,createCSS3DDom:Je}=re(),{raycaster:be,pointer:Ie,style:ve,update:ye}=de(),{createCorrugatedPlate:Be,corrugatedPlateUpdate:we}=te(),{getBoundingBox:Ue}=ne(),{createMarkLight:Ge}=ae(),{createCountryFlatLine:Re,getPoints:Qe}=le(),{createOutline:Me,outlineUpdate:je}=ie(),{createFlywireTexture:Le,createFlywire:Ke,flywireUpdate:xe}=se(),{createBar:_e}=oe(),De={x:105.06,y:0,z:32.93},Oe=new d;let Fe,Ye,Pe,qe,ze;const Ve=new URL("/imgs/gz-map-15a6793f.jpg",self.location).href,$e=new URL("/imgs/gz-map-fx-c5e413a7.jpg",self.location).href,We=new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGUAAAE1CAYAAAD+hS6MAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALrSURBVHgB7dOxDQJBEMDABV1fdE5Mhr4IwkMiIUNPGw5mWrB8ue19DinXIUeUIFGCRAkSJUiUIFGCRAkSJUiUIFGCRAkSJUiUIFGCRAkSJUiUIFGCRAkSJUiUIFGCRAkSJUiUIFGCRAkSJUiUIFGCRAkSJUiUIFGCRAkSJUiUIFGCRAkSJUiUIFGCRAkSJUiUIFGCRAkSJUiUIFGCRAlax+M+tDglSJQgUYJECRIlSJQgUYJECRIlSJQgUYJECRIlSJQgUYJECRIlSJQgUYJECRIlSJQgUYJECRIlSJQgUYJECRIlSJQgUYJECRIlSJQgUYJECRIlSJQgUYJECRIlaH2fx9DilCBRgkQJEiVIlCBRgkQJEiVIlCBRgkQJEiVIlCBRgkQJEiVIlCBRgkQJEiVIlCBRgkQJEiVIlCBRgkQJEiVIlCBRgkQJEiVIlCBRgkQJEiVIlCBRgkQJWud+Dy1OCRIlSJQgUYJECRIlSJQgUYJECRIlSJQgUYJECRIlSJQgUYJECRIlSJQgUYJECRIlSJQgUYJECRIlSJQgUYJECRIlSJQgUYJECRIlSJQgUYJECRIlSJQgUYJECRIlSJQgUYJECVq/12docUqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBIkSJEqQKEGiBP0B9I0QJBOMnj4AAAAASUVORK5CYII=",self.location).href,Te=new URL("/imgs/out-circle-6854860a.png",self.location).href,Ne=new URL("/imgs/inner-circle-8c61cf85.png",self.location).href,Xe=(e,t,a)=>t?H(t,a):e,He=(e,t)=>{const a=new A(t),i={depth:e.config.depth,bevelEnabled:!0,bevelSegments:1,bevelThickness:0,steps:0,bevelSize:0},s=new k(a,i),o=new J({color:e.color.main,map:Fe,normalMap:Ye,combine:b,transparent:!0,opacity:.8}),r=new I({color:Ae.borderColor,map:Pe,transparent:!0,opacity:.9}),n=new v(s,[o,r]);return n.scale.setScalar(e.config.scale),n.name="地图拼块",n},Ze=new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAK+SURBVHgB7dzNbdswGIdxSugCRtGBuklWSO17nXs/J0hHywA11AEMu3wDsLFT5WCJ5PtI/D8nQ5cA/FmxJJLqtofhHBSmPihUAoElEFgCgfVu7ODX95suqOKNXVDpDIElEFgCgSUQWAKBJRBYAoE1G2Q3DJ/j9fRjUGE7DI+f4niEGc0CMYzzKezjx7vWUQwjnMJdF8djDsq8M+QYLu/om0VJGP8OXI/LTc0C+fJhs4/fiIeLQ82hvMaI/zEevsVxCROb/RvSMkpuDCvLVVaLKCUwrGyXvS2hlMKwst6HtIBSEsPKfmO4ZpTSGFaRO/U1otTAsIo9OlkTSi0Mq+izrDWg1MSwij9cXDJKbQyrytPeJaJ4YFjVHr8vCcULw6o6H7IEFE8Mq/oEFRnFG8NymTEkohAwLLcpXBIKBcNynVMnoJAwLPdFDp4oNAwLserEA4WIYXVjK7C9Vr+fY8Gh7e8/Lhha/f5GhDMjJRBYAoElEFgCgSUQWAKBJRBYAoElEFgCgSUQWAKBJRBYAoElEFgCgSUQWAKBJRBYAoElEFgCgSUQWAKBJZDwvIIQs2kIA/K81tYvzKYhBMh/75vyCYHiDgLBSLmjuIK8xrBV6J1HoO11biCk/Rmk7XUuIMTNMhSU6iDUnUsWAaUqCBkj5Y1SDWQJGClPlCogS8JIeaEUB1kiRsoDpSjIkjFStVGKgawBI1UTpQjImjBStVCyg6wRI1UDJSvImjFSpVGygbSAkSqJkgWkJYxUKZTZIC1ipEqgzAJpGSOVG2UyiDBeyokyCWR3OOyFcd0Yyu4wfA83Ngnk2Pe/ziE82WdhvHSJYuNz7MPPcGOTQH5sNk+nPnyMf/xeGNcZSvyS3tv42DiFG0O94q+19Iq/BSQQWAKBJRBYAoElEFgCgSUQWKM3hsovnSGwBAJLILAEAusvLK6Na4P/Au0AAAAASUVORK5CYII=",self.location).href,et=(e,t,a)=>{if(!t.centroid&&!t.center)return!1;const{depth:i,scale:s}=e.config,[o,r]=t.centroid||t.center,n=Je({name:`\n      <img src="${Ze}" />\n      <div class="name">${t.name}</div>\n    `,className:"map-3D-label",position:[o*s,r*s*.995,i*s]});n.rotateX(.5*Math.PI),n.name=t.name+"_CSS3D_label",n.isLabel=!0,a.add(n)},tt=(e,t,a)=>{if(!t.centroid&&!t.center)return!1;const{depth:i,scale:s}=e.config,o=1+(r=5,n=10,(Math.floor(Math.random()*(n-r+1))+r)/4);var r,n;const[l,c]=t.centroid||t.center,p=Ge([l,c,1.01*i].map((e=>e*s)),o*s,{factor:s,color:e.color.markColor1});p.rotateX(-Math.PI/2),a.add(p)},at=(e,t,a)=>{const{scale:i,depth:s}=e.config,o=new g,r=.2*i,n=new w(r,32),l=new B({color:Ae.scatterColor1,transparent:!0,opacity:1}),c=new v(n,l),p=new U(.8*r,32,32,0,Math.PI),d=new B({color:Ae.scatterColor2,transparent:!0,opacity:1}),h=new v(p,d);return o.add(c,h),o.position.set(t*i,a*i,s*i*1.005),o};class it extends N{constructor(i,s={},r={},n,p){super(i),l(this,a),o(this,"config"),o(this,"color"),o(this,"corrugatedPlate"),o(this,"clock"),o(this,"mapGroup"),o(this,"scatterGroup"),o(this,"flywireGroup"),o(this,"css3DRender"),o(this,"outline"),l(this,e,void 0),l(this,t,void 0),o(this,"outRingMesh"),o(this,"innerRingMesh"),this.config=X(Se,s),this.color=X(Ae,r),c(this,e,n),c(this,t,p),this.clock=new h,this.css3DRender=ke(this.options,this.container),((e,t)=>{Fe=Oe.load(Xe(Ve,e.map.map,t)),Ye=Oe.load(Xe($e,e.map.normal,t)),Pe=Oe.load(Xe(We,e.map.side,t)),Fe.wrapS=Ye.wrapS=Pe.wrapS=S,Fe.wrapT=Ye.wrapT=Pe.wrapT=S,Fe.flipY=!1;const a=.0128;Fe.repeat.set(a,a),Ye.repeat.set(a,a),qe=Oe.load(Xe(Te,e.map.bgOutCircle,t)),ze=Oe.load(Xe(Ne,e.map.bgInnerCircle,t))})(this.config,this.options.baseUrl),this.bindEvent()}addCorrugatedPlate(){this.corrugatedPlate&&(this.disposeObj(this.corrugatedPlate),this.corrugatedPlate=void 0);const e=Be({range:this.config.plateRadius,factor:this.config.scale,color:this.color.plateColor,light:this.color.plateLight});e.renderOrder=0,this.corrugatedPlate=e,this.addObject(e)}initMap(e){this.mapGroup&&(this.disposeObj(this.mapGroup),this.mapGroup=null);const t=new g;t.name="地图";const a=e.features,i=a.length;for(let c=0;c<i;c++){const e=a[c],i=new u,s=e.geometry.coordinates,o=e.properties;for(let t=0;t<s.length;t++)s[t].forEach((e=>{const t=e.map((e=>new m(e[0],e[1]))),a=He(this,t);a.isProvinceBlock=!0,i.add(a)}));this.config.areaLabel&&et(this,o,i),this.config.markLight&&tt(this,o,i),i.rotateX(-Math.PI/2),i.isProvinceGroup=!0,i.name=o.name,i.data=o,t.add(i)}this.mapGroup=t,this.addObject(t),this.config.border&&((e,t)=>{let a=Re(t,{color:Ae.line,transparent:!0},"Line2");const{depth:i,scale:s}=e.config;a.name="地图上边框",a.position.y+=i*s;let o=Re(t,{color:Ae.line2},"Line2");o.name="地图下边框",a.scale.setScalar(s),o.scale.setScalar(s),e.scene.add(a),e.scene.add(o)})(this,e);const s=Ue(t);let{size:o,center:{x:r,y:n,z:l}}=s;if(De.x=r,De.y=n,De.z=l,this.corrugatedPlate.position.set(r,0-.1*this.config.scale,l),this.resetSceneEle(),this.config.mapBg){const e=o.x<o.y?o.y+1:o.x+1;this.outRingMesh=((e,t)=>{let a=new y(t,t),i=new B({map:qe,transparent:!0,opacity:.6,depthTest:!0}),s=new v(a,i);const{x:o,z:r}=De;return s.position.set(o,-1,r),s.scale.setScalar(1.2),s.rotateX(.5*-Math.PI),e.add(s),s})(this.scene,e*this.config.bgOutFactor),this.innerRingMesh=((e,t)=>{let a=new y(t,t),i=new B({map:ze,transparent:!0,opacity:.3,depthTest:!0}),s=new v(a,i);const{x:o,z:r}=De;return s.position.set(o,-2,r),s.scale.setScalar(1.2),s.rotateX(.5*-Math.PI),e.add(s),s})(this.scene,e*this.config.bgInnerFactor)}}initMapOutLine(e){this.outline&&(this.disposeObj(this.outline),this.outline=null);const t=Qe(e,this.config.depth,!1),a=Me(t,{factor:this.config.scale,color:this.color.outline});a.renderOrder=10,this.outline=a,this.addObject(a)}initFlywire(e){this.flywireGroup&&(this.disposeObj(this.flywireGroup),this.flywireGroup=null);const{scale:t,depth:a}=this.config,i=this.color;Le({depth:a,color:i.line,flyColor:i.flyColor2,pointColor:i.flyColor1,factor:t});const s=new g;for(let o=0;o<e.length;o++){const{coords:a,path:i}=e[o],r=Ke(a.map((e=>e.map((e=>e*t)))));r.name=i,s.add(r)}s.name="飞线集合",s.renderOrder=20,this.flywireGroup=s,this.addObject(s)}initMapBar(e,t){if(!this.config.mapBar)return;if(!this.mapGroup)return;this.clearMapBar();const a=Math.max(...e.map((e=>e.value||0))),{scale:i,depth:s}=this.config,o=this.color,r={height:5,size:.2,factor:i,color1:o.markColor1,color2:o.markColor2};for(let n=0;n<e.length;n++){const{name:o="",value:l=0}=e[n],c=this.mapGroup.getObjectByName(o);if(c){const o=l/a||0,{centroid:p,center:d}=c.data,h=p||d,g=_e({position:[h[0]*i,h[1]*i,s*i],heightRatio:o,label:t(e[n])},r);g.isBar=!0,c.add(g)}else;}}clearMapBar(){this.mapGroup.traverse((e=>{e.isBar&&this.disposeObj(e)}))}initScatter(e){this.scatterGroup&&(this.disposeObj(this.scatterGroup),this.scatterGroup=null);const t=new g;t.name="散点集合";for(let a=0;a<e.length;a++){const i=e[a],[s=0,o=0]=i.coord||[],r=at(this,s,o);r.name=i.name,r.data=i,r.isScatter=!0,t.add(r)}t.rotateX(.5*-Math.PI),this.scatterGroup=t,this.addObject(t)}onDblclick(e){}onPointerDown(e){this.pointer.isClick=!0,this.pointer.tsp=e.timeStamp}onPointerMove(e){const t=this.container,s=this.options.scale;if(ye(e,t,s),this.mapGroup){be.setFromCamera(Ie,this.camera);const e=[this.mapGroup];this.scatterGroup&&e.push(this.scatterGroup);const t=be.intersectObjects(e);if(this.container.style.cursor=t.length?"pointer":"auto",t.length>0){const e=t[0].object;let s;const o=this.findParentGroupGroupUuid(e);o&&(s=o.uuid,p(this,a,i).call(this,o)),this.setMapBlockColor(s)}else p(this,a,i).call(this),this.setMapBlockColor()}}onPointerUp(e){this.pointer.isClick=!1;const t=e.timeStamp-this.pointer.tsp<(this.config.rightClickBackDiffTime||he.rightClickBackDiffTime);2==e.button||(0==e.button?t&&this.clickObject(e):e.button)}findParentGroupGroupUuid(e){const t=e=>{let a=e.parent;if(a)return a&&a.isProvinceGroup||a.isScatter?a:t(a)};return t(e)}setMapBlockColor(e){this.mapGroup.traverse((t=>{if(t.isProvinceBlock)t.material[0].color.set(t.parent.uuid===e?this.color.mainHover:this.color.main),t.material[1].color.set(t.parent.uuid===e?this.color.borderHoverColor:this.color.borderColor);else if(t.isLabel){const a=t.parent.uuid===e;t.element.className="map-3D-label"+(a?" is-active":"")}}))}clickObject(e){const a=this.container,i=this.options.scale;if(ye(e,a,i),this.scatterGroup){be.setFromCamera(Ie,this.camera);const e=[this.scatterGroup],a=be.intersectObjects(e);if(this.container.style.cursor=a.length?"pointer":"auto",a.length){const e=a[0].object,i=this.findParentGroupGroupUuid(e).data||{};"function"==typeof n(this,t)&&n(this,t).call(this,i)}}}resetSceneEle(){const{x:e,y:t,z:a}=De;if(this.camera.lookAt(e,t,a),new f(this.camera.position).to({x:e,y:90*this.config.scale,z:a+40*this.config.scale},1e3).easing(C.Quadratic.In).start().onUpdate((()=>{})),this.controls.target=new E(e,t,a-5*this.config.scale),this.grid){this.grid.position.set(e,0,a);const t=this.scene.getObjectByProperty("_isGridFork_",!0);t&&t.position.set(e,0,a)}}modelAnimate(){let e=this.clock.getDelta();this.corrugatedPlate&&we(this.corrugatedPlate,e),this.css3DRender&&this.css3DRender.render(this.scene,this.camera),Pe&&(Pe.offset.y+=.005),this.outRingMesh&&(this.outRingMesh.rotation.z+=5e-4),this.innerRingMesh&&(this.innerRingMesh.rotation.z-=5e-4),this.outline&&je(this.outline),this.flywireGroup&&xe()}resize(){if(super.resize(),this.css3DRender){const{width:e,height:t}=this.options;this.css3DRender.setSize(e,t)}}}e=new WeakMap,t=new WeakMap,a=new WeakSet,i=function(t){"function"==typeof n(this,e)&&n(this,e).call(this,t,ve)};const st=me(G({__name:"index",props:{devEnv:{type:Boolean},baseUrl:{},bgColor:{},skyCode:{},bgUrl:{},env:{},scale:{},camera:{default:()=>({})},cruise:{default:()=>({})},fog:{default:()=>({})},render:{default:()=>({})},controls:{default:()=>({})},grid:{default:()=>({})},axes:{default:()=>({})},directionalLight:{},color:{default:()=>({})},config:{default:()=>({})},corrugatedPlate:{type:Boolean,default:!0},mapJson:{},outlineJson:{},flywire:{},barList:{},scatters:{},barLabelRender:{}},emits:["init","click"],setup(e,{expose:t,emit:a}){const{backgroundLoad:i}=ge(),{transformGeoJSON:s}=ce(),{show:o,dialog:r}=ue({style:{left:"0px",top:"0px"},extend:{}}),n=e,l=R(),c=a;Q((()=>n.scale),(e=>{null==h||h.setScale(e||1)})),Q((()=>n.mapJson),(e=>{e&&(null==h||h.initMap(s(e)))})),Q((()=>n.outlineJson),(e=>{e&&(null==h||h.initMapOutLine(s(e)),n.barList&&(null==h||h.initMapBar(n.barList||[],p)))})),Q((()=>n.flywire),(e=>{null==h||h.initFlywire(e||[])})),Q((()=>n.barList),(e=>{null==h||h.initMapBar(e||[],p)})),Q((()=>n.scatters),(e=>{null==h||h.initScatter(e||[])}));const p=e=>{if("function"==typeof n.barLabelRender)return n.barLabelRender(e);const{name:t="",value:a=0,unit:i=""}=e;return{name:`\n      <div class="label-wrap">\n        <div class="name">${t}</div>\n        <div class="text">\n          <span class="value">${Z(a)}</span>\n          <span class="unit">${i}</span>\n        </div>\n      </div>\n    `,className:"map-bar-label"}},d={baseUrl:n.baseUrl,bgUrl:n.bgUrl,env:n.env,bgColor:n.bgColor,camera:n.camera,cruise:n.cruise,fog:n.fog,render:n.render,grid:n.grid,controls:n.controls,axes:n.axes};let h;return M((()=>{d.container=l.value,h=new it(d,n.config,n.color,((e,t)=>{let a=!!e;if(a){r.style&&(r.style.left=t.left+"px",r.style.top=t.top+"px");const i=e.isScatter,s=e.data;if(i)s.isScatter=!0,r.extend=s;else{const t=(n.barList||[]).find((t=>t.name==e.name));t?r.extend=t:a=!1}}o.value=a}),(e=>{c("click",j(e))})),h.run(),c("init",h),n.skyCode&&i(h,n.skyCode),n.corrugatedPlate&&(null==h||h.addCorrugatedPlate()),n.flywire&&n.flywire.length&&(null==h||h.initFlywire(n.flywire))})),t({exportImage:()=>null==h?void 0:h.exportImage()}),(e,t)=>(L(),K("div",{class:_(e.$style["map-scene"])},[x("div",{class:_(e.$style.container),ref_key:"containerRef",ref:l},null,2),D(o)?(L(),K("div",{key:0,class:_(e.$style["dialog-view"]),style:O(D(r).style)},[F(e.$slots,"dialog",{data:D(r).extend})],6)):Y("",!0)],2))}}),[["__cssModules",{$style:{"map-scene":"_map-scene_5opvk_2",container:"_container_5opvk_8","dialog-view":"_dialog-view_5opvk_12"}}]]),ot={depth:2,scale:40,plateRadius:100},rt={main:3377879,mainHover:9633791,borderColor:9633791,borderHoverColor:1066618,light:1066618,lightHover:9633791,plateColor:3377879,plateLight:1066618,line:9559027,line2:6421501,gridColor:663606,gridFork:927811,outline:11856636,markColor1:13303807,markColor2:6945023,flyColor1:9559027,flyColor2:6421501,scatterColor1:9559027,scatterColor2:6421501},nt=["src"],lt=me(G({__name:"index",setup(e){const{load:t}=pe(),a=R(),i=P({devEnv:!0,baseUrl:"",bgColor:464681,color:rt,config:{...ot,areaLabel:!0,markLight:!0,map:{}},camera:{position:[0,100,200]},directionalLight:{helper:!0},fog:{visible:!1,near:2e3,far:3e3},render:{preserveDrawingBuffer:!0},grid:{visible:!0,gridColor:rt.gridColor,centerLineColor:rt.gridColor,fork:!0,divisions:40,width:2*ot.plateRadius*ot.scale,forkSize:1.4*ot.scale,forkColor:rt.gridFork},controls:{maxDistance:5e3,enableDamping:!0},axes:{visible:!0},mapJson:null,outlineJson:null,flywire:[],barList:[],scatters:[]}),s=()=>{var e;return null==(e=a.value)?void 0:e.exportImage()},o=e=>{const a=i.baseUrl;t(`${a}/oss/map/china.json`).then((e=>{i.mapJson=e})),t(`${a}/oss/map/china-outline.json`).then((e=>{i.outlineJson=e})),ee(e).resize()},r=e=>{W.info({message:e.name,grouping:!0})},n=e=>{const{name:t="",value:a=0,unit:i=""}=e;return{name:`\n      <div class="label-wrap">\n        <div class="name">${t}</div>\n        <div class="text">\n          <span class="value">${Ee(a)}</span>\n          <span class="unit">${i}</span>\n        </div>\n      </div>\n    `,className:"map-bar-label"}},l=()=>{fe.get(Ce.d3.map).then((e=>{const t=[],a=[];return e.list.forEach((e=>{const i=e.projects.length;let s=e.province;["重庆","北京","天津","上海"].includes(s)&&(s+="市"),["台湾"].includes(s)&&(s+="省"),e.projects.forEach((a=>{t.push({coord:[a.lng,a.lat],name:a.name,carbon:a.carbon,value:a.use,total:i,city:e.province,id:a.id})}));const o=e.total;-1===a.findIndex((e=>e.name===s))&&a.push({id:e.code,name:s,total:i,value:o,unit:"kWh"})})),{citys:a,projects:t,lines:e.lines}})).then((e=>{i.flywire=e.lines,i.barList=e.citys,i.scatters=e.projects}))};return M((()=>{l()})),(e,t)=>{const l=T;return L(),K("div",{class:_([e.$style.page,"h-100 o-h"])},[x("div",{class:_(e.$style.operate)},[q(l,{type:"primary",size:"small",onClick:s},{default:z((()=>t[0]||(t[0]=[V("导出")]))),_:1})],2),q(st,{ref_key:"threeSceneRef",ref:a,"dev-env":D(i).devEnv,"base-url":D(i).baseUrl,"bg-color":D(i).bgColor,"bg-url":D(i).bgUrl,env:D(i).env,"sky-code":D(i).skyCode,camera:D(i).camera,cruise:D(i).cruise,render:D(i).render,controls:D(i).controls,"directional-light":D(i).directionalLight,grid:D(i).grid,axes:D(i).axes,config:D(i).config,color:D(i).color,"map-json":D(i).mapJson,"outline-json":D(i).outlineJson,flywire:D(i).flywire,"bar-list":D(i).barList,scatters:D(i).scatters,"bar-label-render":n,onInit:o,onClick:r},{dialog:z((({data:a})=>[x("div",{class:_(e.$style["dialog-view"])},[x("div",{class:_([e.$style.city,"flex"])},[x("span",{class:_(e.$style.name)},$(a.isScatter?a.city:a.name),3),x("span",{class:_(e.$style.total)},$(a.total)+"个项目",3)],2),a.isScatter?(L(),K("div",{key:0,class:_([e.$style.project,"flex flex-ac"])},[x("img",{src:`${D(i).baseUrl}/oss/img/map/pos.png`,alt:""},null,8,nt),x("span",{class:_(e.$style.name)},$(a.name),3)],2)):Y("",!0),x("div",{class:_(e.$style.count)},[x("div",{class:_(e.$style.item)},[t[1]||(t[1]=x("span",null,"今日用电量",-1)),x("span",null,$(D(Ee)(a.value)),1),t[2]||(t[2]=x("span",null,"kWh",-1))],2),a.isScatter?(L(),K("div",{key:0,class:_(e.$style.item)},[t[3]||(t[3]=x("span",null,"今日碳排放",-1)),x("span",null,$(D(Ee)(a.carbon)),1),t[4]||(t[4]=x("span",null,"kgCO₂",-1))],2)):Y("",!0)],2)],2)])),_:1},8,["dev-env","base-url","bg-color","bg-url","env","sky-code","camera","cruise","render","controls","directional-light","grid","axes","config","color","map-json","outline-json","flywire","bar-list","scatters"])],2)}}}),[["__cssModules",{$style:{page:"_page_dcgzt_2",operate:"_operate_dcgzt_8","dialog-view":"_dialog-view_dcgzt_15",city:"_city_dcgzt_20",name:"_name_dcgzt_20",total:"_total_dcgzt_28",project:"_project_dcgzt_33",count:"_count_dcgzt_48",item:"_item_dcgzt_52"}}]]);export{lt as default};
