{"version":3,"file":"index-bb989d28.js","sources":["../../../code/src/pages/canvas/fireworks/index.vue"],"sourcesContent":["<template>\n  <div class=\"page\" ref=\"pageRef\">\n\n    <el-link style=\"position: absolute; z-index: 11; top: 10px; left: 10px;\" type=\"primary\" @click=\"clear\">Clear</el-link>\n    <canvas ref=\"canvas\" @click=\"onClick\"></canvas>\n\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\ninterface Ball {\n  step: number\n  max: number\n  x: number\n  y: number\n  // 方向\n  dirx: number\n  diry: number\n  color: string\n}\nconst balls = ref<Array<Ball>>( [] )\n\nconst pageRef = ref()\nconst canvas = ref()\n\nconst clear = () => {\n  const cvs = canvas.value\n  // ctx.fillStyle = 'rgba(0,0,0,.1)'\n  ctx.clearRect( 0, 0, cvs.width, cvs.height )\n\n  balls.value = []\n}\n\nconst onClick = ( e ) => {\n  const { offsetX: x, offsetY: y } = e\n  const num = 80\n  const hd = Math.PI * 2 / num\n  for ( let i = 0; i < num; i ++ ) {\n    balls.value.push( {\n      step: 0,\n      max: Math.random() * 50 + 50,\n      x,\n      y,\n      // 方向\n      dirx: Math.cos( hd * i ) * Math.random() * 3,\n      diry: Math.sin( hd * i ) * Math.random() * 3,\n      color: `hsl( ${ Math.random() * 360 }, 70%, 50% )`,\n      // color: `#${ ( Math.random().toString( 16 ) + 'ffffff' ).substring( 2, 8 ) }`,\n    } )\n  }\n}\n\nlet ctx: any\nconst initCanvas = () => {\n  const page = pageRef.value\n  const width = page.clientWidth,\n    height = page.clientHeight\n  const cvs = canvas.value\n  cvs.width = width\n  cvs.height = height\n  ctx = cvs.getContext( '2d' )\n}\n\nlet __ID__: any\nconst animate = () => {\n  __ID__ = window.requestAnimationFrame( animate )\n\n  balls.value.forEach( ( e, index ) => {\n    update( e, index )\n  } )\n}\n\nconst update = ( e, index ) => {\n  e.step += 1\n  e.dirx *= .99\n  e.diry *= .99\n  e.diry += .05\n  e.x += e.dirx\n  e.y += e.diry\n  draw( e )\n  if ( e.step >= e.max ) {\n    balls.value.splice( index, 1 )\n  }\n}\n\nconst draw = ( { x, y, color } ) => {\n  if ( !ctx ) return\n  ctx.beginPath()\n  ctx.fillStyle = color\n  ctx.arc( x, y, 2, 0, Math.PI * 2 )\n  ctx.fill()\n  ctx.closePath()\n}\n\nonMounted( () => {\n  initCanvas()\n  window.addEventListener( 'resize', initCanvas )\n  animate()\n} )\n\nonBeforeUnmount( () => {\n  window.removeEventListener( 'resize', initCanvas )\n  cancelAnimationFrame( __ID__ )\n} )\n</script>\n  \n<style lang=\"scss\" scoped>\n.page {\n  overflow: hidden;\n  position: relative;\n}\n\ncanvas {\n  z-index: 10;\n  position: relative;\n  background-color: #000;\n}\n</style>"],"names":["balls","ref","pageRef","canvas","clear","cvs","value","ctx","clearRect","width","height","onClick","e","offsetX","x","offsetY","y","hd","Math","PI","i","push","step","max","random","dirx","cos","diry","sin","color","initCanvas","page","clientWidth","clientHeight","getContext","__ID__","animate","window","requestAnimationFrame","forEach","index","update","draw","splice","beginPath","fillStyle","arc","fill","closePath","onMounted","addEventListener","onBeforeUnmount","removeEventListener","cancelAnimationFrame"],"mappings":"yLAoBA,MAAAA,EAAAC,EAAA,IAEAC,EAAAD,IACAE,EAAAF,IAEAG,EAAA,KACE,MAAAC,EAAAF,EAAAG,MAEAC,EAAAC,UAAA,EAAA,EAAAH,EAAAI,MAAAJ,EAAAK,QAEAV,EAAAM,MAAA,IAGFK,EAAAC,IACE,MAAAC,QAAAC,EAAAC,QAAAC,GAAAJ,EAEAK,EAAA,EAAAC,KAAAC,GADA,GAEA,IAAA,IAAAC,EAAA,EAAAA,EAFA,GAEAA,IACEpB,EAAAM,MAAAe,KAAA,CAAkBC,KAAA,EACVC,IAAA,GAAAL,KAAAM,SAAA,GACoBV,IAC1BE,IACAS,KAAAP,KAAAQ,IAAAT,EAAAG,GAAAF,KAAAM,SAAA,EAE2CG,KAAAT,KAAAU,IAAAX,EAAAG,GAAAF,KAAAM,SAAA,EACAK,MAAA,QAAA,IAAAX,KAAAM,wBAG3C,EAIN,IAAAjB,EACA,MAAAuB,EAAA,KACE,MAAAC,EAAA7B,EAAAI,MACAG,EAAAsB,EAAAC,YAAAtB,EAAAqB,EAAAE,aAEA5B,EAAAF,EAAAG,MACAD,EAAAI,MAAAA,EACAJ,EAAAK,OAAAA,EACAH,EAAAF,EAAA6B,WAAA,KAAA,EAGF,IAAAC,EACA,MAAAC,EAAA,KACED,EAAAE,OAAAC,sBAAAF,GAEApC,EAAAM,MAAAiC,SAAA,CAAA3B,EAAA4B,KACEC,EAAA7B,EAAA4B,EAAA,GAAiB,EAIrBC,EAAA,CAAA7B,EAAA4B,KACE5B,EAAAU,MAAA,EACAV,EAAAa,MAAA,IACAb,EAAAe,MAAA,IACAf,EAAAe,MAAA,IACAf,EAAAE,GAAAF,EAAAa,KACAb,EAAAI,GAAAJ,EAAAe,KACAe,EAAA9B,GACAA,EAAAU,MAAAV,EAAAW,KACEvB,EAAAM,MAAAqC,OAAAH,EAAA,EAA6B,EAIjCE,EAAA,EAAA5B,IAAAE,IAAAa,YACEtB,IACAA,EAAAqC,YACArC,EAAAsC,UAAAhB,EACAtB,EAAAuC,IAAAhC,EAAAE,EAAA,EAAA,EAAA,EAAAE,KAAAC,IACAZ,EAAAwC,OACAxC,EAAAyC,YAAA,SAGFC,GAAA,SAEEZ,OAAAa,iBAAA,SAAApB,UAIFqB,GAAA,KACEd,OAAAe,oBAAA,SAAAtB,GACAuB,qBAAAlB,EAAA"}