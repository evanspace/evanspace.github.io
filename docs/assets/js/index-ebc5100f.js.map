{"version":3,"file":"index-ebc5100f.js","sources":["../../../code/src/pages/animation/hash/index.vue"],"sourcesContent":["<template>\n  <div class=\"page\">\n\n    <div style=\"padding: 20px;\">\n      <el-radio-group v-model=\"radio\" @change=\"onTypeChange\">\n        <el-radio v-for=\"( item, index ) in list\" :value=\"item.key\" :key=\"index\">{{ item.name }}</el-radio>\n      </el-radio-group>\n\n\n      <div style=\"padding: 20px 0;\">\n        {{ current.join('') }}\n      </div>\n\n      <video src=\"/video/005.mp4\" ref=\"video\" v-show=\"radio == 'Progress'\" controls></video>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nconst list = ref([\n  {\n    key: 'Moon',\n    name: '月亮脸',\n  }, {\n    key: 'Clock',\n    name: '时钟',\n  }, {\n    key: 'Boy',\n    name: '小男孩',\n  }, {\n    key: 'Earth',\n    name: '地球转动',\n  }, {\n    key: 'Wave',\n    name: '波浪'\n  }, {\n    key: 'Flex',\n    name: '伸缩'\n  }, {\n    key: 'Progress',\n    name: '进度'\n  }\n])\n\nconst radio = ref('')\nconst current = ref([])\nlet __timer__: any\n\nconst onTypeChange = (e) => {\n  clearTimeout(__timer__)\n  current.value = []\n  switch (e) {\n    case 'Moon':\n      runMoon()\n      break\n    case 'Clock':\n      runClock()\n      break\n    case 'Boy':\n      runBoy()\n      break\n    case 'Earth':\n      runEarth()\n      break\n    case 'Wave':\n      runWave()\n      break\n    case 'Flex':\n      runFlex()\n      break\n    case 'Progress':\n      runProgress()\n      break\n  }\n}\n\nconst hashKey = 'HASH_ANIM'\n\nconst updateUrl = (list) => {\n  current.value = list\n  // 获取当前URL\n  const url = window.location.href\n  // 修改query参数\n  const newQuery = hashKey + '=' + list.join('')\n  // 拼接新的URL\n  const newUrl = url.split('?')[0] + '?' + newQuery\n  // 修改地址栏URL\n  window.history.pushState(null, '', newUrl)\n}\n\nconst runMoon = () => {\n  const items = ['🌑', '🌒', '🌓', '🌔', '🌝', '🌖', '🌗', '🌘']\n  const len = items.length\n  current.value = []\n  const loop = () => {\n    const index = Math.floor((Date.now() / 100) % len)\n    const list = [items[index]]\n    updateUrl(list)\n    __timer__ = setTimeout(loop, 100)\n  }\n  loop()\n}\n\nconst runClock = () => {\n  const items = ['🕐', '🕑', '🕒', '🕓', '🕔', '🕕', '🕖', '🕗', '🕘', '🕙', '🕚', '🕛']\n  const len = items.length\n  current.value = []\n  const loop = () => {\n    const index = Math.floor((Date.now() / 100) % len)\n    const list = [items[index]]\n    updateUrl(list)\n    __timer__ = setTimeout(loop, 100)\n  }\n  loop()\n}\n\nconst runBoy = () => {\n  const items = ['🏻', '🏼', '🏽', '🏾', '🏿']\n  const loop = () => {\n    current.value = []\n    let i, m\n    let list: string[] = []\n    for (i = 0; i < 10; i++) {\n      m = Math.floor(items.length * ((Math.sin((Date.now() / 100) + i) + 1) / 2))\n      const d = '👶' + items[m]\n      list.push(d)\n    }\n    updateUrl(list)\n    __timer__ = setTimeout(loop, 100)\n  }\n  loop()\n}\n\nconst runEarth = () => {\n  let f = ['🌑', '🌘', '🌗', '🌖', '🌕', '🌔', '🌓', '🌒'],\n    d = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    m = 0\n  const loop = () => {\n    let list: string[] = []\n    let x = 0\n    current.value = []\n    if (!m) {\n      while (d[x] == 4) {\n        x++\n      }\n      if (x >= d.length) m = 1\n      else {\n        d[x]++\n      }\n    }\n    else {\n      while (d[x] == 0) {\n        x++\n      }\n      if (x >= d.length) m = 0\n      else {\n        d[x]++\n        if (d[x] == 8) d[x] = 0\n      }\n    }\n    d.forEach((n) => {\n      list.push(f[n])\n    })\n    updateUrl(list)\n    __timer__ = setTimeout(loop, 100)\n  }\n  loop()\n}\n\nconst runWave = () => {\n  const loop = () => {\n    let i, n, list: string[] = []\n    current.value = []\n    for (i = 0; i < 10; i++) {\n      n = Math.floor(Math.sin((Date.now() / 200) + (i / 2)) * 4) + 4\n      const d = String.fromCharCode(0x2581 + n)\n      list.push(d)\n    }\n    updateUrl(list)\n    __timer__ = setTimeout(loop, 100)\n  }\n  loop()\n}\n\nconst runFlex = () => {\n  const loop = () => {\n    let list: string[] = [], p\n    current.value = []\n\n    p = Math.floor(((Math.sin(Date.now() / 300) + 1) / 2) * 100)\n    while (p >= 8) {\n      list.push('█')\n      p -= 8\n    }\n    const d = ['⠀', '▏', '▎', '▍', '▌', '▋', '▊', '▉'][p]\n    list.push(d)\n\n    updateUrl(list)\n    __timer__ = setTimeout(loop, 100)\n  }\n  loop()\n}\n\nconst video = ref()\nconst runProgress = () => {\n  const v = video.value\n  const formatTime = seconds => {\n    const minutes = Math.floor(seconds / 60)\n    seconds = Math.floor(seconds - (minutes * 60))\n    return ('0' + minutes).substring(-2) + ':' + ('0' + seconds).substring(-2)\n  }\n\n  const renderProgressBar = () => {\n    var s = '',\n      l = 15,\n      p = Math.floor(v.currentTime / v.duration * (l - 1)),\n      i\n    for (i = 0; i < l; i++) {\n      if (i == p) s += '◯'\n      else if (i < p) s += '─'\n      else s += '┄'\n    }\n    const list = [\n      '╭', s, '╮', formatTime(v.currentTime), '╱', formatTime(v.duration)\n    ]\n    updateUrl(list)\n  }\n  renderProgressBar()\n  v.addEventListener('timeupdate', renderProgressBar)\n}\n\nonBeforeUnmount(() => {\n  clearTimeout(__timer__)\n})\n</script>\n\n<style></style>"],"names":["list","ref","key","name","radio","current","__timer__","onTypeChange","e","clearTimeout","value","updateUrl","list2","url","window","location","href","newQuery","hashKey","join","newUrl","split","history","pushState","runMoon","items","len","length","loop","index","Math","floor","Date","now","setTimeout","runClock","runBoy","i","m","sin","d","push","runEarth","f","x","forEach","n","runWave","String","fromCharCode","runFlex","p","video","runProgress","v","formatTime","seconds","minutes","substring","renderProgressBar","s","currentTime","duration","addEventListener","onBeforeUnmount"],"mappings":"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"}