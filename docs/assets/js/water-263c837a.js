import{d as e,r as a,aZ as t,a_ as n,g as o,o as i,z as s,a as r,c as l,b as d,b2 as c,bR as m,bS as u,bf as p,bT as g,bU as f,a$ as h,bD as b,bV as w,bW as v,bX as x,bY as y,b9 as C,bb as S}from"./vendor-59c65e9f.js";import{c as z,a as E,b as _,e as M}from"./cssd2-8d8e037d.js";import{a as j}from"./common-24a0b7a6.js";const D={title:"water",order:1},P={class:"page h-100"},F=e({__name:"index",setup(e){const D=j(),F=a(),G=new t;let T,W,L,R;G.background=new n("#fff");const k=()=>{const e=F.value;if(!T)return;const a=e.clientWidth,t=e.clientHeight,n=a/t;T.aspect=n,T.updateProjectionMatrix(),W.setSize(a,t)};let A;const H=()=>{A=requestAnimationFrame(H),I(),W.render(G,T)},I=()=>{let e=.001*performance.now();Y.position.y=20*Math.sin(e)+5,Y.rotation.x=.5*e,Y.rotation.z=.51*e,q.material.uniforms.time.value+=1/60},O=o({turbidity:10,rayleigh:2,mieCoefficient:.005,mieDirectionalG:.2,elevation:2,azimuth:180,exposure:null});let $;let q;const B=()=>{const e=new g(1e4,1e4);q=new f(e,{textureWidth:512,textureHeight:512,waterNormals:(new h).load(`${D.oss}/textures/waternormals.jpg`,(e=>{e.wrapS=e.wrapT=b})),sunDirection:new p,sunColor:16777215,waterColor:7695,distortionScale:3.7,fog:void 0!==G.fog}),q.rotation.x=-Math.PI/2,G.add(q)};let N;const U=()=>{N=new w,N.scale.setScalar(1e4),G.add(N)};let V;const X=()=>{const e=N.material.uniforms;e.turbidity.value=O.turbidity,e.rayleigh.value=O.rayleigh,e.mieCoefficient.value=O.mieCoefficient,e.mieDirectionalG.value=O.mieDirectionalG;const a=v.degToRad(90-O.elevation),t=v.degToRad(O.azimuth);V.setFromSphericalCoords(1,a,t),N.material.uniforms.sunPosition.value.copy(V),q.material.uniforms.sunDirection.value.copy(V).normalize(),G.environment=$.fromScene(N).texture,W.toneMappingExposure=O.exposure};let Y;const Z=()=>{let e=new x(30,30,30),a=new y({roughness:0,color:1365});Y=new C(e,a),G.add(Y)},J=()=>{const e=F.value;W=z(e),T=E(e,1,1e6),R=new c(16777215,1.5),G.add(R),M(16777215,1.5),L=_(T,W),L.maxPolarAngle=.45*Math.PI,L.screenSpacePanning=!1,B(),U(),W.toneMapping=m,W.outputEncoding=void 0,W.toneMappingExposure=1,O.exposure=W.toneMappingExposure,$=new u(W),V=new p,X(),Z(),(e=>{const a=new S,t=a.addFolder("Sky");t.add(O,"turbidity",0,100,.1).name("浑浊").onChange(X),t.add(O,"rayleigh",0,4,.001).name("锐利").onChange(X),t.add(O,"mieCoefficient",0,.1,.001).name("散射系数").onChange(X),t.add(O,"mieDirectionalG",0,1,.001).name("方向").onChange(X),t.add(O,"elevation",0,90,.1).name("高度").onChange(X),t.add(O,"azimuth",-180,180,.1).name("方位").onChange(X),t.add(O,"exposure",0,1,1e-4).name("光晕强度").onChange(X);const n=a.addFolder("Water"),o=q.material.uniforms;n.add(o.distortionScale,"value",0,100,.1).name("变形尺度"),n.add(o.size,"value",.1,10,.1).name("大小"),a.domElement.style="position: absolute; top: 10px; right: 10px",e.appendChild(a.domElement)})(e)};return i((()=>{J(),H(),window.addEventListener("resize",k,!1)})),s((()=>{window.addEventListener("resize",k,!1),cancelAnimationFrame(A);try{G.clear(),W.dispose(),W.forceContextLoss(),W.content=null;let e=W.domElement.getContext("webgl");e&&e.getExtension("WEBGL_lose_context").loseContext()}catch(e){}})),(e,a)=>(r(),l("div",P,[d("div",{ref_key:"containerRef",ref:F,class:"container h-100",style:{position:"relative"}},null,512)]))}}),G=Object.freeze(Object.defineProperty({__proto__:null,default:F},Symbol.toStringTag,{value:"Module"}));export{D as _,G as i};
