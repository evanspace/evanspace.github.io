{"version":3,"file":"index-5b5867b8.js","sources":["../../../code/src/pages/webgl/scene/office/edit-dialog.vue","../../../code/src/pages/webgl/scene/office/first-person.vue","../../../code/src/pages/webgl/scene/office/data.ts","../../../code/src/pages/webgl/scene/office/emitter.ts","../../../code/src/pages/webgl/scene/office/config.ts","../../../code/src/pages/webgl/scene/office/fleetings.ts","../../../code/src/pages/webgl/scene/office/methods.ts","../../../code/src/pages/webgl/scene/office/index.vue","../../../code/src/pages/webgl/scene/office/request.ts","../../../code/src/pages/webgl/scene/office/listen.ts"],"sourcesContent":["<template>\n  <div class=\"screen-welcom-dialog\" v-if=\"visible\">\n    <div class=\"mask\" @click=\"visible = !visible\"></div>\n    <div class=\"wrap\">\n      <div class=\"body\">\n        <div class=\"title\">\n          <div class=\"bg\">{{ title }}</div>\n          <div class=\"text\">{{ title }}</div>\n        </div>\n        <div class=\"content\">\n          <el-input\n            type=\"textarea\"\n            v-model=\"content\"\n            placeholder=\"请输入\"\n            maxlength=\"24\"\n            show-word-limit\n          ></el-input>\n        </div>\n        <div class=\"footer\">\n          <div class=\"btn\" @click=\"onConfirm\"></div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { trim } from '@/common/utils/format'\n\nconst props = defineProps<{\n  title?: string\n  errMessage?: string\n}>()\n\nconst visible = defineModel<boolean>()\nconst content = defineModel<string>('content')\n\nconst emits = defineEmits<{\n  confirm: [text?: string]\n}>()\n\nconst onConfirm = () => {\n  const text = trim(content.value || '')\n  if (!text) {\n    ElMessage.warning({\n      message: props.errMessage,\n      grouping: true\n    })\n    return\n  }\n  visible.value = false\n  emits('confirm', content.value)\n}\n</script>\n\n<style lang=\"scss\">\n.screen-welcom-dialog {\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 1;\n  position: fixed;\n  .mask {\n    width: 100%;\n    height: 100%;\n  }\n  .wrap {\n    top: 50%;\n    left: 50%;\n    width: 513px;\n    position: absolute;\n    transform: translate(-50%, -50%);\n    backdrop-filter: blur(5px);\n  }\n  .body {\n    background: url('/oss/img/scene/edit-bg.png') no-repeat;\n    background-size: 100% 100%;\n  }\n\n  .mask {\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    content: '';\n    position: absolute;\n  }\n\n  .title {\n    height: 34px;\n    position: relative;\n    font-size: 20px;\n    line-height: 34px;\n    padding-left: 35px;\n    .bg,\n    .text {\n      position: absolute;\n      font-family: 'YouShe';\n    }\n    .text {\n      color: #e4f3ef;\n    }\n    .bg {\n      text-shadow: 0px 1px 5px #49afdb;\n      -webkit-background-clip: text;\n      -webkit-text-fill-color: transparent;\n    }\n  }\n\n  .content {\n    height: 210px;\n    padding: 48px 29px 10px 27px;\n\n    .el-textarea {\n      height: 100%;\n      background-color: rgba($color: #a8bfde, $alpha: 0.1);\n      --el-border-color: transparent;\n      --el-input-border-radius: 0;\n      textarea {\n        height: 100%;\n      }\n    }\n  }\n\n  .footer {\n    padding: 16px;\n    text-align: center;\n    .btn {\n      width: 150px;\n      height: 42px;\n      cursor: pointer;\n      display: inline-block;\n      background: url('/oss/img/scene/edit-btn.png');\n      background-size: 100% 100%;\n      &:hover {\n        opacity: 0.85;\n      }\n      &:active {\n        opacity: 0.75;\n      }\n    }\n  }\n}\n</style>\n","<template>\n  <div :class=\"$style.page\" class=\"character-sight\">\n    <div :class=\"$style.tip\">\n      <div :class=\"$style.item\" v-for=\"item in items\">\n        <span>{{ item.code }}</span>\n        <span>{{ item.desc }}</span>\n      </div>\n    </div>\n\n    <div :class=\"$style.center\"></div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nconst items = [\n  { code: 'W', desc: '前进' },\n  { code: 'S', desc: '后退' },\n  { code: 'A', desc: '向左转向' },\n  { code: 'D', desc: '向右转向' },\n  { code: 'X', desc: '加速' },\n  { code: 'Z', desc: '减速' }\n]\n</script>\n\n<style lang=\"scss\" module>\n.page {\n  --bg-color: #0f365f;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: none;\n  position: absolute;\n  transition: all 0.5s;\n  background: radial-gradient(transparent 75%, var(--bg-color));\n  pointer-events: none;\n}\n\n.tip {\n  top: 11.5%;\n  width: 100%;\n  display: flex;\n  position: absolute;\n  justify-content: center;\n\n  .item {\n    padding: 10px;\n    display: flex;\n    align-items: center;\n    span {\n      &:nth-child(1) {\n        padding: 3px 5px;\n        margin-right: 5px;\n        border-radius: 3px;\n        background-color: #000;\n      }\n    }\n  }\n}\n\n.center {\n  --color: #0be10e;\n  $size: 20px;\n  top: 50%;\n  left: 50%;\n  width: $size;\n  height: $size;\n  opacity: 0.5;\n  // border: 1px dashed var(--color);\n  position: absolute;\n  transform: translate(-50%, -50%);\n  border-radius: 50%;\n  &::before,\n  &::after {\n    top: 50%;\n    left: 50%;\n    content: '';\n    position: absolute;\n    transform: translate(-50%, -50%);\n    border-radius: 50%;\n    background-color: var(--color);\n  }\n  &::after {\n    width: $size;\n    height: 1px;\n  }\n  &::before {\n    width: 1px;\n    height: $size;\n  }\n}\n</style>\n","const base = import.meta.env.VITE_BEFORE_STATIC_PATH\n\nconst devEnv = import.meta.env.VITE_MODE !== 'production-'\n\nexport const ANCHOR_POS = 'ANCHOR_POS' // 定位\nexport const ANCHOR_TARGET = 'ANCHOR_TARGET' // 锚点\nexport const MAIN_SCENE = 'MAIN_SCENE' // 主场景\nexport const CONPANT_FLOOR = 'campany_floor' // 公司楼层\nexport const CURTAIN = 'curtain' // 窗帘\n\nexport const ROBOT = 'ROBOT' // 机器人\nexport const CHARACTER = 'CHARACTER' // 人物\nexport const WAIT_LIFT = 'WAIT_LIFT' // 等电梯\nexport const LIGHT_SWITCH = 'LIGHT_SWITCH' // 开关灯\nexport const LIGHT_MAIN_SWITCH = 'LIGHT_MAIN_SWITCH' // 灯总开关\nexport const AIR_SWITCH = 'AIR_SWITCH' // 空调开关\nexport const GATE_SWITCH = 'GATE_SWITCH' // 闸机门禁\nexport const DOUBLE_HORIZONTAL_SWITCH = 'DOUBLE_HORIZONTAL_SWITCH' // 双开横推门\nexport const DOUBLE_ROTATE_SWITCH = 'DOUBLE_ROTATE_SWITCH' // 双旋转开门\nexport const ODD_ROTATE_SWITCH = 'ODD_ROTATE_SWITCH' // 单旋转开门\nexport const VIDEO_SWITCH = 'VIDEO_SWITCH' // 视频\nexport const SCREEN_EDIT = 'SCREEN_EDIT' // 编辑\nexport const CURTAIN_SWITCH = 'CURTAIN_SWITCH' // 窗帘开关\nexport const MODE_SWITCH = 'MODE_SWITCH' // 模式开关\n\nexport const CRUISE_POINT_UP = 0.1 // y 巡航轴向量\n\nexport const ROAM_POINT_UP = 186 // y 漫游轴向量\n\nexport const getPageOpts = animateBack => ({\n  devEnv,\n  baseUrl: base,\n  env: '/oss/textures/hdr/101.hdr',\n  sky: {\n    day: '/oss/textures/hdr/101.hdr',\n    evening: '/oss/textures/hdr/201.hdr',\n    night: '/oss/textures/hdr/301.hdr'\n  },\n\n  config: {},\n\n  // dot 点位类型值\n  dotKey: 'DOT',\n  dotShowStrict: false,\n\n  anchorType: [\n    ANCHOR_POS,\n    ANCHOR_TARGET,\n    WAIT_LIFT,\n    LIGHT_SWITCH,\n    LIGHT_MAIN_SWITCH,\n    AIR_SWITCH,\n    GATE_SWITCH,\n    VIDEO_SWITCH,\n    SCREEN_EDIT,\n    DOUBLE_HORIZONTAL_SWITCH,\n    ODD_ROTATE_SWITCH,\n    DOUBLE_ROTATE_SWITCH,\n    CURTAIN_SWITCH,\n    MODE_SWITCH\n  ],\n  animationModelType: [MAIN_SCENE, CONPANT_FLOOR, CURTAIN],\n\n  models: [\n    {\n      key: MAIN_SCENE,\n      name: '场景',\n      size: 13.4,\n      url: '/公司总部.glb'\n    },\n    {\n      key: 'floor_low',\n      name: '低层',\n      size: 6.1,\n      url: '/低层.glb'\n    },\n    {\n      key: CURTAIN,\n      name: '窗帘',\n      size: 0.2,\n      url: '/窗帘.glb'\n    },\n    {\n      key: 'floor_heigh',\n      name: '高层',\n      size: 2.7,\n      url: '/高层.glb'\n    },\n\n    {\n      key: CONPANT_FLOOR,\n      name: '公司',\n      size: 16.6,\n      url: '/二十五楼.glb'\n    },\n\n    {\n      key: ANCHOR_POS,\n      name: '定位',\n      type: 'sprite',\n      range: { x: 4, y: 4 },\n      mapUrl: '/pos.png'\n    },\n    {\n      key: ANCHOR_TARGET,\n      name: '锚点',\n      type: 'sprite',\n      mapUrl: '/dw.png'\n    },\n    {\n      key: WAIT_LIFT,\n      name: '电梯门',\n      type: 'sprite',\n      mapUrl: '/lift.png'\n    },\n    {\n      key: DOUBLE_HORIZONTAL_SWITCH,\n      name: '双横推开关门',\n      type: 'sprite',\n      mapUrl: '/lift.png',\n      range: { x: 0.3, y: 0.3 }\n    },\n    {\n      key: DOUBLE_ROTATE_SWITCH,\n      name: '双旋转开关门',\n      type: 'sprite',\n      mapUrl: '/lift.png',\n      range: { x: 0.3, y: 0.3 }\n    },\n    {\n      key: ODD_ROTATE_SWITCH,\n      name: '单旋转开关门',\n      type: 'sprite',\n      mapUrl: '/lift.png',\n      range: { x: 0.3, y: 0.3 }\n    },\n    {\n      key: GATE_SWITCH,\n      name: '闸机',\n      type: 'sprite',\n      mapUrl: '/gate.png'\n    },\n\n    {\n      key: VIDEO_SWITCH,\n      name: '视频',\n      type: 'sprite',\n      mapUrl: '/video.png'\n    },\n    {\n      key: SCREEN_EDIT,\n      name: '编辑',\n      type: 'sprite',\n      mapUrl: '/edit.png'\n    },\n    {\n      key: CURTAIN_SWITCH,\n      name: '窗帘',\n      type: 'sprite',\n      mapUrl: '/curtain.png'\n    },\n\n    {\n      key: ROBOT,\n      name: '机器人',\n      size: 0.3,\n      url: '/oss/model/park/机器人.glb'\n    },\n    {\n      key: CHARACTER,\n      name: '人物',\n      size: 2.2,\n      url: '/oss/model/park/RobotExpressive.glb'\n    },\n\n    {\n      key: 'spot_light_floor_1',\n      type: 'spotlight',\n      name: '主机聚光灯',\n      intensity: 8,\n      color: 0xffffed,\n      distance: 20\n    },\n    {\n      key: 'spot_light_floor_2',\n      type: 'spotlight',\n      name: '会议室聚光灯',\n      intensity: 2,\n      color: 0xffffed,\n      castShadow: false,\n      distance: 10\n    },\n\n    {\n      key: 'spot_light_floor_3',\n      type: 'spotlight',\n      name: '屏幕聚光灯',\n      intensity: 1,\n      color: 0xffffed,\n      distance: 15,\n      penumbra: 0.5,\n      castShadow: false,\n      angle: Math.PI * 0.36\n    },\n    {\n      key: 'spot_light_floor_4',\n      type: 'spotlight',\n      name: '屏幕聚光灯',\n      intensity: 2,\n      color: 0xffffed,\n      distance: 12,\n      penumbra: 0.5,\n      castShadow: false,\n      angle: Math.PI * 0.4\n    },\n    {\n      key: 'spot_light_floor_5',\n      type: 'spotlight',\n      name: '屏幕聚光灯',\n      intensity: 2,\n      color: 0xffffed,\n      distance: 8,\n      penumbra: 0.5,\n      castShadow: false,\n      angle: Math.PI * 0.23\n    },\n\n    {\n      key: 'rect_area_light_1',\n      type: 'planelight',\n      name: '面光灯',\n      intensity: 1.2,\n      color: 0xffffff,\n      width: 134,\n      height: 134\n    },\n    {\n      key: 'rect_area_light_2',\n      type: 'planelight',\n      name: '面光灯',\n      intensity: 0.8,\n      color: 0xffffff,\n      width: 134,\n      height: 134\n    },\n\n    {\n      key: LIGHT_SWITCH,\n      name: '开关灯',\n      type: 'sprite',\n      mapUrl: '/light.png'\n    },\n    {\n      key: LIGHT_MAIN_SWITCH,\n      name: '开关灯',\n      type: 'sprite',\n      mapUrl: '/light.png'\n    },\n    {\n      key: AIR_SWITCH,\n      name: '空调',\n      type: 'sprite',\n      mapUrl: '/air.png'\n    },\n    {\n      key: MODE_SWITCH,\n      name: '模式',\n      type: 'sprite',\n      mapUrl: '/mode.png'\n    }\n  ].map(item => {\n    if (item.url && item.url.indexOf('oss') < 0) {\n      item.url = '/oss/model/office' + item.url\n    }\n    if (item.mapUrl) {\n      item.mapUrl = '/oss/textures/office' + item.mapUrl\n    }\n    if (!item.range) {\n      item.range = { x: 0.5, y: 0.5 } as any\n    }\n    return item as import('three-scene/types/model').ModelItem\n  }),\n\n  cruise: {\n    visible: true,\n    auto: true,\n    mapUrl: '/oss/textures/cruise/line18.png', // 1-18\n    // mapUrl: '/oss/textures/cruise/diffuse.jpg', // 1-18\n    repeat: [1, 1],\n    width: 2,\n    segment: 100,\n    tension: 0.01,\n    speed: 10,\n    mapSpeed: 0.1,\n    points: [],\n    close: true,\n    offset: 5.2,\n    animateBack: animateBack\n  },\n\n  // 漫游坐标\n  roamPoints: []\n})\n\nexport const getFloorOpts = () => ({\n  active: 2,\n  show: false,\n  targetName: '',\n  list: [\n    {\n      target: '电梯-2',\n      items: [\n        // key 值需要与 配置的等电梯点位 bing 字段尾数相同\n        { name: '一楼', key: 1, y: 0.1, bind: '_一楼电梯门-2_grp' },\n        { name: '公司', key: 2, y: 184.7, bind: '_电梯外门_2_grp' }\n      ]\n    },\n    {\n      target: '电梯-1',\n      items: [\n        // key 值需要与 配置的等电梯点位 bing 字段尾数相同\n        { name: '一楼', key: 1, y: 0.1, bind: '_一楼电梯门-1_grp' },\n        { name: '公司', key: 2, y: 184.7, bind: '_电梯外门_1_grp' }\n      ]\n    }\n  ]\n})\n\nexport const getTipOpts = () => ({\n  show: false,\n  style: {\n    left: 0,\n    top: 0\n  },\n  msg: ''\n})\n","// 事件\nconst eventNames = [\n  // 漫游\n  'CAMERA:ROAM',\n  // 巡航\n  'CAMERA:CRUISE',\n  // 视角重置\n  'CAMERA:RESET',\n  // 第一人称\n  'CAMERA:FIRST',\n  // 第三人称\n  'CAMERA:THREE',\n\n  // 大门\n  'CAMERA:GATE',\n  // 前台\n  'CAMERA:RECCEPTION',\n  // 办公区域\n  'CAMERA:OFFICE',\n  // 大会议室\n  'CAMERA:LCR',\n  // 老板办公室\n  'CAMERA:BOSS',\n\n  // 人物加速\n  'PERSON:ADD',\n  // 人物减速\n  'PERSON:SUB',\n\n  // 前台灯开关\n  'LIGHT:RECCEPTION',\n  // 过道灯\n  'LIGHT:AILSE',\n  // 人事\n  'LIGHT:PM',\n  // 主机\n  'LIGHT:HOST',\n  // 大会议室\n  'LIGHT:LCR',\n  // 公司主灯光组\n  'LIGHT:CLG',\n  // 一楼灯光组\n  'LIGHT:FIRSTFLOOR',\n\n  // 关灯\n  'LIGHT:CLOSE',\n  // 自动\n  'LIGHT:AUTO',\n\n  // 窗帘\n  'CURTAIN:TOGGLE',\n\n  // 公司大门\n  'DOOR:COMPANY',\n  // 大会议室门\n  'DOOR:LCR',\n  // 老板办公室\n  'DOOR:BOSS',\n\n  // 大屏\n  'SCREEN:COMPANY',\n  // 欢迎词\n  'SCREEN:WELCOM',\n  // 小会议室大屏\n  'SCREEN:SCR',\n  // 大会议室大屏\n  'SCREEN:LCR',\n\n  // 空调\n  'AIR:MAIN',\n  // 单个空调\n  'AIR:ODD',\n\n  // 场景坐标\n  'SCENE:POS',\n\n  // 白天\n  'SKY:DAY',\n  // 傍晚\n  'SKY:EVENING',\n  // 夜晚\n  'SKY:NIGHT',\n\n  // 流光\n  'EFFECT:FLEETING',\n\n  // 鸟瞰视角-公司\n  'BIRD:COMPANY'\n] as const\ntype EventNames = (typeof eventNames)[number]\n\nclass EventEmitter {\n  // 定义一个私有变量，用于存储事件监听器\n  private listteners: Record<string, Set<Function>> = eventNames.reduce((obj, key) => {\n    // 初始化每个事件对应的监听器集合\n    obj[key] = new Set()\n    return obj\n  }, {})\n\n  // 添加事件监听器\n  on(eventName: EventNames, listtener: Function) {\n    this.listteners[eventName].forEach(it => {\n      if (it.toString() === listtener.toString()) {\n        this.listteners[eventName].delete(it)\n      }\n    })\n    // 将监听器添加到对应事件的监听器集合中\n    this.listteners[eventName].add(listtener)\n  }\n\n  // 触发事件\n  emit(eventName: EventNames, ...args: any[]) {\n    // 遍历对应事件的监听器集合，并执行监听器函数\n    this.listteners[eventName].forEach(listtener => listtener(...args))\n  }\n}\n\nexport default new EventEmitter()\n","import fleetings from './fleetings'\n\n// 配置\nexport default {\n  // 判断点击间隔时间\n  clickIntervalTime: 300,\n\n  // 人物视线高度\n  characterSightHeight: 3.5,\n\n  // 碰撞间距\n  collisionSpace: 1,\n\n  // 默认移动速度\n  moveFactor: 1,\n\n  // 场景风格时间段\n  styleTimes: [\n    [8, 18],\n    [18, 20],\n    [20, 8]\n  ],\n\n  // 流光组\n  fleetings,\n\n  // 路灯\n  streetLamps: [\n    [-374.6, 30, 284.2],\n    [-372, 30, 168.8],\n    [-95.35, 30, 299.24],\n    [-95.31, 30, 168.33],\n    [272.61, 30, 299.17],\n    [276.47, 30, 168.4],\n    [271.04, 30, -58.709],\n    [159.86, 30, -56.24],\n    [-134.27, 30, 30.457],\n    [-247.92, 30, -302.57]\n  ],\n\n  // 居民灯\n  residentLights: [\n    [-13, 169.8, 447.2],\n    [668, 114.9, 481.9]\n  ],\n\n  // 公司模型名称\n  companyModelName: '二十五楼'\n}\n","export default [\n  [\n    [-1247.3804124641044, 1.5, 275.8568665121467],\n    [-385.54913233299317, 1.5, 235.37414186604545],\n    [-74.15440788927455, 1.5, 249.36770549275383],\n    [465.22573985771027, 1.5, 245.43607244481086],\n    [725.5941701917296, 1.5, 249.85748872521614],\n    [1298.4540604962947, 1.5, 246.2826397113465],\n    [1540.3121752120794, 1.5, 248.16462011553776],\n    [2035.0305758526924, 1.5, 250.3197618335575],\n    [2247.330156763603, 1.5, 247.35851806181827],\n    [2614.171817337305, 1.5, 241.05764461471873]\n  ],\n  [\n    [653.0182392436438, 1.5, 186.20541161524878],\n    [640.5314650233396, 1.5, -478.1628829727225],\n    [641.5186617371273, 1.5, -741.7856284596322],\n    [641.8860570932816, 1.5, -1180.303297128374],\n    [636.5706330757, 1.5, -1435.6099074377244],\n    [651.4496990930706, 1.5, -2151.481360404476]\n  ],\n\n  [\n    [-184.48466894299744, 1.5, 2447.03846990951],\n    [-186.588766153597, 1.5, 1617.8540886409082],\n    [-184.69458845133832, 1.5, 1300.1784227505875],\n    [-186.39769511236557, 1.5, 361.1691127475875],\n    [-181.39186291802253, 1.5, 100.79623785390046],\n    [-153.08794728573116, 1.5, -361.6354243767241],\n    [-149.96162120866242, 1.5, -670.0291574302669],\n    [-143.93274083461012, 1.5, -1094.1977278309487],\n    [-146.55180744515872, 1.5, -1375.823600978301],\n    [-116.02623152983233, 1.5, -2108.4946603582016]\n  ],\n  [\n    [254.9890486347282, 1.5, 188.40181034697815],\n    [248.52761744154438, 1.5, -519.7744116293145]\n  ],\n  [\n    [-1247.9079420458377, 1.5, 301.9431764689599],\n    [-383.5097210507664, 1.5, 264.71915732788005],\n    [-71.23512580197027, 1.5, 275.3629302523157],\n    [466.128250712296, 1.5, 275.2716282312793],\n    [741.6370632026585, 1.5, 277.66102510376084],\n    [1297.4737719762595, 1.5, 277.2168628506806],\n    [1541.7297005023304, 1.5, 280.31972525507285],\n    [2037.2405649559382, 1.5, 280.98678580599466],\n    [2246.595015753523, 1.5, 283.1011600230837],\n    [2617.1867659153927, 1.5, 278.8253659556488]\n  ],\n  [\n    [2611.3420640520076, 1.5, 163.96935494305524],\n    [2239.038081627408, 1.5, 174.12102368223074],\n    [2032.5550985659966, 1.5, 188.6090112066963],\n    [1532.405982209116, 1.5, 189.6348998853747],\n    [1298.330733919915, 1.5, 185.10779629834326],\n    [732.0840195081455, 1.5, 187.16481480781331],\n    [470.24205339525065, 1.5, 189.90699833376397],\n    [-84.06660102385868, 1.5, 192.15782227582906],\n    [-384.7643865790769, 1.5, 185.23744642336993],\n    [-1257.0964658502476, 1.5, 220.7083203147085]\n  ],\n  [\n    [-1494.2513045295325, 1.5, -523.9699855391409],\n    [-347.25187028816856, 1.5, -474.65671096988984],\n    [-15.027389984711675, 1.5, -487.5419186263196],\n    [460.1280047533312, 1.5, -554.9641189234129],\n    [769.3595908495539, 1.5, -610.2755139698855],\n    [1295.7126441671367, 1.5, -685.7478189381841],\n    [1514.966726681715, 1.5, -702.0163690628412],\n    [2028.26504557221, 1.5, -708.4714990968719],\n    [2229.5644216212645, 1.5, -702.2878946149901],\n    [2629.0123847430777, 1.5, -711.4343799242977]\n  ],\n  [\n    [2617.633985591895, 1.5, 201.60419658108776],\n    [2243.909428783476, 1.5, 206.87474446964558],\n    [2034.8776601667457, 1.5, 214.17713607035415],\n    [1533.6654999142486, 1.5, 216.16096497050023],\n    [1292.917491810635, 1.5, 211.694521877535],\n    [733.5212884806997, 1.5, 212.4150255097067],\n    [468.0441428401828, 1.5, 211.83554003650767],\n    [-81.88484692151263, 1.5, 215.50162318985943],\n    [-385.33313200911095, 1.5, 208.79517510379873],\n    [-1252.2402103549757, 1.5, 246.2595475811134]\n  ],\n  [\n    [-216.74411496965007, 1.5, 2446.1899911004953],\n    [-212.54025051280874, 1.5, 1618.4430966822365],\n    [-213.1531765155122, 1.5, 1299.5372821282467],\n    [-212.88029306826311, 1.5, 361.004463092096],\n    [-204.31776521867644, 1.5, 95.17239553880012],\n    [-175.35362468958635, 1.5, -361.2624545092945],\n    [-176.90039928865932, 1.5, -675.9746927279216],\n    [-169.7193594972355, 1.5, -1094.745742326411],\n    [-170.74265977198806, 1.5, -1381.291722860903],\n    [-143.83153846069854, 1.5, -2106.089132268412]\n  ],\n  [\n    [-166.69061346783928, 1.5, -2106.8143772513126],\n    [-198.0488246554272, 1.5, -1381.582043826204],\n    [-199.7107069657603, 1.5, -1095.6028221394768],\n    [-206.74060670641225, 1.5, -677.0697121202405],\n    [-202.700259003459, 1.5, -365.7406797551388],\n    [-230.01591899796063, 1.5, 91.60705400934745],\n    [-242.9062425497127, 1.5, 359.4021473586805],\n    [-242.27821018691782, 1.5, 1297.7164477844215],\n    [-242.66307406448757, 1.5, 1615.4387891061058],\n    [-243.2521320513111, 1.5, 2442.9364318668368]\n  ],\n  [\n    [-191.438779413371, 1.5, -2106.3282094666683],\n    [-220.73958879833555, 1.5, -1384.5763798106966],\n    [-227.4255891103798, 1.5, -1097.5557009252084],\n    [-232.3590701921136, 1.5, -676.5102411464416],\n    [-229.60449004853604, 1.5, -363.66500472487803],\n    [-254.03347391022893, 1.5, 88.02859900453808],\n    [-270.9119445790846, 1.5, 355.8050561117999],\n    [-271.8960506127454, 1.5, 1297.4563069322603],\n    [-269.32241688262354, 1.5, 1619.2232293653196],\n    [-269.6085197110389, 1.5, 2442.486822687859]\n  ],\n  [\n    [-1490.9279956818982, 1.5, -546.4210301147804],\n    [-347.46827976878035, 1.5, -499.19644259345415],\n    [-10.407826447936372, 1.5, -512.7596249145535],\n    [456.4211224463379, 1.5, -576.9125511231589],\n    [759.2761525703872, 1.5, -631.8081248108039],\n    [1293.0791107409004, 1.5, -705.0280213831614],\n    [1508.7704296505792, 1.5, -728.3802290028357],\n    [2032.6982432385287, 1.5, -731.5117672205906],\n    [2219.6072248811265, 1.5, -734.637580331011],\n    [2625.643276984354, 1.5, -743.8101299753371]\n  ],\n  [\n    [2626.3901700736037, 1.5, -781.1017696857378],\n    [2220.8514498299905, 1.5, -769.0356255284045],\n    [2032.2913703532724, 1.5, -762.8575496165022],\n    [1511.3552256541166, 1.5, -759.2404009381686],\n    [1286.7820276626376, 1.5, -730.1059576100947],\n    [756.3682832855267, 1.5, -652.7145464611291],\n    [452.61843137679864, 1.5, -606.8682449037161],\n    [-12.78416595913032, 1.5, -543.2368997160044],\n    [-343.08772274031026, 1.5, -527.962481270673],\n    [-1489.2130939698452, 1.5, -574.8731410713193]\n  ],\n  [\n    [2623.1011840628594, 1.5, -814.6475022807425],\n    [2216.036849549517, 1.5, -801.011576545054],\n    [2030.0825780786195, 1.5, -787.8840257205616],\n    [1506.3601369519993, 1.5, -784.4496008940721],\n    [1287.1959219288165, 1.5, -752.7952322380231],\n    [752.9829675686118, 1.5, -673.170208139215],\n    [445.89106268451593, 1.5, -631.647110579748],\n    [-19.911685547898884, 1.5, -566.4904449943363],\n    [-345.4294265338732, 1.5, -548.87622952709],\n    [-1491.0183116346152, 1.5, -596.5878109151417]\n  ],\n  [\n    [231.82903145902645, 1.5, 189.17638213146898],\n    [224.3313036580691, 1.5, -523.6629269807526]\n  ],\n  [\n    [199.34569678838128, 1.5, -519.3457911109576],\n    [206.1046050573263, 1.5, 188.7851087774285]\n  ],\n  [\n    [174.1270577790077, 1.5, -515.3193396429033],\n    [182.4833928328745, 1.5, 188.894326911243]\n  ],\n  [\n    [622.1583807823386, 1.5, 185.58693904691773],\n    [615.5669746892655, 1.5, -478.02316117666794],\n    [616.5459390204022, 1.5, -744.0007790209756],\n    [613.1324539553776, 1.5, -1181.9088663464408],\n    [611.6114090950623, 1.5, -1438.6207884389128],\n    [628.3415357586932, 1.5, -2153.3845865461985]\n  ],\n  [\n    [602.78350309092, 1.5, -2154.719743541784],\n    [583.8038920679553, 1.5, -1440.8315284661855],\n    [586.7498907865534, 1.5, -1180.8808974289223],\n    [586.8406384033154, 1.5, -747.7377094033409],\n    [586.8508956121347, 1.5, -484.2064033588732],\n    [593.0310370827052, 1.5, 185.91229223707006]\n  ],\n  [\n    [578.7234766214117, 1.5, -2156.363001113399],\n    [561.8484645719363, 1.5, -1438.6215071324666],\n    [560.7857436547948, 1.5, -1182.8499596656188],\n    [560.3517043728388, 1.5, -745.4949702873103],\n    [557.7773034922892, 1.5, -480.2852643380643],\n    [558.7645775584266, 1.5, 186.38583329069326]\n  ],\n  [\n    [-1484.025498440763, 1.5, 1589.088331309893],\n    [-393.96910868208226, 1.5, 1516.2559403282253],\n    [-74.7466791237108, 1.5, 1497.2077562666695],\n    [1256.1050380329816, 1.5, 1412.9053951256778],\n    [1545.7613661614432, 1.5, 1375.475445534589],\n    [2019.3052651779678, 1.5, 1347.0045562400246],\n    [2264.380569551577, 1.5, 1321.736985473143],\n    [2621.038902449388, 1.5, 1303.2632694976223]\n  ],\n  [\n    [2615.521068926143, 1.5, 1238.5780936003941],\n    [2258.3918670930802, 1.5, 1261.9895519289669],\n    [2015.9065155623832, 1.5, 1279.1369316700068],\n    [1543.5687412388943, 1.5, 1313.0857264496485],\n    [1255.9910752964493, 1.5, 1347.0259911383498],\n    [-74.73105195415519, 1.5, 1433.156851131467],\n    [-395.3144573092685, 1.5, 1450.856342285389],\n    [-1484.7746552134213, 1.5, 1518.2654466877468]\n  ],\n  [\n    [-1486.2521698460682, 1.5, 1553.8383362668728],\n    [-396.19750801269345, 1.5, 1482.7486065742262],\n    [-71.92088044886327, 1.5, 1464.5297925685127],\n    [1256.918068908873, 1.5, 1380.3764995293263],\n    [1545.485404268628, 1.5, 1347.0908211842523],\n    [2017.8608712283437, 1.5, 1312.5458999512684],\n    [2263.3526606706505, 1.5, 1291.6292619335034],\n    [2618.0900692681894, 1.5, 1271.7679045071297]\n  ],\n  [\n    [2609.2336753049603, 1.5, 1207.2326715997492],\n    [2258.0447448771533, 1.5, 1234.200060988093],\n    [2013.2433453232213, 1.5, 1246.4385924864744],\n    [1537.9497670856265, 1.5, 1285.6015154261588],\n    [1246.9671405964586, 1.5, 1319.4097956914059],\n    [-76.34105135541756, 1.5, 1400.1133691807436],\n    [-403.6761898257357, 1.5, 1426.2143591380525],\n    [-1488.8439414589297, 1.5, 1488.4834195052688]\n  ],\n  [\n    [-1489.9127119985296, 1.5, -1305.0787226341486],\n    [-354.29187759205456, 1.5, -1199.4424925727942],\n    [-17.325336635572626, 1.5, -1210.9973136817894],\n    [479.38519152284806, 1.5, -1253.4931898814023],\n    [712.7186683885026, 1.5, -1277.225823638084],\n    [1251.9705359784543, 1.5, -1323.1594271542313],\n    [1536.9075733445457, 1.5, -1342.4231138533764],\n    [2633.970640303025, 1.5, -1441.150769865169]\n  ],\n  [\n    [2626.7360744966045, 1.5, -1500.0907029322143],\n    [1536.1874247547, 1.5, -1393.944739235368],\n    [1249.9934542169772, 1.5, -1372.6442832591213],\n    [706.0316536599506, 1.5, -1323.3622498761565],\n    [475.75181205384024, 1.5, -1304.4244974268722],\n    [-23.831381496092263, 1.5, -1258.6965801793433],\n    [-345.81148653711205, 1.5, -1246.9140156460867],\n    [-1488.2813502899066, 1.5, -1360.6189050427602]\n  ],\n  [\n    [-1489.3330840643912, 1.5, -1333.3203188878533],\n    [-345.07038603482135, 1.5, -1224.0929300365299],\n    [-19.92873696625179, 1.5, -1232.701480252149],\n    [481.0928175641447, 1.5, -1277.4934279216766],\n    [713.0346817725144, 1.5, -1300.2035395183932],\n    [1253.4400925497391, 1.5, -1349.6955854297387],\n    [1531.382167354786, 1.5, -1367.9632989336503],\n    [2628.8682212127546, 1.5, -1472.9252382891727]\n  ],\n  [\n    [2628.36687079996, 1.5, -1531.557671018591],\n    [1531.4864401770299, 1.5, -1420.701301081861],\n    [1240.9120402885014, 1.5, -1394.9797637220593],\n    [704.2016429913713, 1.5, -1347.7184457859767],\n    [476.2658333877147, 1.5, -1322.90344068362],\n    [-26.623918325591035, 1.5, -1281.7971567634181],\n    [-345.49130989835896, 1.5, -1270.872303562496],\n    [-1485.277362327018, 1.5, -1387.7346376410196]\n  ],\n  [\n    [-46.1903895919887, 1.5, 59.136985945807055],\n    [-46.439397828073744, 369, 58.52252946350882]\n  ],\n  [\n    [68.25106554892753, 1.5, 51.86429774323446],\n    [63.7908538956505, 369, 57.045329175485975]\n  ],\n  [\n    [67.50324038296253, 1.5, -56.944390890241394],\n    [67.5025689086097, 369, -56.8684607939044]\n  ],\n  [\n    [-46.26753928126887, 1.5, -62.88156810249967],\n    [-46.26753928126887, 369, -62.88156810249967]\n  ]\n]\n","import * as THREE from 'three'\nimport * as TWEEN from 'three/examples/jsm/libs/tween.module.js'\nimport { RectAreaLightHelper } from 'three/examples/jsm/helpers/RectAreaLightHelper'\n\nimport * as ThreeScene from 'three-scene'\n\nimport DEFAULTCONFIG from './config'\n\nimport type { ExtendOptions } from '.'\nimport type { ObjectItem, ThreeModelItem, XYZ } from 'three-scene/types/model'\nimport { copy } from '@/common/utils/document'\n\nconst Hooks = ThreeScene.Hooks\nconst Utils = ThreeScene.Utils\nconst { raycaster, pointer, update: raycasterUpdate, style } = Hooks.useRaycaster()\nconst { initCSS2DRender, createCSS2DDom } = Hooks.useCSS2D()\nconst { createDiffusion, updateDiffusion } = Hooks.useDiffusion()\nconst { createMove, moveAnimate } = Hooks.useMoveAnimate()\nconst { createFence, fenceAnimate } = Hooks.useFence()\nconst { keyboardPressed, destroyEvent, insertEvent } = Hooks.useKeyboardState()\nconst { checkCollide } = Hooks.useCollide()\nconst { dubleHorizontal, dubleRotate, oddRotate } = Hooks.useOpenTheDoor()\nconst {\n  createRoam,\n  executeRoam,\n  pause: roamPause,\n  play: roamPlay,\n  getStatus: getRoamStatus\n} = Hooks.useRoam()\nconst { createFleeting, fleetingAnimate } = Hooks.useFleeting()\nconst { virtualization, closeVirtualization } = Hooks.useModelLoader({})\n\nconst base = import.meta.env.VITE_BEFORE_STATIC_PAT || ''\n\nconst sightMap = {\n  full: 'FULL',\n  npc: 'NPC'\n}\n\n// 创建视频元素\nconst createVideoDom = (src?: string) => {\n  const dom = document.createElement('video')\n  dom.src = base + (src || '/oss/textures/park/sintel.mp4')\n  dom.loop = true\n  // videoDom.autoplay = true\n  return dom\n}\n\n// 视频封面\nconst videoCoverTexture = new THREE.TextureLoader().load(base + '/oss/textures/office/cover.jpg')\n// 空调风纹理\nconst windTexture = new THREE.TextureLoader().load(base + '/oss/textures/office/wind.png')\n\nexport class OfficeThreeScene extends ThreeScene.Scene {\n  // 建筑集合\n  buildingGroup?: InstanceType<typeof THREE.Group>\n  // 锚点集合\n  anchorGroup?: InstanceType<typeof THREE.Group>\n  // 点位集合\n  dotGroup?: InstanceType<typeof THREE.Group>\n  // 灯光组\n  lightGroup?: InstanceType<typeof THREE.Group>\n  // 扩展参数\n  extend: Partial<ExtendOptions>\n  // CSS2D 渲染器\n  css2DRender: InstanceType<typeof Hooks.CSS2DRenderer>\n  // 鼠标点击地面扩散波效果\n  mouseClickDiffusion: InstanceType<typeof THREE.Mesh>\n  // 行走的人物\n  character?: InstanceType<typeof THREE.Group> & {\n    __runing__?: boolean\n  }\n  characterSightHeight = DEFAULTCONFIG.characterSightHeight\n\n  // 当前视角\n  currentSight: string\n  // 历史中心点（视角切换）\n  historyTarget: InstanceType<typeof THREE.Vector3>\n  // 历史相机坐标（视角切换）\n  historyCameraPosition: InstanceType<typeof THREE.Vector3>\n\n  // 动画模型集合\n  animateModels: ThreeModelItem[] = []\n\n  // 视频元素集合\n  videoModels: ThreeModelItem[] = []\n  // 画布纹理集合\n  canvasTextures: any[] = []\n\n  // 移动系数\n  moveFactor = DEFAULTCONFIG.moveFactor\n\n  // 碰撞间距\n  collisionSpace = DEFAULTCONFIG.collisionSpace\n\n  // 围栏\n  fence?: InstanceType<typeof THREE.Group>\n\n  // 环境光\n  ambientLight = new THREE.AmbientLight()\n  // 平行光\n  directionalLight = new THREE.DirectionalLight()\n\n  // 当前风格（白天/傍晚/夜间）\n  style = -1\n  styleTimes = DEFAULTCONFIG.styleTimes\n\n  // 流光\n  fleetingGroup?: InstanceType<typeof THREE.Group>\n\n  // 路灯\n  streetLampGroup?: InstanceType<typeof THREE.Group>\n\n  // 居民灯\n  residentLightGroup?: InstanceType<typeof THREE.Group>\n\n  constructor(\n    options: ConstructorParameters<typeof ThreeScene.Scene>[0],\n    extend: Partial<ExtendOptions>\n  ) {\n    super(options)\n\n    this.extend = extend\n    this.css2DRender = initCSS2DRender(this.options, this.container)\n    this.css2DRender.domElement.className = 'three-scene__dot-wrap'\n\n    // 鼠标点击地面扩散波效果\n    this.mouseClickDiffusion = createDiffusion(4, void 0, 6)\n    this.mouseClickDiffusion.rotation.x = -Math.PI * 0.5\n    this.mouseClickDiffusion.position.y = 0.5\n    this.mouseClickDiffusion.visible = false\n    this.addObject(this.mouseClickDiffusion)\n\n    this.createClock()\n    this.currentSight = sightMap.full\n    this.historyTarget = new THREE.Vector3()\n    this.historyCameraPosition = new THREE.Vector3()\n\n    this.findLight()\n    this.bindEvent()\n    this.addBuildingGroup()\n    this.addAnchorGroup()\n    this.addDotGroup()\n    this.addLightGroup()\n\n    // 流光\n    this.addFleeting()\n    // 路灯\n    this.addStreetLamp()\n    // 居民灯\n    this.addResidentLight()\n\n    console.log(this)\n  }\n\n  setEnv(texture) {\n    this.scene.environment = texture\n    this.scene.background = texture\n  }\n\n  findLight() {\n    const amb = this.scene.getObjectByProperty('isAmbientLight', true) as THREE.AmbientLight\n    this.ambientLight = amb\n    const dire = this.scene.getObjectByProperty(\n      'isDirectionalLight',\n      true\n    ) as THREE.DirectionalLight\n    this.directionalLight = dire\n  }\n\n  // 白天\n  toByday(style = 1) {\n    this.style = style\n    this.ambientLight.intensity = this.options.ambientLight.intensity\n    this.directionalLight.intensity = this.options.directionalLight.intensity\n    this.fleetingGroup && (this.fleetingGroup.visible = false)\n    this.streetLampGroup && (this.streetLampGroup.visible = false)\n    this.residentLightGroup && (this.residentLightGroup.visible = false)\n    const hdr = this.extend.sky?.day as string\n    this.loadEnvTexture(hdr)\n  }\n\n  // 傍晚\n  toEvening(style = 2) {\n    this.style = style\n    this.ambientLight.intensity = 0.01\n    this.directionalLight.intensity = 0.5\n    this.fleetingGroup && (this.fleetingGroup.visible = false)\n    this.streetLampGroup && (this.streetLampGroup.visible = false)\n    this.residentLightGroup && (this.residentLightGroup.visible = false)\n    const hdr = this.extend.sky?.evening as string\n    this.loadEnvTexture(hdr)\n  }\n\n  // 夜晚\n  toNight(style = 3) {\n    this.style = style\n    this.ambientLight.intensity = 0.01\n    this.directionalLight.intensity = 0\n    this.fleetingGroup && (this.fleetingGroup.visible = true)\n    this.streetLampGroup && (this.streetLampGroup.visible = true)\n    this.residentLightGroup && (this.residentLightGroup.visible = true)\n    const hdr = this.extend.sky?.night as string\n    this.loadEnvTexture(hdr)\n  }\n\n  // 自动切换场景风格\n  autoChangeStyle() {\n    const times = this.styleTimes\n    const hour = new Date().getHours()\n    const index = times.findIndex((ar, i) =>\n      i == times.length - 1 ? hour >= ar[0] || hour < ar[1] : hour >= ar[0] && hour < ar[1]\n    )\n    if (this.style != index + 1) {\n      if (index == 0) {\n        this.toByday()\n      } else if (index == 1) {\n        this.toEvening()\n      } else if (index == 2) {\n        this.toNight()\n      }\n    }\n  }\n\n  // 添加建筑组\n  addBuildingGroup() {\n    const group = new THREE.Group()\n    group.name = '建筑组'\n    this.buildingGroup = group\n    this.addObject(group)\n  }\n\n  // 清除场景建筑\n  clearBuilding() {\n    if (this.buildingGroup) {\n      this.disposeObj(this.buildingGroup)\n    }\n    this.animateModels = []\n    this.addBuildingGroup()\n    this.clearAnchor()\n    this.clearDot()\n  }\n\n  // 添加建筑\n  addBuilding(...obj) {\n    if (this.buildingGroup) {\n      this.buildingGroup.add(...obj)\n    }\n  }\n\n  // 添加锚点组\n  addAnchorGroup() {\n    const group = new THREE.Group()\n    group.name = '锚点组'\n    this.anchorGroup = group\n    this.addObject(group)\n  }\n\n  // 清除场景锚点\n  clearAnchor() {\n    if (this.anchorGroup) {\n      this.disposeObj(this.anchorGroup)\n    }\n    this.addAnchorGroup()\n  }\n\n  // 添加锚点\n  addAnchor(obj) {\n    if (this.anchorGroup) {\n      this.anchorGroup.add(obj)\n    }\n\n    const { x, y, z } = obj.position\n    // 创建精灵动画\n    Utils.createSpriteAnimate(obj, [x, y, z], 0.2, 8)\n  }\n\n  // 添加点位组\n  addDotGroup() {\n    const group = new THREE.Group()\n    group.name = '点位组'\n    this.dotGroup = group\n    this.scene.add(group)\n  }\n\n  // 清除场景点位\n  clearDot() {\n    if (this.dotGroup) {\n      this.disposeObj(this.dotGroup)\n    }\n    this.addDotGroup()\n  }\n\n  // 添加点位\n  addDot(item: ObjectItem, clickBack) {\n    const pos = item.position\n    const { size, color } = item.font || {}\n    const { x = 0, y = 0, z = 0 } = pos || {}\n    const label = createCSS2DDom({\n      name: `\n        <div class=\"bg\"></div>\n        <span class=\"inner\" style=\"${\n          size != void 0 ? `font-size: ${typeof size === 'string' ? size : size + 'px'};` : ''\n        } ${color != void 0 ? `color: ${color}` : ''}\"></span>\n      `,\n      className: 'dot-2D-label',\n      position: [x, y, z],\n      onClick: clickBack\n    })\n    label.name = item.name\n    label.data = item\n    // 原始点位 备用\n    label._position_ = { x, y, z }\n    this.dotGroup?.add(label)\n    return label\n  }\n\n  // 添加灯光组\n  addLightGroup() {\n    const group = new THREE.Group()\n    group.name = '灯光组'\n    this.lightGroup = group\n    this.addObject(group)\n  }\n\n  // 清除灯光组\n  clearLightGroup() {\n    if (this.lightGroup) {\n      this.disposeObj(this.lightGroup)\n    }\n    this.addLightGroup()\n  }\n\n  // 关闭所有灯光\n  closeLightGroup(isOpen: boolean = false) {\n    this.lightGroup?.children.forEach((el: any) => {\n      if (el.isSpotLight || el.isRectAreaLight) {\n        el.visible = isOpen\n      }\n    })\n  }\n\n  // 添加灯光\n  addLight(item: ObjectItem, obj, hasHelper?: boolean) {\n    if (this.lightGroup) {\n      obj.name = item.name\n      const pos = item.position || { x: 0, y: 0, z: 0 }\n      const { to = { x: pos.x, y: pos.y - 2, z: pos.z } } = item\n      if (!obj.isRectAreaLight) {\n        obj.target.position.set(to.x, to.y, to.z)\n        this.lightGroup.add(obj.target)\n      }\n      // 开灯\n      obj.visible = true\n      this.lightGroup.add(obj)\n      if (hasHelper) {\n        if (obj.isRectAreaLight) {\n          const rectLightHelper = new RectAreaLightHelper(obj)\n          this.lightGroup.add(rectLightHelper)\n        } else {\n          const helper = new THREE.SpotLightHelper(obj, obj.color)\n          this.lightGroup.add(helper)\n        }\n      }\n    }\n  }\n\n  // 添加流光\n  addFleeting() {\n    const group = new THREE.Group()\n    const list = DEFAULTCONFIG.fleetings\n    for (let i = 0; i < list.length; i++) {\n      const points = list[i]\n      const line = createFleeting({\n        // textureUrl: this.options.baseUrl + '/oss/textures/office/arc.png',\n        points,\n        // color: 0x0053ff,\n        color: '#' + (Math.random() + '000000').substring(2, 8),\n        intensity: 10,\n        tubularSegments: 1000,\n        radius: 0.6,\n        repeat: {\n          x: 2,\n          y: 4\n        }\n      })\n      group.add(line)\n    }\n    group.name = '流光组'\n    this.fleetingGroup = group\n    this.addObject(group)\n  }\n\n  // 流光状态切换\n  toggleFleeting(isOpen?: boolean) {\n    this.fleetingGroup && (this.fleetingGroup.visible = isOpen ?? !this.fleetingGroup.visible)\n  }\n\n  // 添加路灯\n  addStreetLamp() {\n    const group = new THREE.Group()\n    const list = DEFAULTCONFIG.streetLamps\n    const spotLight = new THREE.SpotLight(0xffffff, 10, 100, Math.PI * 0.6, 0.6, 0.4)\n    for (let i = 0; i < list.length; i++) {\n      const light = spotLight.clone()\n      const [x, y, z] = list[i]\n      light.position.set(x, y, z)\n      light.target.position.set(x, y - 1, z)\n      light.add(spotLight.target)\n      group.add(light)\n      // 辅助不加，灯光不圆\n      const helper = new THREE.SpotLightHelper(light)\n      helper.visible = false\n      group.add(helper)\n    }\n    group.name = '路灯组'\n    group.visible = false\n    this.addObject(group)\n    this.streetLampGroup = group\n  }\n\n  // 添加居民灯\n  addResidentLight() {\n    const group = new THREE.Group()\n    const list = DEFAULTCONFIG.residentLights\n    const pointLight = new THREE.PointLight(0xffffff, 10, 100, 0.4)\n    for (let i = 0; i < list.length; i++) {\n      const light = pointLight.clone()\n      const [x, y, z] = list[i]\n      light.position.set(x, y, z)\n      group.add(light)\n      // const helper = new THREE.PointLightHelper(light)\n      // group.add(helper)\n    }\n    group.name = '居民灯'\n    group.visible = false\n    this.addObject(group)\n    this.residentLightGroup = group\n  }\n\n  // 绘制 canva 材质\n  drawCanvas(text = '') {\n    if (!this.extend.canvas) return\n    const canvas = this.extend.canvas\n    const w = canvas.offsetWidth\n    const h = canvas.offsetHeight\n    canvas.width = w\n    canvas.height = h\n\n    const ctx = canvas.getContext('2d')\n    if (!ctx) return\n    ctx.clearRect(0, 0, w, h)\n    ctx.fillStyle = '#f00'\n\n    // 分割为两行\n    const rows = 2,\n      max = 12,\n      len = text.length\n    const rlen = len > max ? Math.ceil(len / rows) : max\n    let list: string[] = [],\n      index = 0\n    while (index < len) {\n      const end = index + rlen\n      list.push(text.substring(index, end))\n      index = end\n    }\n\n    ctx.font = '100 40px 微软雅黑'\n    ctx.textAlign = 'center'\n    ctx.textBaseline = 'middle'\n    const tl = list.length\n\n    list.forEach((tx, index) => {\n      const i = index * tl + 1\n      ctx.fillText(tx, w / 2, (h / tl / 2) * i)\n    })\n\n    if (!this.canvasTextures.length) return\n    this.canvasTextures.forEach(map => {\n      map.needsUpdate = true\n    })\n  }\n\n  // 添加人物\n  addCharacter(model, point) {\n    const { x, y, z } = point\n    model.position.set(x, y, z)\n\n    this.character = model\n\n    // 动画\n    const animations = model.animations\n    const mixer = new THREE.AnimationMixer(model)\n    const actions = {}\n\n    for (let i = 0; i < animations.length; i++) {\n      const clip = animations[i]\n      const action = mixer.clipAction(clip)\n      actions[clip.name] = action\n    }\n\n    // 舞蹈\n    const dance = actions['Dance']\n    dance.play()\n\n    // 步行\n    const runging = actions['Walking']\n\n    model.extra = {\n      mixer,\n      actions,\n      runging\n    }\n    this.addObject(model)\n\n    const keys = ['W', 'S'].map(key => key.toUpperCase().charCodeAt(0))\n\n    // 插入事件 播放/暂停 动作\n    insertEvent(\n      e => {\n        if (model.__runing__) return\n        if (keys.includes(e.keyCode)) {\n          runging.play()\n        }\n        if (this.isCharacterSight()) {\n          if (keyboardPressed('X')) {\n            this.characterAccelerate(1)\n          }\n          if (keyboardPressed('Z')) {\n            this.characterAccelerate(-1)\n          }\n        }\n      },\n      e => {\n        if (model.__runing__) return\n        if (keys.includes(e.keyCode)) {\n          runging.stop()\n        }\n      }\n    )\n  }\n\n  // 视角切换（人物/全屏）\n  // 1-第一人称 3-第三人称\n  toggleSight(type?: number) {\n    if (this.judgeCruise()) return\n\n    // 漫游\n    this.judgeAndStopRoam()\n\n    const sight = this.currentSight == sightMap.full ? sightMap.npc : sightMap.full\n    this.currentSight = sight\n\n    // 人物视角\n    const isCharacter = sight === sightMap.npc\n    if (!this.controls) return\n\n    // 控制器操作限制切换\n    this.controls.maxDistance = isCharacter ? (type == 3 ? 10 : 0) : 800\n    this.controls.screenSpacePanning = !isCharacter\n    this.controls.enablePan = !isCharacter\n    // this.controls.maxPolarAngle = Math.PI * (isCharacter ? 0.8 : 0.48)\n\n    if (!this.character) return\n    const position = this.character.position\n\n    this.toggleCharacterView()\n\n    // 向量\n    const up = new THREE.Vector3(0, this.characterSightHeight, 0)\n    /// 切换到人物视角，暂存控制参数\n    if (isCharacter) {\n      ElMessage.success({\n        message: '鼠标点击地面移动，或键盘 W、S 前后移动，A、D调整左右方向，X 加速，Z 减速!',\n        grouping: true\n      })\n      this.historyTarget = this.controls.target.clone()\n      this.historyCameraPosition = this.camera.position.clone()\n      const pos = position.clone().add(up)\n\n      this.camera.lookAt(pos)\n      // 相机高度距离人物大于 8\n      if (Math.abs(this.camera.position.y - pos.y) > 8) {\n        this.camera.position.y = pos.y\n      }\n    } else {\n      this.camera.position.copy(this.historyCameraPosition)\n      this.camera.lookAt(position)\n    }\n\n    const vect = isCharacter ? position : this.historyTarget\n    const pos = vect.clone().add(up)\n    this.controls.target.copy(pos)\n  }\n\n  // 是否人物视角\n  isCharacterSight() {\n    return this.currentSight == sightMap.npc\n  }\n\n  // 清除人物视角状态\n  clearCharacterSight() {\n    this.currentSight = sightMap.full\n    this.toggleCharacterView()\n  }\n\n  // 切换人物界面效果\n  toggleCharacterView() {\n    const dom = this.container.parentNode?.querySelector('.character-sight') as HTMLDivElement\n    if (!dom) return\n    const isCharacter = this.currentSight === sightMap.npc\n    dom.style.display = isCharacter ? 'block' : 'none'\n  }\n\n  // 人物加速\n  characterAccelerate(speed = 1) {\n    this.moveFactor += speed\n    if (this.moveFactor >= 10) this.moveFactor = 10\n    else if (this.moveFactor <= 1) this.moveFactor = 1\n    ElMessage.success({\n      message: '人物速度：' + this.moveFactor,\n      grouping: true\n    })\n  }\n\n  // 设置控制中心点\n  setControlTarget(point) {\n    if (!this.controls) return\n    this.controls.target.copy(point.clone().add(new THREE.Vector3(0, this.characterSightHeight, 0)))\n    this.camera.lookAt(this.controls.target)\n  }\n\n  //  等电梯\n  waitLift(object, fllow?: boolean) {\n    // 电梯组\n    const liftName = object.data.target\n    // 电梯轿厢\n    const box = this.scene.getObjectByName(liftName) as any\n    if (!box) {\n      ElMessage.error({\n        message: `【${liftName}】模块未找到！`,\n        grouping: true\n      })\n    }\n    console.log(box, liftName)\n\n    // 当前绑定坐标\n    const cpos = object.data?.to\n    if (!box || !cpos) return\n    // y 轴对比\n    const bpos = box.position\n\n    // 判断间距\n    if (Math.abs(cpos.y - bpos.y) > 0.2) {\n      // 电梯关门\n      const bindLift = box.__bind_lift__\n      if (bindLift !== void 0) {\n        // 绑定过则关闭电梯门\n        this.dubleHorizontalDoor(\n          {\n            data: { bind: bindLift }\n          },\n          2.3,\n          false\n        )\n      }\n      this.dubleHorizontalDoor(\n        {\n          data: { bind: liftName }\n        },\n        2.3,\n        false\n      ).then(() => {\n        const duration = 1000 * 5\n        ElMessage.success({\n          message: `${liftName}移动中，请稍候，${duration / 1000}秒后到达!`,\n          duration: duration\n        })\n\n        // 电梯移动\n        new TWEEN.Tween(bpos)\n          .to(\n            {\n              y: cpos.y\n            },\n            duration\n          )\n          .delay(0)\n          .start()\n          .onUpdate(pos => {\n            // 人物跟随\n            if (fllow) {\n              if (!this.character) return\n              this.character.position.y = pos.y\n              this.camera.position.y = pos.y\n              this.setControlTarget(this.character.position)\n            }\n          })\n          .onComplete(() => {\n            console.log('电梯到了！', box)\n            // 当前移动到哪一层，后续滑动时需要关闭之前到达的层\n            box.__bind_lift__ = object.data.bind\n            // 电梯开门\n            this.openLift(object, liftName)\n          })\n      })\n    } else {\n      this.openLift(object, liftName)\n    }\n  }\n\n  // 电梯开门\n  openLift(object, liftName) {\n    // 电梯门打开\n    this.dubleHorizontalDoor(object, 2.3)\n    this.dubleHorizontalDoor(\n      {\n        data: { bind: liftName }\n      },\n      2.3\n    )\n  }\n\n  // 开关灯\n  lightSwitch(object, isOpen?: boolean, max?: number) {\n    const light = this.lightGroup?.getObjectsByProperty('name', object.data?.bind)\n    if (!light) return\n    console.log('控制灯数量:', max != void 0 && max >= 0 ? max : '全部')\n    light.forEach((el, index) => {\n      // max 存在则默认未点亮，其他关闭\n      let visible = max != void 0 && max >= 0 ? false : isOpen != void 0 ? isOpen : !el.visible\n      if (max != void 0 && max >= 0 && index < max) {\n        visible = isOpen != void 0 ? isOpen : true\n      }\n      el.visible = visible\n    })\n  }\n\n  // 双开门(两扇门 往两边平移)\n  dubleHorizontalDoor(object, scale = 400, isOpen?: boolean) {\n    const { bind, axle = 'z' } = object.data\n\n    return dubleHorizontal(this.scene, {\n      value: bind,\n      axle,\n      scale,\n      isOpen\n    })\n  }\n\n  // 单旋转开门\n  oddRotateDoor(object) {\n    const { bind, axle = 'y', internal, autoClose = false } = object.data\n\n    return oddRotate(this.scene, {\n      value: bind,\n      axle,\n      angle: Math.PI * (internal ? -0.5 : 0.5),\n      autoClose\n    })\n  }\n\n  // 双旋转开门\n  dubleRotateDoor(object) {\n    const { bind, axle = 'y', left = '右', right = '左', internal, autoClose = true } = object.data\n\n    return dubleRotate(this.scene, {\n      value: bind,\n      axle,\n      autoClose,\n      angle: Math.PI * (internal ? -0.5 : 0.5),\n      leftMatch: left,\n      rightMatch: right\n    })\n  }\n\n  // 闸机\n  openGate(object) {\n    return this.dubleRotateDoor(object)\n  }\n\n  // 窗帘动画\n  toggleCurtain(object, isClose?) {\n    const dobj = this.animateModels.find(el => el.name === object.data?.bind)\n    console.log(dobj)\n    if (!dobj) return\n\n    dobj.__close__ = isClose ?? !dobj.__close__\n\n    const { __action__, __mixer__ } = dobj\n    Object.keys(__action__).forEach(key => {\n      if (dobj.__close__) {\n        __action__[key].loop = THREE.LoopOnce\n        __action__[key].clampWhenFinished = true\n        __action__[key].play()\n      }\n    })\n    if (!dobj.__close__) {\n      __mixer__.stopAllAction()\n    }\n    return dobj.__close__\n  }\n\n  // 视频材质\n  addVideoMaterial(names: string[]) {\n    const material = new THREE.MeshPhongMaterial({\n      map: videoCoverTexture\n      // side: THREE.DoubleSide\n    })\n\n    this.videoModels = []\n    for (let i = 0; i < names.length; i++) {\n      const name = names[i]\n      const dbObj = this.buildingGroup?.getObjectByName(name) as any\n      if (!dbObj) continue\n\n      // 灯光\n      const light = this.lightGroup?.getObjectByName(name + '-照明灯')\n      if (light) {\n        light.visible = true\n      }\n\n      const videoDom2 = createVideoDom()\n      const videoTexture2 = new THREE.VideoTexture(videoDom2)\n      dbObj.__video_texture__ = videoTexture2\n      dbObj.__cover_texture__ = videoCoverTexture.clone()\n      dbObj.material = material.clone()\n      dbObj.__video__ = videoDom2\n      this.videoModels.push(dbObj)\n    }\n  }\n\n  // 画布纹理\n  addCanvasMaterial(names: string[]) {\n    if (!this.extend.canvas) return\n    const material = new THREE.MeshPhongMaterial({\n      map: new THREE.CanvasTexture(this.extend.canvas),\n      side: THREE.DoubleSide\n    })\n    this.canvasTextures = []\n    for (let i = 0; i < names.length; i++) {\n      const dbObj = this.scene.getObjectByName(names[i]) as any\n      if (!dbObj) continue\n      dbObj.material = material.clone()\n      dbObj.__cover_texture__ = material.map?.clone()\n      this.canvasTextures.push(dbObj.material.map)\n    }\n  }\n\n  // 清理视频\n  clearVideo() {\n    const videos = this.videoModels\n    for (let i = 0; i < videos.length; i++) {\n      const obj = videos[i]\n      const { __video__, __cover_texture__, __video_texture__ } = obj\n      if (__video__) {\n        __video__.pause()\n        __video__.remove()\n        __cover_texture__?.dispose()\n        __video_texture__?.dispose()\n      }\n    }\n  }\n\n  // 视频播放\n  videoPlay(object) {\n    const vobj = this.scene.getObjectByName(object.data.bind) as any\n    if (vobj && vobj.__video__) {\n      const __video__ = vobj.__video__\n      if (__video__.paused) {\n        vobj.material.map = vobj.__video_texture__\n        __video__?.play()\n      } else {\n        __video__?.pause()\n        vobj.material.map = vobj.__cover_texture__\n      }\n    }\n  }\n\n  // 添加空调风材质\n  addAirWindMaterial(names: string[]) {\n    windTexture.wrapS = THREE.RepeatWrapping\n    windTexture.repeat.x = 1\n    const material = new THREE.MeshPhongMaterial({\n      color: 0xc6deff,\n      map: windTexture,\n      // opacity: 0.9,\n      transparent: true,\n      side: THREE.DoubleSide,\n      emissive: 0x76b6ff, // 自发光颜色\n      emissiveIntensity: 1 // 自发光强度，范围从0到无穷大\n    })\n\n    for (let i = 0; i < names.length; i++) {\n      const dobj = this.scene.getObjectByName(names[i]) as any\n      if (!dobj) return\n      dobj.traverse(el => {\n        if (el.isMesh) {\n          el.material = material\n        }\n      })\n      dobj.visible = false\n    }\n  }\n\n  // 空调开关\n  toggleAir(object, isOpen?) {\n    const dobj = this.scene.getObjectByName(object.data.bind) as any\n    console.log(dobj)\n    if (!dobj) return\n    dobj.__open__ = isOpen ?? !dobj.__open__\n    dobj.visible = dobj.__open__\n  }\n\n  // 鼠标点击地面\n  mouseClickGround(intersct, filterName: string[]) {\n    if (this.currentSight !== sightMap.npc) return Promise.reject()\n\n    const character = this.character as any\n    if (!character) return Promise.reject()\n    const { runing } = this.options.cruise\n    // 自动巡航中不操作\n    if (runing) return Promise.reject()\n    const lookAt = intersct.point\n    const obj = this.mouseClickDiffusion\n\n    const { runging } = character.extra\n    runging.play()\n\n    obj.position.copy(lookAt)\n    obj.visible = true\n\n    character.__runing__ = true\n    return new Promise(resolve => {\n      // 创建移动\n      createMove(\n        character,\n        lookAt,\n        (pos, stop) => {\n          this.setControlTarget(pos)\n          if (\n            this.checkCharacterCollide(pos, filterName.includes(intersct.object.name) ? 2 : 0.3)\n          ) {\n            stop()\n            runging.stop()\n            character.__runing__ = false\n            obj.visible = false\n          }\n        },\n        pos => {\n          this.setControlTarget(pos)\n          runging.stop()\n          character.__runing__ = false\n          obj.visible = false\n          resolve(character)\n        }\n      )\n    })\n  }\n\n  // 检测人物碰撞\n  checkCharacterCollide(pos, y = 0.3) {\n    if (!this.character) return\n    // 检测碰撞\n    const intersects = checkCollide(\n      this.character,\n      pos,\n      this.buildingGroup?.children || [],\n      true,\n      new THREE.Vector3(0, y, 0)\n    )\n    if (intersects.length) {\n      const intersect = intersects[0]\n\n      // 于目标距离\n      if (intersect.distance < this.collisionSpace) {\n        ElMessage.warning({\n          message: '撞到了！',\n          grouping: true\n        })\n        return true\n      }\n    }\n  }\n\n  // 相机移动聚焦点\n  cameraLookatMoveTo(pos) {\n    if (!this.controls) return\n    Utils.cameraLookatAnimate(this.camera as any, pos, this.controls.target)\n  }\n\n  // 判断是否巡航中\n  judgeCruise() {\n    if (this.options.cruise.runing) {\n      ElMessage.warning({\n        message: '请退出巡航！',\n        grouping: true\n      })\n      return true\n    }\n    return false\n  }\n\n  // 添加模型动画\n  addModelAnimate(model, animations = [], play: boolean = true, timeScale: number = 1) {\n    if (!animations.length) return\n    const mixer = new THREE.AnimationMixer(model)\n    const obj = animations.reduce((ob, cur: any) => {\n      const key = cur.name || ''\n      ob[key] = mixer.clipAction(cur)\n      if (play) {\n        ob[key].play()\n      }\n      ob[key].timeScale = timeScale\n      return ob\n    }, {})\n\n    model.__action__ = obj\n    model.__mixer__ = mixer\n    this.animateModels.push(model)\n  }\n\n  // 相机转场\n  cameraTransition(object) {\n    if (this.judgeCruise()) return\n\n    if (this.mouseClickDiffusion.visible) {\n      ElMessage.warning({\n        message: '人物移动中，不可操作！',\n        grouping: true\n      })\n      return\n    }\n\n    this.clearCharacterSight()\n\n    const { to, target = object.position } = object.data\n\n    if (!to) return\n\n    if (!this.isCameraMove(to) && this.controls) {\n      this.judgeAndStopRoam()\n      this.controls.enablePan = true\n      this.controls.maxDistance = 5\n      Utils.cameraLinkageControlsAnimate(this.controls, this.camera, to, target)\n    }\n\n    const { bind } = object.data\n    if (!bind) {\n      return\n    }\n\n    const obj = this.buildingGroup?.getObjectByName(bind)\n    this.addFence(obj)\n  }\n\n  // 公司鸟瞰图\n  toggleBridCompany() {\n    if (this.judgeCruise()) return\n    this.clearCharacterSight()\n    this.judgeAndStopRoam()\n\n    const name = DEFAULTCONFIG.companyModelName\n    const model = this.buildingGroup?.getObjectByName(name) as ThreeModelItem\n    console.log(model)\n    if (!model) {\n      ElMessage.warning({\n        message: `未找到【${name}】模块！`,\n        grouping: true\n      })\n      return\n    }\n\n    // 设置聚焦\n    model.__isFocus__ = !model.__isFocus__\n\n    if (!model.__isFocus__) {\n      this.closeVirtualization()\n      this.toggleCompanyFocus(false)\n      return\n    }\n    this.toggleCompanyFocus(true)\n    virtualization(this.buildingGroup?.children || [], model, {\n      wireframe: !false,\n      hidden: true,\n      opacity: 0.1,\n      filter: ['电梯-1']\n    })\n  }\n  // 关闭虚化\n  closeVirtualization() {\n    const name = DEFAULTCONFIG.companyModelName\n    const model = this.buildingGroup?.getObjectByName(name) as ThreeModelItem\n    model.__isFocus__ = false\n    closeVirtualization(this.buildingGroup?.children, {\n      filter: ['_空调风_grp']\n    })\n  }\n\n  // 公司聚焦\n  toggleCompanyFocus(isFocus) {\n    if (!this.controls) return\n    let target = this.historyTarget\n    let to = this.historyCameraPosition as XYZ\n\n    // 聚焦移动 暂存场景参数\n    if (isFocus) {\n      this.historyTarget = new THREE.Vector3().copy(this.controls.target)\n      this.historyCameraPosition = new THREE.Vector3().copy(this.camera.position)\n\n      target = new THREE.Vector3(0, 185, 0)\n      to = { x: 0, y: 340, z: 0 }\n    }\n\n    const dis = target.distanceTo(to)\n    this.controls.maxDistance = dis\n\n    Utils.cameraLinkageControlsAnimate(this.controls, this.camera, to, target)\n  }\n\n  // 添加围栏\n  addFence(model?) {\n    // 先删除\n    if (this.fence) {\n      this.disposeObj(this.fence)\n      this.fence = void 0\n    }\n\n    if (model) {\n      // 围栏\n      const fence = createFence(model, 0x52ffae)\n      this.fence = fence\n      this.addObject(fence)\n    }\n  }\n\n  // 控制重置\n  controlReset() {\n    this.judgeAndStopRoam()\n    this.clearCharacterSight()\n    this.closeVirtualization()\n    if (!this.controls) return\n    this.controls.enablePan = true\n    this.controls.maxDistance = 1500\n    this.controls.maxPolarAngle = Math.PI * 0.48\n    super.controlReset()\n  }\n\n  // 判断漫游，并停止\n  judgeAndStopRoam() {\n    if (getRoamStatus()) {\n      if (this.controls) {\n        this.controls.maxDistance = 1500\n      }\n      roamPause()\n      return true\n    }\n    return false\n  }\n\n  // 设置漫游点位\n  setRoamPoint(points) {\n    this.extend.roamPoints = points\n  }\n\n  // 漫游\n  toggleRoam() {\n    this.clearCharacterSight()\n    if (this.judgeAndStopRoam()) return\n    const points = this.extend.roamPoints || []\n    if (points.length == 0) return\n    if (!this.controls) return\n    this.controls.maxDistance = 5\n    createRoam({\n      points,\n      segment: 6,\n      tension: 0,\n      speed: 2,\n      close: false,\n      factor: 1\n    })\n    roamPlay()\n  }\n\n  // 模型动画\n  modelAnimate(): void {\n    // css2D 渲染器\n    this.css2DRender.render(this.scene, this.camera)\n\n    if (typeof this.extend.animateCall === 'function') this.extend.animateCall()\n\n    this.restoreAnchorMaterial()\n\n    let delta = this.clock?.getDelta() as number\n    // 模型动画\n    if (this.animateModels.length) {\n      this.animateModels.forEach((el: any) => {\n        if (el.__mixer__) {\n          el.__mixer__.update(delta)\n        }\n      })\n    }\n\n    this.anchorGroup?.children.forEach((el: any) => {\n      if (el.__mixer__) {\n        el.__mixer__.update(delta)\n      }\n    })\n\n    if (this.character) {\n      const mixer = (this.character as any).extra.mixer\n      mixer.update(delta)\n\n      moveAnimate(0.2 * this.moveFactor)\n    }\n\n    // 波纹扩散\n    if (this.mouseClickDiffusion.visible) {\n      updateDiffusion()\n    }\n\n    // 围栏动画\n    fenceAnimate()\n\n    // 人物视角\n    if (this.isCharacterSight() && !this.character?.__runing__) {\n      const factor = 1 + this.moveFactor / 5\n      // 移动速度\n      const steep = 5 * delta * factor\n      // 旋转速度\n      const angle = Math.PI * 0.2 * delta * factor\n      const target = this.character\n      if (!target) return\n      const isS = keyboardPressed('S')\n      if (keyboardPressed('W') || isS) {\n        // 向量\n        const dir = new THREE.Vector3()\n        // 获取的视线方向\n        target?.getWorldDirection(dir)\n        // dis向量表示相机沿着相机视线方向平移的位移量\n        const dis = dir.clone().multiplyScalar(isS ? -steep : steep)\n        // 初始位置+偏移向量\n        const newPos = target?.position.clone().add(dis) || new THREE.Vector3()\n        if (this.checkCharacterCollide(newPos)) {\n        } else {\n          target?.position.copy(newPos)\n          if (isS) {\n            // 定位后一步\n            const ds = dir.clone().multiplyScalar(-steep * 2)\n            this.camera.position.copy(this.camera.position.clone().add(ds))\n          }\n          this.setControlTarget(target?.position)\n        }\n      }\n\n      if (keyboardPressed('A')) {\n        target.rotation.y += angle\n        this.keyboardToTotation()\n      } else if (keyboardPressed('D')) {\n        target.rotation.y -= angle\n        this.keyboardToTotation()\n      }\n    }\n\n    // 执行漫游\n    executeRoam(this.camera, this.controls)\n\n    // 空调风材质\n    if (windTexture) {\n      windTexture.offset.x += 0.02\n    }\n\n    // 自动切换风格\n    this.autoChangeStyle()\n\n    // 流光动画\n    if (this.fleetingGroup?.visible) {\n      fleetingAnimate()\n    }\n  }\n\n  // 按键转向\n  keyboardToTotation() {\n    const target = this.character\n    // 向量\n    const dir = new THREE.Vector3()\n    // 目标视线方向坐标\n    target?.getWorldDirection(dir)\n    const mds = this.controls?.maxDistance || 1\n    const dis = dir.clone().multiplyScalar(-mds)\n    const newPos =\n      target?.position.clone().setY(this.camera.position.y).add(dis) || new THREE.Vector3()\n    this.camera.position.copy(newPos)\n    this.setControlTarget(target?.position)\n  }\n\n  // 移动\n  onPointerMove(e: PointerEvent) {\n    this.checkIntersectObjects(e)\n  }\n\n  // 弹起\n  onPointerUp(e: PointerEvent) {\n    super.onPointerUp(e)\n\n    let s = e.timeStamp - this.pointer.tsp\n    // 判断是否未点击\n    const isClick = s < DEFAULTCONFIG.clickIntervalTime\n    if (e.button == 2) {\n      // console.log('你点了右键')\n      if (isClick && typeof this.extend?.onClickRight === 'function') this.extend.onClickRight(e)\n    } else if (e.button == 0) {\n      // console.log('你点了左键')\n      isClick && this.checkIntersectObjects(e)\n    } else if (e.button == 1) {\n      // console.log('你点了滚轮')\n    }\n  }\n\n  // 检查交叉几何体\n  checkIntersectObjects(e: PointerEvent) {\n    const dom = this.container\n    const scale = this.options.scale\n    raycasterUpdate(e, dom, scale)\n    let isClick = e.type == 'pointerdown' || e.type == 'pointerup'\n    // 锚点或者地面\n    const objects =\n      this.buildingGroup?.children\n        .filter((it: any) => isClick && it.visible)\n        .map(it => {\n          it.children = it.children.filter(t => t.visible)\n          return it\n        })\n        .concat(this.anchorGroup?.children || []) || []\n\n    // 设置新的原点和方向向量更新射线, 用照相机的原点和点击的点构成一条直线\n    raycaster.setFromCamera(pointer, this.camera)\n    let interscts = raycaster.intersectObjects(objects, isClick /* 是否检查所有后代 */)\n\n    // dom.style.cursor = !isClick && interscts.length > 0 ? 'pointer' : 'auto'\n    if (!isClick) {\n      // 处理锚点类型-精灵材质\n      this.hoverAnchor(interscts)\n      return\n    }\n    dom.style.cursor = 'auto'\n\n    if (interscts.length) {\n      const intersct = interscts[0]\n      const object = intersct.object\n      console.log(intersct)\n      const { x, z } = intersct.point\n      copy(`[ ${x}, 1.5, ${z} ],\n        `)\n\n      // 是否点击地面\n      const isClickGround =\n        typeof object.name == 'string' &&\n        (this.extend.groundMeshName || []).some(t => object.name.indexOf(t) > -1)\n\n      const obj = this.findParentGroup(object)\n      if (isClickGround) {\n        if (typeof this.extend?.onClickGround === 'function')\n          this.extend.onClickGround(obj, intersct)\n      }\n\n      if (!obj) return\n      if (typeof this.extend?.onClickLeft === 'function') this.extend.onClickLeft(obj, intersct)\n    } else {\n      if (typeof this.extend?.onClickLeft === 'function') this.extend.onClickLeft()\n    }\n  }\n\n  // 悬浮锚点\n  hoverAnchor(interscts) {\n    if (typeof this.extend.onHoverAnchor === 'function')\n      this.extend.onHoverAnchor(interscts[0], style)\n\n    if (interscts.length) {\n      const intersct = interscts[0]\n      const object = intersct.object\n      this.container.style.cursor = object._isAnchor_ ? 'pointer' : 'auto'\n      if (!object._isAnchor_) return\n\n      const mat = object.material\n      if (object.__mat_color__ === void 0) {\n        object.__mat_color__ = mat.color\n      }\n      mat.color = new THREE.Color(0xff0ff0)\n      this.anchorGroup?.children.forEach((el: any) => {\n        el.__change_color__ = el.uuid === object.uuid\n      })\n    } else {\n      this.container.style.cursor = 'auto'\n      this.anchorGroup?.children.forEach((el: any) => {\n        el.__change_color__ = false\n      })\n    }\n  }\n\n  // 恢复锚点材质\n  restoreAnchorMaterial() {\n    this.anchorGroup?.traverse((el: any) => {\n      if (el.isSprite) {\n        if (!el.__change_color__ && el.__mat_color__) {\n          el.material.color = el.__mat_color__\n        }\n      }\n    })\n  }\n\n  // 查找父级组合\n  findParentGroup(object) {\n    const _find = obj => {\n      if (obj._isBuilding_) return obj\n      let parent = obj.parent\n      if (!parent) {\n        return\n      }\n      if (parent && parent._isBuilding_) {\n        return parent\n      }\n      return _find(parent)\n    }\n    return _find(object)\n  }\n\n  // 获取所有对象\n  getAll() {\n    return this.buildingGroup?.children.concat(this.dotGroup?.children || []) || []\n  }\n\n  resize() {\n    super.resize()\n    const { width, height } = this.options\n    this.css2DRender.setSize(width, height)\n  }\n\n  dispose() {\n    destroyEvent()\n    this.animateModels = []\n    this.clearVideo()\n    this.videoModels = []\n    this.canvasTextures = []\n    this.disposeObj(this.buildingGroup)\n    this.disposeObj(this.character)\n    this.disposeObj(this.dotGroup)\n    this.disposeObj(this.anchorGroup)\n    this.disposeObj(this.fence)\n    this.disposeObj(this.lightGroup)\n    this.disposeObj(this.mouseClickDiffusion)\n    this.disposeObj(this.fleetingGroup)\n    this.disposeObj(this.streetLampGroup)\n    this.disposeObj(this.residentLightGroup)\n\n    this.clock = void 0\n    // @ts-ignore\n    this.css2DRender = void 0\n    this.buildingGroup = void 0\n    this.character = void 0\n    this.dotGroup = void 0\n    this.anchorGroup = void 0\n    this.lightGroup = void 0\n    this.fence = void 0\n    // @ts-ignore\n    this.mouseClickDiffusion = void 0\n    this.fleetingGroup = void 0\n    this.streetLampGroup = void 0\n    this.residentLightGroup = void 0\n    this.extend = {}\n    super.dispose()\n  }\n}\n\n// 点位更新回调\nexport const dotUpdateObjectCall = (obj: ObjectItem, _group) => {\n  // const val = wsStore.getKeyValue( code ).value\n  const val = Math.random() * 40\n  if (val !== void 0) {\n    obj.value = val\n  }\n\n  obj.show = Math.random() > 0.5\n  obj.value = Number(Number(obj.value || 0).toFixed(2))\n  return {\n    value: obj.value,\n    show: obj.show,\n    font: {\n      ...(obj.font || {}),\n      color: '#' + (0xffffff + val * 1000000).toString(16).substring(0, 6)\n    }\n  }\n}\n\n// 偏移坐标\nexport const getOffsetPoint = (pos, offset = 0) => {\n  return new THREE.Vector3(pos.x, pos.y + offset, pos.z)\n}\n","<template>\n  <div :class=\"$style.page\">\n    <!-- 操作按钮 -->\n    <div class=\"scene-operation\">\n      <div class=\"btn\" @click=\"() => updateObject()\">随机更新</div>\n      <div class=\"btn\" @click=\"() => Emitter.emit('SCENE:POS')\">场景坐标</div>\n\n      <div class=\"item\" @click=\"() => Emitter.emit('CAMERA:ROAM')\">全景漫游</div>\n      <div class=\"item\" v-for=\"item in cameraPositionList\" @click=\"onCameraTransition(item)\">\n        {{ item.name }}\n      </div>\n\n      <div class=\"item\" @click=\"() => Emitter.emit('CAMERA:CRUISE')\">定点巡航</div>\n      <div class=\"item\" @click=\"() => Emitter.emit('CAMERA:RESET')\">视角重置</div>\n\n      <div class=\"item\" @click=\"() => Emitter.emit('AIR:MAIN')\">空调开关</div>\n\n      <div class=\"item\" @click=\"() => Emitter.emit('LIGHT:CLG')\">灯组开关</div>\n      <div class=\"item\" @click=\"() => Emitter.emit('LIGHT:FIRSTFLOOR')\">一楼开关</div>\n\n      <div class=\"item\" @click=\"() => Emitter.emit('CURTAIN:TOGGLE')\">窗帘开关</div>\n      <div class=\"item\" @click=\"() => Emitter.emit('EFFECT:FLEETING')\">流光开关</div>\n\n      <div class=\"item\" @click=\"() => Emitter.emit('SKY:DAY')\">白天</div>\n      <div class=\"item\" @click=\"() => Emitter.emit('SKY:EVENING')\">傍晚</div>\n      <div class=\"item\" @click=\"() => Emitter.emit('SKY:NIGHT')\">夜间</div>\n\n      <div\n        class=\"item\"\n        @click=\"() => Emitter.emit('LIGHT:LCR', null, Math.floor(Math.random() * 5))\"\n      >\n        大会议室灯\n      </div>\n      <div class=\"item\" @click=\"() => Emitter.emit('CAMERA:FIRST')\">第一人称</div>\n      <div class=\"item\" @click=\"() => Emitter.emit('CAMERA:THREE')\">第三人称</div>\n      <div class=\"item\" @click=\"() => Emitter.emit('PERSON:ADD')\">人物加速</div>\n      <div class=\"item\" @click=\"() => Emitter.emit('PERSON:SUB')\">人物减速</div>\n\n      <div class=\"item\" @click=\"() => Emitter.emit('BIRD:COMPANY')\">鸟瞰</div>\n    </div>\n\n    <div :class=\"$style.container\" ref=\"containerRef\"></div>\n\n    <canvas :class=\"$style['canvas-texture']\" ref=\"canvasTextureRef\"></canvas>\n\n    <t-first-person />\n\n    <t-loading v-model=\"progress.show\" :progress=\"progress.percentage\"></t-loading>\n\n    <!-- 楼层选择 -->\n    <div :class=\"$style['floor-select']\" v-show=\"floorOpts.show\">\n      <el-button\n        v-for=\"item in floorItems\"\n        type=\"primary\"\n        :disabled=\"floorOpts.active === item.key\"\n        @click=\"onFloorMoveTo(item)\"\n        >{{ item.name }}</el-button\n      >\n    </div>\n\n    <div\n      :class=\"$style.tip\"\n      v-if=\"tipOpts.show\"\n      :style=\"{\n        left: tipOpts.style.left + 'px',\n        top: tipOpts.style.top + 'px'\n      }\"\n    >\n      <div :class=\"$style.msg\" v-html=\"tipOpts.msg\"></div>\n    </div>\n\n    <t-dialog\n      v-model=\"dialog.show\"\n      :title=\"dialog.title\"\n      v-model:content=\"dialog.content\"\n      :err-message=\"dialog.errMessage\"\n      @confirm=\"onConfirm\"\n    ></t-dialog>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport tDialog from './edit-dialog.vue'\nimport tLoading from '@/components/loading/index.vue'\nimport tFirstPerson from './first-person.vue'\n\nimport {\n  ROBOT,\n  CURTAIN,\n  CHARACTER,\n  ANCHOR_POS,\n  CRUISE_POINT_UP,\n  WAIT_LIFT,\n  LIGHT_SWITCH,\n  LIGHT_MAIN_SWITCH,\n  AIR_SWITCH,\n  GATE_SWITCH,\n  DOUBLE_HORIZONTAL_SWITCH,\n  DOUBLE_ROTATE_SWITCH,\n  ODD_ROTATE_SWITCH,\n  CURTAIN_SWITCH,\n  VIDEO_SWITCH,\n  SCREEN_EDIT,\n  MODE_SWITCH,\n  getPageOpts,\n  getTipOpts,\n  getFloorOpts\n} from './data'\nimport Emitter from './emitter'\nimport { OfficeThreeScene, dotUpdateObjectCall, getOffsetPoint } from './methods'\nimport { onListen } from './listen'\nimport * as request from './request'\n\nimport { useResize } from '@/hooks/scene-resize'\nimport { useDialog } from '@/hooks/dialog'\nimport * as ThreeScene from 'three-scene'\n\nimport type { ObjectItem, ThreeModelItem } from 'three-scene/types/model'\nimport { ElInput, ElMessageBox } from 'element-plus'\nimport { getStorage, setStorage } from '@/common/utils/storage'\n\nconst Utils = ThreeScene.Utils\nconst Hooks = ThreeScene.Hooks\n\nconst pageOpts = reactive(\n  getPageOpts((pos, lookAt, cruiseCurve, t) => {\n    if (!robotObj) return\n    // 前置视角前 0.02\n    t = t + 0.02\n    if (t > 1) t = t - 1\n    pos = getOffsetPoint(cruiseCurve.getPointAt(t))\n    const oft = 0.001\n    let ts = t + oft\n    if (ts > 1) ts = ts - 1\n    lookAt = cruiseCurve.getPointAt(ts)\n\n    robotObj.position.set(pos.x, CRUISE_POINT_UP, pos.z)\n    // 求正切值\n    const angle = Math.atan2(-lookAt.z + pos.z, lookAt.x - pos.x)\n    robotObj.rotation.z = Math.PI * 0.5 + angle\n  })\n)\nconst floorOpts = reactive(getFloorOpts())\nconst tipOpts = reactive(getTipOpts())\nconst { progress, loadModels, getModel } = Hooks.useModelLoader({\n  baseUrl: pageOpts.baseUrl,\n  indexDB: {\n    cache: true,\n    dbName: 'THREE__OFFICE__DB',\n    tbName: 'TB',\n    version: 73\n  }\n})\n\nconst containerRef = ref()\nconst canvasTextureRef = ref()\nconst options: ConstructorParameters<typeof OfficeThreeScene>[0] = {\n  // env: pageOpts.env,\n  cruise: pageOpts.cruise,\n  controls: {\n    visible: !false,\n    enableDamping: true,\n    dampingFactor: 0.25,\n    maxPolarAngle: Math.PI * 0.48,\n    // enablePan: false,\n    screenSpacePanning: false,\n    maxDistance: 1500\n  },\n  camera: {\n    near: 3,\n    fov: 45\n  },\n  directionalLight: {\n    intensity: 4,\n    light2: false\n  },\n  ambientLight: {\n    intensity: 0.01\n  },\n  axes: {\n    visible: true,\n    size: 1000\n  }\n}\nlet scene: InstanceType<typeof OfficeThreeScene>\n\n// 电梯到达楼层\nconst floorItems = computed(() => {\n  return floorOpts.list.find(it => it.target === floorOpts.targetName)?.items || []\n})\n\n// 大屏欢迎词弹窗\nconst welcomKey = 'welcom.key'\nconst { options: dialog } = useDialog({\n  title: '编辑欢迎词',\n  content: getStorage(welcomKey) || '中碳能源',\n  errMessage: '请输入欢迎词！'\n})\n\n// 楼层移动至\nconst onFloorMoveTo = item => {\n  floorOpts.active = item.key\n  const liftName = item.bind\n\n  scene.waitLift(\n    {\n      data: {\n        bind: liftName,\n        to: {\n          y: item.y\n        },\n        target: floorOpts.targetName\n      }\n    },\n    true\n  )\n}\n\n// 相机转场\nconst onCameraTransition = item => {\n  scene.cameraTransition({\n    position: item.position,\n    data: item\n  })\n}\n\n// 更新点位隐现\nconst updateDotVisible = (target: ThreeModelItem) => {\n  const item = target.data as ObjectItem\n  if (typeof dotUpdateObjectCall === 'function') {\n    const res = dotUpdateObjectCall(item, scene.buildingGroup)\n    if (typeof res === 'object') {\n      Object.keys(res).forEach(key => {\n        item[key] = res[key]\n      })\n    }\n  } else {\n    console.warn(new Error('未传人点位更新对象回调方法 dotUpdateObjectCall'))\n  }\n\n  target.visible = item.show || !pageOpts.dotShowStrict\n  const dom = target.element?.getElementsByClassName('inner')[0] as HTMLElement\n  if (dom) {\n    const { size, color } = item.font || {}\n    if (size != void 0) {\n      dom.style.fontSize = typeof size === 'string' ? size : size + 'px'\n    }\n    if (color != void 0) {\n      dom.style.color = color\n    }\n    dom.textContent = `${item.value || 0}${item.unit}`\n  }\n}\n\n// 创建 dot 点位\nconst createDotObject = item => {\n  updateDotVisible(\n    scene.addDot(item, _e => {\n      scene.cameraLookatMoveTo(item.position)\n    })\n  )\n}\n\n// 更新\nconst updateObject = () => {\n  scene.getAll().forEach((el: any, _i) => {\n    if (!el.data) return\n\n    const data = el.data\n    // 数据参数\n    let type = data.type\n\n    // 点位\n    if (type === pageOpts.dotKey) {\n      updateDotVisible(el)\n      return\n    }\n  })\n}\n\n// 初始化设备列表\nconst initDevices = () => {\n  let i = 0,\n    len = modelConfigList.value.length\n  return new Promise(resolve => {\n    if (len == 0) return resolve(null)\n    const _loop = async () => {\n      const item = modelConfigList.value[i]\n      await loopLoadObject(item)\n      i++\n      if (i < len) {\n        _loop()\n      } else {\n        resolve(i)\n      }\n    }\n    _loop()\n  })\n}\n\n// 循环加载对象\nconst loopLoadObject = async (item: ObjectItem) => {\n  if (!item) return\n  const { type } = item\n  if (type === ANCHOR_POS) return\n  const obj = getModel(type)\n  if (!obj) {\n    // 点位\n    if (type === pageOpts.dotKey) {\n      createDotObject(item)\n    }\n    return\n  }\n\n  const { anchorType = [], animationModelType = [] } = pageOpts\n\n  // 深克隆\n  let model = Utils.modelDeepClone(obj)\n  const { position: POS, scale: SCA, rotation: ROT } = Utils.get_P_S_R_param(model, item)\n  const [x, y, z] = POS\n\n  // 缩放\n  model.scale.set(...SCA)\n\n  // 摆放位置\n  model.position.set(x, y, z)\n  // 转换方位\n  model.rotation.set(...ROT)\n\n  model._isBuilding_ = true\n  model.data = item\n\n  // 动画\n  if (animationModelType.includes(type)) {\n    scene.addModelAnimate(model, obj.animations, type !== CURTAIN, 1)\n  }\n\n  // 锚点\n  if (anchorType.includes(type)) {\n    model._isAnchor_ = true\n\n    scene.addAnchor(model)\n  }\n\n  // 聚光灯 / 面光灯\n  else if (model.isSpotLight || model.isRectAreaLight) {\n    scene.addLight(item, model, false)\n  } else {\n    scene.addBuilding(model)\n  }\n\n  return Promise.resolve()\n}\n\n// 组装\nconst assemblyScenario = () => {\n  return new Promise(async resolve => {\n    // 加载进度 100\n    progress.percentage = 100\n    progress.show = false\n\n    // 清除\n    scene.clearBuilding()\n\n    await nextTick()\n    await initDevices()\n\n    // 漫游\n    scene.setRoamPoint(pageOpts.roamPoints)\n\n    // 巡航\n    scene.setCruisePoint(pageOpts.cruise.points)\n\n    const to = scene.getValidTargetPosition(pageOpts.config || {})\n\n    // 入场动画\n    // @ts-ignore\n    Utils.cameraInSceneAnimate(scene.camera, to, scene.controls.target).then(() => {\n      scene.controlSave()\n      setTimeout(() => {\n        Emitter.emit('LIGHT:CLOSE')\n        resolve(1)\n      }, 1000 * 3)\n    })\n  })\n}\n\n// 加载\nconst modelConfigList = ref<ObjectItem[]>([])\n// 定位点位列表\nconst cameraPositionList = computed(() =>\n  modelConfigList.value.filter(it => it.type === ANCHOR_POS)\n)\n\nconst load = () => {\n  loadModels(pageOpts.models, () => {\n    request\n      .getConfig()\n      .then(res => {\n        return request.getModes().then(list => {\n          list.forEach((item, index) => {\n            res.JsonList.push({\n              ...item,\n              type: MODE_SWITCH,\n              position: { x: 19 - index * 0.6, y: 186.8, z: 49 }\n            })\n          })\n          return res\n        })\n      })\n      .then(async res => {\n        let json: any = {}\n        if (res.ConfigJson instanceof Object) {\n          json = res.ConfigJson\n        } else if (typeof res.ConfigJson == 'string') {\n          try {\n            json = JSON.parse(res.ConfigJson)\n          } catch (er) {}\n        }\n        modelConfigList.value = res.JsonList\n        Object.keys(json).forEach(key => {\n          pageOpts.config && (pageOpts.config[key] = json[key])\n        })\n        pageOpts.cruise.points = json.cruise || []\n        pageOpts.roamPoints = json.roamPoints || []\n        await assemblyScenario()\n        createRoblt()\n        createCharacter()\n        // 绘制画布纹理\n        Emitter.emit('SCREEN:WELCOM', dialog.content)\n        scene.addVideoMaterial(\n          res.JsonList.filter(it => it.type === VIDEO_SWITCH).map(it => it.bind)\n        )\n        scene.addCanvasMaterial(\n          res.JsonList.filter(it => it.type === SCREEN_EDIT).map(it => it.bind)\n        )\n        scene.addAirWindMaterial(\n          res.JsonList.filter(it => it.type === AIR_SWITCH).map(it => it.bind)\n        )\n      })\n  })\n}\n\n// 创建机器人\nlet robotObj: any\nconst createRoblt = () => {\n  robotObj = getModel(ROBOT)\n  robotObj.position.z = CRUISE_POINT_UP\n  robotObj.rotation.z = Math.PI * 0.5\n  scene.addObject(robotObj)\n}\n\n// 创建人物\nconst createCharacter = () => {\n  const obj = getModel(CHARACTER)\n  obj.traverse(el => {\n    if (el.isMesh) {\n      el.castShadow = true\n    }\n  })\n  const move = {\n    x: 14.4,\n    y: 184.6,\n    z: 37.6\n  }\n  obj.scale.setScalar(0.75)\n\n  // 手臂问题，暂隐藏\n  const l = obj.getObjectByName('HandL')\n  const r = obj.getObjectByName('HandR')\n  l.visible = false\n  r.visible = false\n  scene.addCharacter(obj, move)\n}\n\nconst initPage = () => {\n  load()\n\n  onListen(scene)\n}\n\nconst onDialogInput = () => {\n  dialog.show = true\n  return\n  ElMessageBox({\n    title: '编辑欢迎词',\n    message: () => {\n      return h(ElInput, {\n        type: 'textarea',\n        rows: 5,\n        style: {\n          width: '100%'\n        },\n        placeholder: '请输入欢迎词',\n        maxlength: 24,\n        showWordLimit: true,\n        modelValue: dialog.title,\n        'onUpdate:modelValue': v => {\n          dialog.title = v\n        }\n      })\n    },\n    customClass: 'screen-welcom-dialog',\n    beforeClose: (action, _instance, done) => {\n      if (action === 'confirm') {\n        if (!dialog.title) {\n          ElMessage.warning({\n            message: '请输入欢迎词！',\n            grouping: true\n          })\n          return\n        }\n      }\n      done()\n    }\n  }).then(action => {\n    if (action == 'confirm') {\n      setStorage(welcomKey, dialog.title || '')\n      Emitter.emit('SCREEN:WELCOM', dialog.title)\n    }\n  })\n}\n\nconst onConfirm = text => {\n  dialog.content = text\n  setStorage(welcomKey, dialog.content || '')\n  Emitter.emit('SCREEN:WELCOM', dialog.content)\n}\n\nconst onClickLeft = object => {\n  const data = object.data\n  switch (data?.type) {\n    case ANCHOR_POS: // 定位\n      scene.cameraTransition(object)\n      break\n    case WAIT_LIFT: // 等电梯\n      floorOpts.targetName = object.data.target\n      scene.waitLift(object)\n      break\n    case LIGHT_SWITCH: // 开关灯\n      Emitter.emit('LIGHT:AUTO', object)\n      break\n    case LIGHT_MAIN_SWITCH: // 灯总开关\n      object.__close__ = !object.__close__\n      Emitter.emit('LIGHT:CLOSE', !object.__close__)\n      break\n    case GATE_SWITCH: // 闸机\n      scene.openGate(object)\n      break\n    case DOUBLE_HORIZONTAL_SWITCH: // 双开横推门\n      scene.dubleHorizontalDoor(object, 5.4)\n      break\n    case ODD_ROTATE_SWITCH: // 单旋转开门\n      scene.oddRotateDoor(object)\n      break\n    case DOUBLE_ROTATE_SWITCH: // 双旋转开门\n      scene.dubleRotateDoor(object)\n      break\n    case CURTAIN_SWITCH: // 窗帘动画\n      Emitter.emit('CURTAIN:TOGGLE')\n      break\n    case VIDEO_SWITCH: // 视频播放\n      scene.videoPlay(object)\n      break\n    case SCREEN_EDIT: // 大屏欢迎词编辑\n      onDialogInput()\n      break\n    case AIR_SWITCH: // 空调\n      Emitter.emit('AIR:ODD', object)\n      break\n    case MODE_SWITCH: // 模式\n      console.log(toRaw(object.data))\n      break\n  }\n}\n\nonMounted(() => {\n  options.container = containerRef.value\n  const liftMeshNames = ['电梯地板002', '电梯地板']\n  scene = new OfficeThreeScene(options, {\n    canvas: canvasTextureRef.value,\n    groundMeshName: [\n      '地面002',\n      '立方体306',\n      '平面118',\n      '立方体475',\n      '立方体514',\n      '立方体552',\n      '地面020',\n      '地面',\n      '平面391',\n\n      '立方体474',\n      '立方体1617',\n      'ground',\n      ...liftMeshNames\n    ],\n    roamPoints: pageOpts.roamPoints,\n    sky: pageOpts.sky,\n    onClickLeft: (object, _intersct) => {\n      if (object && object.data) {\n        onClickLeft(object)\n      }\n    },\n    onClickGround: (_object, intersct) => {\n      scene\n        .mouseClickGround(intersct, liftMeshNames)\n        .then(_obj => {\n          floorOpts.show = liftMeshNames.includes(intersct.object.name)\n        })\n        .catch(() => {})\n    },\n    onHoverAnchor: (object, style) => {\n      const isShow = !!object && object.object._isAnchor_\n      tipOpts.show = isShow\n\n      if (isShow) {\n        tipOpts.style.top = style.top\n        tipOpts.style.left = style.left\n        const data = object.object.data\n        tipOpts.msg = `\n          <p>${data.name}</p>\n          <p>类型：${data.type}</p>\n          <p>绑定：${data.bind || '无'}</p>\n        `\n      }\n    }\n  })\n\n  scene.run()\n  useResize(scene).resize()\n\n  initPage()\n})\n</script>\n\n<style lang=\"scss\" module>\n@import './style.scss';\n</style>\n","import { Axios, Api } from '@/config'\n\nexport const getConfig = () => {\n  return Axios.get(Api.d3.office)\n}\n\n// 模式\nexport const getModes = () => {\n  return Axios.get(Api.d3.office_mode)\n}\n","import { OfficeThreeScene } from './methods'\nimport Emitter from './emitter'\n\nexport const onListen = (scene: InstanceType<typeof OfficeThreeScene>) => {\n  // 漫游\n  Emitter.on('CAMERA:ROAM', () => scene?.toggleRoam())\n  // 巡航\n  Emitter.on('CAMERA:CRUISE', () => scene?.toggleCruise())\n  // 重置视角\n  Emitter.on('CAMERA:RESET', () => scene?.controlReset())\n  // 第一人称\n  Emitter.on('CAMERA:FIRST', () => scene?.toggleSight(1))\n  // 第三人称\n  Emitter.on('CAMERA:THREE', () => scene?.toggleSight(3))\n\n  // 大门\n  Emitter.on('CAMERA:GATE', () => {\n    const object = {\n      data: {\n        name: '一楼大门',\n        type: 'ANCHOR_POS',\n        to: { x: -1.3, y: 6.2, z: 102.3 },\n        target: { x: -1.4, y: 5.8, z: 97.4 }\n      }\n    }\n    scene?.cameraTransition(object)\n  })\n  // 前台\n  Emitter.on('CAMERA:RECCEPTION', () => {\n    const object = {\n      data: {\n        name: '公司前台',\n        type: 'ANCHOR_POS',\n        to: { x: 15.3, y: 188, z: 33.2 },\n        target: { x: 15.3, y: 188, z: 36.3 }\n      }\n    }\n    scene?.cameraTransition(object)\n  })\n  // 办公区域\n  Emitter.on('CAMERA:OFFICE', () => {\n    const object = {\n      data: {\n        name: '办公区域',\n        type: 'ANCHOR_POS',\n        to: { x: -38, y: 188, z: 35.3 },\n        target: { x: -35.4, y: 188, z: 36.4 }\n      }\n    }\n    scene?.cameraTransition(object)\n  })\n  // 大会议室\n  Emitter.on('CAMERA:LCR', () => {\n    const object = {\n      data: {\n        name: '大会议室',\n        type: 'ANCHOR_POS',\n        to: { x: -28.8, y: 188, z: 52.7 },\n        target: { x: -33.7, y: 188, z: 53.4 }\n      }\n    }\n    scene?.cameraTransition(object)\n  })\n  // 老板办公室\n  Emitter.on('CAMERA:BOSS', () => {\n    const object = {\n      data: {\n        name: '领导办公',\n        type: 'ANCHOR_POS',\n        to: { x: 69.4, y: 188, z: -0.4 },\n        target: { x: 65, y: 188, z: -2.7 }\n      }\n    }\n    scene?.cameraTransition(object)\n  })\n\n  // 人物加速\n  Emitter.on('PERSON:ADD', () => scene?.characterAccelerate())\n  // 减速\n  Emitter.on('PERSON:SUB', () => scene?.characterAccelerate(-1))\n\n  // 前台灯\n  Emitter.on('LIGHT:RECCEPTION', (isOpen, max) => {\n    scene?.lightSwitch({ data: { bind: '前台聚光灯' } }, isOpen, max)\n  })\n  // 过道灯\n  Emitter.on('LIGHT:AILSE', (isOpen, max) => {\n    scene?.lightSwitch({ data: { bind: '区域A' } }, isOpen, max)\n  })\n  // 人事灯\n  Emitter.on('LIGHT:PM', (isOpen, max) => {\n    scene?.lightSwitch({ data: { bind: '区域B' } }, isOpen, max)\n  })\n  // 主机灯\n  Emitter.on('LIGHT:HOST', (isOpen, max) => {\n    scene?.lightSwitch({ data: { bind: '主机照明灯' } }, isOpen, max)\n  })\n  // 大会议室灯\n  Emitter.on('LIGHT:LCR', (isOpen, max) => {\n    scene?.lightSwitch({ data: { bind: '大会议室照明灯' } }, isOpen, max)\n  })\n  // 公司主灯光组\n  Emitter.on('LIGHT:CLG', isOpen => {\n    scene?.lightSwitch({ data: { bind: '公司主灯光组' } }, isOpen)\n  })\n  // 一楼灯光组\n  Emitter.on('LIGHT:FIRSTFLOOR', isOpen => {\n    scene?.lightSwitch({ data: { bind: '一楼灯光组' } }, isOpen)\n  })\n\n  // 关灯\n  Emitter.on('LIGHT:CLOSE', (isOpen?) => scene?.closeLightGroup(isOpen))\n  Emitter.on('LIGHT:AUTO', (object, isOpen, max) => scene?.lightSwitch(object, isOpen, max))\n\n  // 窗帘\n  Emitter.on('CURTAIN:TOGGLE', (isClose?) => {\n    const status = scene?.toggleCurtain({ data: { bind: '_GROUP_013_grp' } }, isClose)\n    console.log('窗帘关闭状态', status)\n  })\n\n  // 公司大门\n  Emitter.on('DOOR:COMPANY', () => {\n    scene?.dubleHorizontalDoor({ data: { bind: '_公司大门_grp', axle: 'x' } }, 5.4)\n  })\n  // 大会议室门\n  Emitter.on('DOOR:LCR', () => {\n    scene?.dubleRotateDoor({ data: { bind: '_大会议室-门_grp', axle: 'y' } })\n  })\n  // 老板办公室\n  Emitter.on('DOOR:BOSS', () => {\n    scene?.dubleRotateDoor({ data: { bind: '_老板办公室-门_grp', autoClose: 0 } })\n  })\n\n  // 公司大屏\n  Emitter.on('SCREEN:COMPANY', () => {\n    scene?.videoPlay({ data: { bind: '公司大屏' } })\n  })\n  // 欢迎词\n  Emitter.on('SCREEN:WELCOM', text => scene?.drawCanvas(text))\n  // 小会议室大屏\n  Emitter.on('SCREEN:SCR', () => {\n    scene?.videoPlay({ data: { bind: '小会议室大屏' } })\n  })\n  // 大会议电视屏幕\n  Emitter.on('SCREEN:LCR', () => {\n    scene?.videoPlay({ data: { bind: '大会议电视屏幕' } })\n  })\n\n  // 空调\n  Emitter.on('AIR:MAIN', (isOpen?) => {\n    scene?.toggleAir({ data: { bind: '_空调风_grp' } }, isOpen)\n  })\n  Emitter.on('AIR:ODD', (object, isOpen?) => {\n    scene?.toggleAir(object, isOpen)\n  })\n\n  // 场景坐标\n  Emitter.on('SCENE:POS', () => scene?.getPosition())\n\n  // 白天\n  Emitter.on('SKY:DAY', () => scene?.toByday(scene.style))\n  // 傍晚\n  Emitter.on('SKY:EVENING', () => scene?.toEvening(scene.style))\n  // 夜晚\n  Emitter.on('SKY:NIGHT', () => scene?.toNight(scene.style))\n\n  // 流光\n  Emitter.on('EFFECT:FLEETING', (isOpen?) => scene?.toggleFleeting(isOpen))\n\n  // 公司鸟瞰视角\n  Emitter.on('BIRD:COMPANY', () => scene?.toggleBridCompany())\n}\n"],"names":["props","__props","visible","_useModel","content","emits","__emit","onConfirm","trim","value","ElMessage","warning","message","errMessage","grouping","items","code","desc","ANCHOR_POS","ANCHOR_TARGET","MAIN_SCENE","CONPANT_FLOOR","CURTAIN","ROBOT","CHARACTER","WAIT_LIFT","LIGHT_SWITCH","LIGHT_MAIN_SWITCH","AIR_SWITCH","GATE_SWITCH","DOUBLE_HORIZONTAL_SWITCH","DOUBLE_ROTATE_SWITCH","ODD_ROTATE_SWITCH","VIDEO_SWITCH","SCREEN_EDIT","CURTAIN_SWITCH","MODE_SWITCH","eventNames","Emitter","constructor","__publicField","this","reduce","obj","key","Set","on","eventName","listtener","listteners","forEach","it","toString","delete","add","emit","args","DEFAULTCONFIG","Hooks","ThreeScene.Hooks","Utils","ThreeScene.Utils","raycaster","pointer","update","raycasterUpdate","style","useRaycaster","initCSS2DRender","createCSS2DDom","useCSS2D","createDiffusion","updateDiffusion","useDiffusion","createMove","moveAnimate","useMoveAnimate","createFence","fenceAnimate","useFence","keyboardPressed","destroyEvent","insertEvent","useKeyboardState","checkCollide","useCollide","dubleHorizontal","dubleRotate","oddRotate","useOpenTheDoor","createRoam","executeRoam","pause","roamPause","play","roamPlay","getStatus","getRoamStatus","useRoam","createFleeting","fleetingAnimate","useFleeting","virtualization","closeVirtualization","useModelLoader","base","VITE_BEFORE_STATIC_PAT","sightMap","createVideoDom","src","dom","document","createElement","loop","videoCoverTexture","THREE.TextureLoader","load","windTexture","OfficeThreeScene","ThreeScene.Scene","options","extend","super","THREE.AmbientLight","THREE.DirectionalLight","css2DRender","container","domElement","className","mouseClickDiffusion","rotation","x","Math","PI","position","y","addObject","createClock","currentSight","historyTarget","THREE.Vector3","historyCameraPosition","findLight","bindEvent","addBuildingGroup","addAnchorGroup","addDotGroup","addLightGroup","addFleeting","addStreetLamp","addResidentLight","console","log","setEnv","texture","scene","environment","background","amb","getObjectByProperty","ambientLight","dire","directionalLight","toByday","intensity","fleetingGroup","streetLampGroup","residentLightGroup","hdr","_a","sky","day","loadEnvTexture","toEvening","evening","toNight","night","autoChangeStyle","times","styleTimes","hour","Date","getHours","index","findIndex","ar","i","length","group","THREE.Group","name","buildingGroup","clearBuilding","disposeObj","animateModels","clearAnchor","clearDot","addBuilding","anchorGroup","addAnchor","z","createSpriteAnimate","dotGroup","addDot","item","clickBack","pos","size","color","font","label","onClick","data","_position_","lightGroup","clearLightGroup","closeLightGroup","isOpen","children","el","isSpotLight","isRectAreaLight","addLight","hasHelper","to","target","set","rectLightHelper","RectAreaLightHelper","helper","THREE.SpotLightHelper","list","points","line","random","substring","tubularSegments","radius","repeat","toggleFleeting","spotLight","THREE.SpotLight","light","clone","pointLight","THREE.PointLight","drawCanvas","text","canvas","w","offsetWidth","h","offsetHeight","width","height","ctx","getContext","clearRect","fillStyle","len","rlen","ceil","end","push","textAlign","textBaseline","tl","tx","fillText","canvasTextures","map","needsUpdate","addCharacter","model","point","character","animations","mixer","THREE.AnimationMixer","actions","clip","action","clipAction","runging","extra","keys","toUpperCase","charCodeAt","e","__runing__","includes","keyCode","isCharacterSight","characterAccelerate","stop","toggleSight","type","judgeCruise","judgeAndStopRoam","sight","isCharacter","controls","maxDistance","screenSpacePanning","enablePan","toggleCharacterView","up","characterSightHeight","success","camera","lookAt","abs","copy","clearCharacterSight","parentNode","querySelector","display","speed","moveFactor","setControlTarget","waitLift","object","fllow","liftName","box","getObjectByName","error","cpos","bpos","bindLift","__bind_lift__","dubleHorizontalDoor","bind","then","duration","TWEEN.Tween","delay","start","onUpdate","onComplete","openLift","lightSwitch","max","_b","getObjectsByProperty","scale","axle","oddRotateDoor","internal","autoClose","angle","dubleRotateDoor","left","right","leftMatch","rightMatch","openGate","toggleCurtain","isClose","dobj","find","__close__","__action__","__mixer__","Object","THREE.LoopOnce","clampWhenFinished","stopAllAction","addVideoMaterial","names","material","THREE.MeshPhongMaterial","videoModels","dbObj","videoDom2","videoTexture2","THREE.VideoTexture","__video_texture__","__cover_texture__","__video__","addCanvasMaterial","THREE.CanvasTexture","side","THREE.DoubleSide","clearVideo","videos","remove","dispose","videoPlay","vobj","paused","addAirWindMaterial","wrapS","THREE.RepeatWrapping","transparent","emissive","emissiveIntensity","traverse","isMesh","toggleAir","__open__","mouseClickGround","intersct","filterName","Promise","reject","runing","cruise","resolve","checkCharacterCollide","intersects","distance","collisionSpace","cameraLookatMoveTo","cameraLookatAnimate","addModelAnimate","timeScale","ob","cur","cameraTransition","isCameraMove","cameraLinkageControlsAnimate","addFence","toggleBridCompany","__isFocus__","toggleCompanyFocus","wireframe","hidden","opacity","filter","isFocus","dis","distanceTo","fence","controlReset","maxPolarAngle","setRoamPoint","roamPoints","toggleRoam","segment","tension","close","factor","modelAnimate","render","animateCall","restoreAnchorMaterial","delta","clock","getDelta","_c","steep","isS","dir","getWorldDirection","multiplyScalar","newPos","ds","keyboardToTotation","offset","_d","mds","setY","onPointerMove","checkIntersectObjects","onPointerUp","isClick","timeStamp","tsp","button","onClickRight","objects","t","concat","setFromCamera","interscts","intersectObjects","cursor","isClickGround","groundMeshName","some","indexOf","findParentGroup","onClickGround","onClickLeft","_e","hoverAnchor","onHoverAnchor","_isAnchor_","mat","__mat_color__","THREE.Color","__change_color__","uuid","isSprite","_find","_isBuilding_","parent","getAll","resize","setSize","dotUpdateObjectCall","_group","val","show","Number","toFixed","defineComponent","__name","setup","pageOpts","reactive","animateBack","cruiseCurve","robotObj","getOffsetPoint","getPointAt","ts","atan2","devEnv","baseUrl","env","config","dotKey","dotShowStrict","anchorType","animationModelType","models","url","range","mapUrl","castShadow","penumbra","auto","mapSpeed","floorOpts","active","targetName","tipOpts","top","msg","progress","loadModels","getModel","indexDB","cache","dbName","tbName","version","containerRef","ref","canvasTextureRef","enableDamping","dampingFactor","near","fov","light2","axes","floorItems","computed","dialog","useDialog","title","getStorage","welcomKey","updateDotVisible","res","element","getElementsByClassName","fontSize","textContent","unit","loopLoadObject","async","createDotObject","modelDeepClone","POS","SCA","ROT","get_P_S_R_param","assemblyScenario","percentage","nextTick","modelConfigList","_loop","initDevices","setCruisePoint","getValidTargetPosition","cameraInSceneAnimate","controlSave","setTimeout","cameraPositionList","Axios","get","Api","d3","office","office_mode","JsonList","json","ConfigJson","JSON","parse","er","createRoblt","createCharacter","setScalar","l","r","initPage","toggleCruise","status","getPosition","onListen","setStorage","toRaw","onMounted","liftMeshNames","_intersct","_object","_obj","catch","isShow","run","_i"],"mappings":"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"}