import{e,Y as o,i as a,l as t,c as s,o as r,g as l,h as n,q as i,u as c,p as d,I as m,n as p,t as y,R as u,aK as g}from"./vendor-a6dc29a3.js";import{t as f}from"./index-be43d63c.js";import{e as b,A as h,f as v,_}from"./index-cd5d48e2.js";import{u as x}from"./scene-resize-5065e15d.js";import"./css2d-05e422ef.js";import"./background-0b83747b.js";import"./posZ-54c73ffc.js";import"./config-9a637eb0.js";import"./model-43e989d4.js";import"./model-loader-06fea9a0.js";import"./dialog-7f1ff55c.js";const L={class:"flex flex-ac"},C=_(e({__name:"index",setup(e){const _=v(),C=o({devEnv:!0,baseUrl:"",bgColor:"",env:"/oss/textures/hdr/skidpan_2k.hdr",colors:{normal:{main:[8954293,2698801],text:12180479,FM:8954293},runing:{main:3045368,FM:22799},error:{FM:11877897}},indexDB:{cache:!0,dbName:"THREE__DEVICE__DB",tbName:"TB",version:2},camera:{far:1e6},cruise:{visible:!0,points:[[450,.1,450],[450,.1,-450],[-450,.1,-450],[-450,.1,450]],offset:10},render:{alpha:!0,preserveDrawingBuffer:!0},controls:{screenSpacePanning:!1,maxDistance:1500,maxPolarAngle:.46*Math.PI},grid:{visible:!1,gridColor:44469,centerLineColor:44469,fork:!0,forkColor:44469},axes:{visible:!0},ambientLight:{intensity:2},directionalLight:{helper:!1},config:{},models:[{key:"JSQ",name:"分集水器",size:2,url:"/分集水器.glb"},{key:"LXJ",name:"离心机",size:1.4,url:"/离心机.glb"},{key:"LGJ",name:"螺杆机",size:1.2,url:"/螺杆机.glb"},{key:"LQT",name:"冷却塔",size:.8,url:"/冷却塔.glb"},{key:"LDB",name:"冷冻泵",size:2.5,url:"/冷冻泵.glb"},{key:"LQB",name:"冷却泵",size:2.5,url:"/冷却泵.glb"},{key:"FM",name:"阀门",size:.05,url:"/阀门.glb"},{key:"BSHLQ",name:"板式换热器-制冷",size:.4,url:"/板式换热器-制冷.glb"},{key:"JGBS",name:"警告标识",size:.2,type:"warning",url:"/警告标识.glb"},{key:"JDBS",name:"就地标识",size:.2,type:"local",url:"/就地.glb"},{key:"JYBS",name:"禁用标识",size:.03,type:"disabled",url:"/禁用.glb"},{key:"COLD_CAMERA",name:"摄像头",type:"sprite",size:1,range:{x:37,y:77},mapUrl:"/sxt.png"},{key:"COLD_ROOM_INLET",name:"房间入口",type:"sprite",size:1,range:{x:37,y:77},mapUrl:"/fjdw.png"},{key:"COLD_GPS",name:"定位",type:"sprite",size:1,range:{x:51,y:56},mapUrl:"/dw.png"},{key:"FONT_WRYH",name:"微软雅黑字体",type:"font",size:26.35,url:"/oss/font/YaHei_Regular.json"}].map((e=>("sprite"!==e.type&&e.url&&e.url.indexOf("/oss")<0&&(e.url="/oss/model/ncl"+e.url),e.mapUrl&&(e.mapUrl="/oss/textures/floor"+e.mapUrl),e))),objects:[],dotShowStrict:!0,mainBodyChangeColor:!0,anchorType:["COLD_CAMERA","COLD_ROOM_INLET","COLD_GPS"],colorMeshName:["叶轮","电动阀门"],animationModelType:["LDB","LQB","SB","LXJ","LGJ","LQT"],textModelType:["LDB","LQB","JSQ","LXJ","LGJ","LQT","BSHLQ"]}),k=a(),M=e=>_.formatData(e),S=(e,o)=>{const a=e.deviceCode||"",t=40*Math.random();void 0!==t&&(e.value=t);const s=a.split("_")[0]||"";return o.children.findIndex((e=>{var o;return e.data&&e.data.deviceCode===s&&((null==(o=e.data)?void 0:o.status)||0)>0}))>-1||["SYS","CSC"].includes(s)?e.show=!0:e.show=!1,e.value=Number(Number(e.value||0).toFixed(2)),{value:e.value,show:e.show,font:{...e.font||{},color:"#"+(16777215+1e6*t).toString(16).substring(0,6)}}},j=(e,o)=>{const a=Math.random()>.5?1:0,t=Math.random()>.5?1:0,s=Math.random()>.8?1:0,r=Math.floor(3*Math.random());return{status:s>0?0:a,error:s>0?0:t,remote:1==r?1:0,local:2==r?1:0,disabled:s}},D=e=>{x(e).resize()},B=(e,o)=>{},z=e=>{},O=()=>{const e=[[450,.1,350],[450,.1,-350],[-450,.1,-350],[-450,.1,350]].map((e=>e.map((e=>e*(.2-.2*Math.random()+1)))));C.cruise&&(C.cruise.points=e)},w=()=>{var e;return null==(e=k.value)?void 0:e.exportImage()};return t((()=>{b.get(h.d3.device).then((e=>{let o=e.JsonList;const a=e.ModelUrl;o.unshift({name:e.Name,type:"",url:a?`${C.baseUrl}${a}`:""});let t={};if(e.ConfigJson instanceof Object)t=e.ConfigJson;else if("string"==typeof e.ConfigJson)try{t=JSON.parse(e.ConfigJson)}catch(r){}t.cruise&&C.cruise&&(C.cruise.points=t.cruise),Object.keys(t).forEach((e=>{C.config&&(C.config[e]=t[e])})),C.objects=o.map((e=>("COLD_ROOM_INLET"===e.type&&(e.onClick=e=>{s.success({message:e.name,grouping:!0})}),e)))}))})),(e,o)=>{const a=u,t=g;return r(),l("div",{class:p([e.$style.page,"h-100 o-h"])},[n("div",{class:p(e.$style.operate)},[n("div",L,[o[1]||(o[1]=n("span",null,"点位：",-1)),i(a,{modelValue:c(C).dotShowStrict,"onUpdate:modelValue":o[0]||(o[0]=e=>c(C).dotShowStrict=e),"active-text":"严格","inactive-text":"全显","inline-prompt":""},null,8,["modelValue"])]),i(t,{type:"success",onClick:O},{default:d((()=>o[2]||(o[2]=[m("切换巡航点位")]))),_:1}),i(t,{type:"primary",size:"small",onClick:w},{default:d((()=>o[3]||(o[3]=[m("导出")]))),_:1})],2),i(f,{ref_key:"threeSceneRef",ref:k,"dev-env":c(C).devEnv,"base-url":c(C).baseUrl,"bg-color":c(C).bgColor,"bg-url":c(C).bgUrl,"sky-code":c(C).skyCode,env:c(C).env,colors:c(C).colors,indexDB:c(C).indexDB,camera:c(C).camera,cruise:c(C).cruise,render:c(C).render,controls:c(C).controls,config:c(C).config,grid:c(C).grid,axes:c(C).axes,"ambient-light":c(C).ambientLight,"directional-light":c(C).directionalLight,models:c(C).models,objects:c(C).objects,"dot-show-strict":c(C).dotShowStrict,"anchor-type":c(C).anchorType,"main-body-change-color":c(C).mainBodyChangeColor,"color-mesh-name":c(C).colorMeshName,"animation-model-type":c(C).animationModelType,"text-model-type":c(C).textModelType,"format-object":M,"dot-update-object-call":S,"update-object-call":j,onInit:D,onClickDot:B,onDblclick:z},{dialog:d((({data:o,title:a})=>[n("div",{class:p(e.$style["dialog-wrap"])},[n("div",{class:p(e.$style.circle)},null,2),n("div",{class:p(e.$style.line)},null,2),n("div",{class:p(e.$style.content)},[n("div",{class:p(e.$style.title)},y(a),3),n("div",{class:p(e.$style.data)},y(o),3)],2)],2)])),_:1},8,["dev-env","base-url","bg-color","bg-url","sky-code","env","colors","indexDB","camera","cruise","render","controls","config","grid","axes","ambient-light","directional-light","models","objects","dot-show-strict","anchor-type","main-body-change-color","color-mesh-name","animation-model-type","text-model-type"])],2)}}}),[["__cssModules",{$style:{page:"_page_fyyv5_2",operate:"_operate_fyyv5_8","dialog-wrap":"_dialog-wrap_fyyv5_20",circle:"_circle_fyyv5_26",line:"_line_fyyv5_56",content:"_content_fyyv5_82",title:"_title_fyyv5_89",data:"_data_fyyv5_93"}}]]);export{C as default};
