import{e,i as a,bG as n,bh as t,Y as o,l as i,af as s,o as r,g as l,h as d,bL as c,cK as m,cL as u,be as p,ba as g,cM as f,b6 as h,bw as w,cN as x,c3 as v,bd as b,bb as C,bc as y,b8 as E}from"./vendor-4ee42cfe.js";import{c as z,a as M,b as S,e as D}from"./common-f447c9f7.js";import{d as G}from"./index-f0822326.js";const L={class:"page h-100"},P=e({__name:"index",setup(e){const P=G(),j=a(),F=new n;let _,W,k,A;F.background=new t("#fff");const R=()=>{const e=j.value;if(!_)return;const a=e.clientWidth,n=e.clientHeight,t=a/n;_.aspect=t,_.updateProjectionMatrix(),W.setSize(a,n)};let T;const H=()=>{T=requestAnimationFrame(H),I(),W.render(F,_)},I=()=>{let e=.001*performance.now();Q.position.y=20*Math.sin(e)+5,Q.rotation.x=.5*e,Q.rotation.z=.51*e,B.material.uniforms.time.value+=1/60},N=o({turbidity:10,rayleigh:2,mieCoefficient:.005,mieDirectionalG:.2,elevation:2,azimuth:180,exposure:null});let q;let B;const K=()=>{const e=new g(1e4,1e4);B=new f(e,{textureWidth:512,textureHeight:512,waterNormals:(new h).load(`${P.oss}/textures/waternormals.jpg`,(e=>{e.wrapS=e.wrapT=w})),sunDirection:new p,sunColor:16777215,waterColor:7695,distortionScale:3.7,fog:void 0!==F.fog}),B.rotation.x=-Math.PI/2,F.add(B)};let Y;const $=()=>{Y=new x,Y.scale.setScalar(1e4),F.add(Y)};let J;const O=()=>{const e=Y.material.uniforms;e.turbidity.value=N.turbidity,e.rayleigh.value=N.rayleigh,e.mieCoefficient.value=N.mieCoefficient,e.mieDirectionalG.value=N.mieDirectionalG;const a=v.degToRad(90-N.elevation),n=v.degToRad(N.azimuth);J.setFromSphericalCoords(1,a,n),Y.material.uniforms.sunPosition.value.copy(J),B.material.uniforms.sunDirection.value.copy(J).normalize(),F.environment=q.fromScene(Y).texture,W.toneMappingExposure=N.exposure};let Q;const U=()=>{let e=new b(30,30,30),a=new C({roughness:0,color:1365});Q=new y(e,a),F.add(Q)},V=()=>{const e=j.value;W=z(e),_=M(e,1,1e6),A=new c(16777215,1.5),F.add(A),D(16777215,1.5),k=S(_,W),k.maxPolarAngle=.45*Math.PI,k.screenSpacePanning=!1,K(),$(),W.toneMapping=m,W.outputEncoding=void 0,W.toneMappingExposure=1,N.exposure=W.toneMappingExposure,q=new u(W),J=new p,O(),U(),(e=>{const a=new E,n=a.addFolder("Sky");n.add(N,"turbidity",0,100,.1).name("浑浊").onChange(O),n.add(N,"rayleigh",0,4,.001).name("锐利").onChange(O),n.add(N,"mieCoefficient",0,.1,.001).name("散射系数").onChange(O),n.add(N,"mieDirectionalG",0,1,.001).name("方向").onChange(O),n.add(N,"elevation",0,90,.1).name("高度").onChange(O),n.add(N,"azimuth",-180,180,.1).name("方位").onChange(O),n.add(N,"exposure",0,1,1e-4).name("光晕强度").onChange(O);const t=a.addFolder("Water"),o=B.material.uniforms;t.add(o.distortionScale,"value",0,100,.1).name("变形尺度"),t.add(o.size,"value",.1,10,.1).name("大小"),a.domElement.style="position: absolute; top: 10px; right: 10px",e.appendChild(a.domElement)})(e)};return i((()=>{V(),H(),window.addEventListener("resize",R,!1)})),s((()=>{window.addEventListener("resize",R,!1),cancelAnimationFrame(T);try{F.clear(),W.dispose(),W.forceContextLoss(),W.content=null;let e=W.domElement.getContext("webgl");e&&e.getExtension("WEBGL_lose_context").loseContext()}catch(e){}})),(e,a)=>(r(),l("div",L,[d("div",{ref_key:"containerRef",ref:j,class:"container h-100",style:{position:"relative"}},null,512)]))}});export{P as default};
