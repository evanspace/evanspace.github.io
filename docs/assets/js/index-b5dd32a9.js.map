{"version":3,"file":"index-b5dd32a9.js","sources":["../../../code/src/pages/drag/api/index.vue"],"sourcesContent":["<template>\n  <div :class=\"$style.page\">\n    <div\n      :class=\"$style.container\"\n      @dragstart=\"onDragStart\"\n      @dragover.prevent=\"onDragOver\"\n      @dragenter=\"onDragEnter\"\n      @drop.prevent=\"onDrop\"\n    >\n      <div :class=\"$style.left\" data-drop=\"move\">\n        <div\n          :class=\"$style.item\"\n          v-for=\"(item, index) in course\"\n          :key=\"index\"\n          :style=\"{\n            background: item.color\n          }\"\n          data-effect=\"copy\"\n          :draggable=\"true\"\n        >\n          {{ item.name }}\n        </div>\n      </div>\n\n      <div :class=\"$style.right\">\n        <table border=\"1\" cellspacing=\"0\">\n          <colgroup>\n            <col />\n            <col />\n            <col />\n            <col />\n            <col />\n            <col />\n            <col />\n          </colgroup>\n          <thead>\n            <tr>\n              <th></th>\n              <th>星期一</th>\n              <th>星期二</th>\n              <th>星期三</th>\n              <th>星期四</th>\n              <th>星期五</th>\n              <th>星期六</th>\n              <th>星期日</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td rowspan=\"4\">上午</td>\n              <td data-drop=\"copy\" v-for=\"_i in 7\"></td>\n            </tr>\n            <tr>\n              <td data-drop=\"copy\" v-for=\"_i in 7\"></td>\n            </tr>\n            <tr>\n              <td data-drop=\"copy\" v-for=\"_i in 7\"></td>\n            </tr>\n            <tr>\n              <td data-drop=\"copy\" v-for=\"_i in 7\"></td>\n            </tr>\n\n            <tr>\n              <td rowspan=\"4\">下午</td>\n              <td data-drop=\"copy\" v-for=\"_i in 7\"></td>\n            </tr>\n            <tr>\n              <td data-drop=\"copy\" v-for=\"_i in 7\"></td>\n            </tr>\n            <tr>\n              <td data-drop=\"copy\" v-for=\"_i in 7\"></td>\n            </tr>\n            <tr>\n              <td data-drop=\"copy\" v-for=\"_i in 7\"></td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nconst course = ref([\n  { name: '语文', color: '#f0578a' },\n  { name: '数学', color: '#59eda2' },\n  { name: '英语', color: '#ed694f' },\n  { name: '政治', color: 'orange' },\n  { name: '历史', color: 'purple' },\n  { name: '地理', color: '#73dff6' },\n  { name: '生物', color: 'olive' },\n  { name: '音乐', color: '#bb7bd9' }\n])\n\n//  可拖拽元素一定要设置 draggable 为true 否则会不正常\n\nlet dropEle: any\n// 开始\nconst onDragStart = e => {\n  // 改变鼠标样式\n  e.dataTransfer.effectAllowed = e.target.dataset?.effect\n  // 暂存当前拖拽节点\n  dropEle = e.target\n}\n\n// 移动\nconst onDragOver = e => {\n  // 阻止默认行为 否则 drop 事件无效\n  e.preventDefault()\n}\n\n// 进入\nconst onDragEnter = e => {\n  clearDropStyle()\n\n  const dropNode = getDropNode(e.target)\n  // 判断当前元素的 drop 是否等于当前拖拽的鼠标样式 则能接受当前拖拽节点\n  if (dropNode && dropNode.dataset.drop == e.dataTransfer.effectAllowed) {\n    dropNode.classList.add('drop-over')\n  }\n}\n\n// 松手\nconst onDrop = e => {\n  console.log(e)\n  clearDropStyle()\n\n  const dropNode = getDropNode(e.target)\n  // 判断当前元素的 drop 是否等于当前拖拽的鼠标样式 则能接受当前拖拽节点\n  if (dropNode && dropNode.dataset.drop == e.dataTransfer.effectAllowed) {\n    if (dropNode.dataset.drop == 'copy') {\n      // 复制元素\n      const node = dropEle.cloneNode(true)\n      dropNode.innerHTML = ''\n      node.dataset.effect = 'move'\n      dropNode.appendChild(node)\n    } else {\n      dropEle.remove()\n    }\n  }\n}\n\n// 清除class\nconst clearDropStyle = () => {\n  document.querySelectorAll('.drop-over').forEach(node => {\n    node.classList.remove('drop-over')\n  })\n}\n\n// 获取拖拽节点\nconst getDropNode = node => {\n  while (node) {\n    if (node.dataset && node.dataset.drop) {\n      return node\n    }\n    node = node.parentNode\n  }\n}\n\nonMounted(() => {})\n</script>\n\n<style lang=\"scss\" module>\n@import './style.scss';\n</style>\n"],"names":["course","ref","name","color","dropEle","onDragStart","e","dataTransfer","effectAllowed","_a","target","dataset","effect","onDragOver","preventDefault","onDragEnter","dropNode","getDropNode","drop","classList","add","onDrop","console","log","node","cloneNode","innerHTML","appendChild","remove","clearDropStyle","document","querySelectorAll","forEach","parentNode","onMounted"],"mappings":"mZAmFA,MAAAA,EAAAC,EAAA,CAAmB,CAAAC,KAAA,KAAAC,MAAA,WACc,CAAAD,KAAA,KAAAC,MAAA,WACA,CAAAD,KAAA,KAAAC,MAAA,WACA,CAAAD,KAAA,KAAAC,MAAA,UACD,CAAAD,KAAA,KAAAC,MAAA,UACA,CAAAD,KAAA,KAAAC,MAAA,WACC,CAAAD,KAAA,KAAAC,MAAA,SACF,CAAAD,KAAA,KAAAC,MAAA,aAM/B,IAAAC,EAEA,MAAAC,EAAAC,UAEEA,EAAAC,aAAAC,cAAA,OAAAC,EAAAH,EAAAI,OAAAC,cAAA,EAAAF,EAAAG,OAEAR,EAAAE,EAAAI,MAAA,EAIFG,EAAAP,IAEEA,EAAAQ,gBAAA,EAIFC,EAAAT,QAGE,MAAAU,EAAAC,EAAAX,EAAAI,QAEAM,GAAAA,EAAAL,QAAAO,MAAAZ,EAAAC,aAAAC,eACEQ,EAAAG,UAAAC,IAAA,YAAkC,EAKtCC,EAAAf,IACEgB,QAAAC,IAAAjB,OAGA,MAAAU,EAAAC,EAAAX,EAAAI,QAEA,GAAAM,GAAAA,EAAAL,QAAAO,MAAAZ,EAAAC,aAAAC,cACE,GAAA,QAAAQ,EAAAL,QAAAO,KAAA,CAEE,MAAAM,EAAApB,EAAAqB,WAAA,GACAT,EAAAU,UAAA,GACAF,EAAAb,QAAAC,OAAA,OACAI,EAAAW,YAAAH,EAAyB,MAEzBpB,EAAAwB,QACF,EAKJC,EAAA,KACEC,SAAAC,iBAAA,cAAAC,SAAAR,IACEA,EAAAL,UAAAS,OAAA,YAAA,GAAiC,EAKrCX,EAAAO,IACE,KAAAA,GAAA,CACE,GAAAA,EAAAb,SAAAa,EAAAb,QAAAO,KACE,OAAAM,EAEFA,EAAAA,EAAAS,UAAY,UAIhBC,GAAA"}