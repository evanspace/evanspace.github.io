var e=Object.defineProperty,t=(t,i,s)=>(((t,i,s)=>{i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s})(t,"symbol"!=typeof i?i+"":i,s),s);import{be as i,cV as s,bF as a,bE as o,bh as r,bj as l,bc as n,cT as c,cW as p,b6 as h,bM as d,bd as u,bG as y,bk as w,bp as g,e as v,i as S,l as m,o as B,g as f,h as A}from"./vendor-e369e8a0.js";import{E as T,u as z,i as b}from"./scene-resize-9f6ed2fd.js";import"./index-441efa26.js";const C=Object.freeze({CUBE:1,SPHERE:2}),x=["in vec3  uColor;","in float uOpacity;","in float uSize;","in float uAngle;","in float uVisible;","varying vec4  vColor;","varying float vAngle;","void main() {","  if ( uVisible > 0.5 )","    vColor = vec4( uColor, uOpacity );","  else","    vColor = vec4(0.0, 0.0, 0.0, 0.0);","  vAngle = uAngle;","  vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","  gl_PointSize = uSize * ( 300.0 / length( mvPosition.xyz ) );","  gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),V=["uniform sampler2D uTx;","varying vec4 vColor;","varying float vAngle;","void main() {","  gl_FragColor = vColor;","  float c = cos(vAngle);","  float s = sin(vAngle);","  vec2 rotatedUV = vec2(c * (gl_PointCoord.x - 0.5) + s * (gl_PointCoord.y - 0.5) + 0.5,","  c * (gl_PointCoord.y - 0.5) - s * (gl_PointCoord.x - 0.5) + 0.5);","  vec4 rotatedTexture = texture2D( uTx,  rotatedUV );","  gl_FragColor = gl_FragColor * rotatedTexture;","}"].join("\n");class P{constructor(e,i){t(this,"times"),t(this,"values"),this.times=e||[],this.values=i||[]}lerp(e){for(var t=0,s=this.times.length;t<s&&e>this.times[t];)t++;if(0==t)return this.values[0];if(t==s)return this.values[s-1];var a=(e-this.times[t-1])/(this.times[t]-this.times[t-1]);return this.values[0]instanceof i?this.values[t-1].clone().lerp(this.values[t],a):this.values[t-1]+a*(this.values[t]-this.values[t-1])}}class E extends p{constructor(e){super(),t(this,"color",new r(16777215)),t(this,"map",null),t(this,"size",1),t(this,"sizeAttenuation",!0),t(this,"vertexColors",!1),t(this,"fog",!0),this.setValues(e)}}class D extends c{constructor(e,i){super(),t(this,"geometry"),t(this,"material"),t(this,"sortParticles",!1),t(this,"frustumCulled",!1),this.geometry=void 0!==e?e:new a,this.material=void 0!==i?i:new E({color:16777215*Math.random()})}clone(e){return void 0===e&&(e=new D(this.geometry,this.material)),e.sortParticles=this.sortParticles,super.clone(e),e}}class M{constructor(){t(this,"position",new i),t(this,"velocity",new i),t(this,"acceleration",new i),t(this,"angle",0),t(this,"angleVelocity",0),t(this,"angleAcceleration",0),t(this,"size",16),t(this,"color",new r),t(this,"opacity",1),t(this,"age",0),t(this,"alive",0),t(this,"sizeTween",new P),t(this,"colorTween",new P),t(this,"opacityTween",new P)}update(e){if(this.position.add(this.velocity.clone().multiplyScalar(e)),this.velocity.add(this.acceleration.clone().multiplyScalar(e)),this.angle+=.01745329251*this.angleVelocity*e,this.angleVelocity+=.01745329251*this.angleAcceleration*e,this.age+=e,this.sizeTween.times.length>0&&(this.size=this.sizeTween.lerp(this.age)),this.colorTween.times.length>0){var t=this.colorTween.lerp(this.age);this.color=(new r).setHSL(t.x,t.y,t.z)}this.opacityTween.times.length>0&&(this.opacity=this.opacityTween.lerp(this.age))}}class U{constructor(){t(this,"positionStyle",C.CUBE),t(this,"positionBase",new i),t(this,"positionSpread",new i),t(this,"positionRadius",0),t(this,"velocityStyle",C.CUBE),t(this,"velocityBase",new i),t(this,"velocitySpread",new i),t(this,"speedBase",0),t(this,"speedSpread",0),t(this,"accelerationBase",new i),t(this,"accelerationSpread",new i),t(this,"angleBase",0),t(this,"angleSpread",0),t(this,"angleVelocityBase",0),t(this,"angleVelocitySpread",0),t(this,"angleAccelerationBase",0),t(this,"angleAccelerationSpread",0),t(this,"sizeBase",0),t(this,"sizeSpread",0),t(this,"sizeTween",new P),t(this,"colorBase",new i(0,1,.5)),t(this,"colorSpread",new i(0,0,0)),t(this,"colorTween",new P),t(this,"opacityBase",1),t(this,"opacitySpread",0),t(this,"opacityTween",new P),t(this,"blendStyle",s),t(this,"particleArray",[]),t(this,"particlesPerSecond",100),t(this,"particleDeathAge",1),t(this,"emitterAge",0),t(this,"emitterAlive",!0),t(this,"emitterDeathAge",60),t(this,"particleCount",0),t(this,"particleGeometry",new a),t(this,"particleTexture",null),t(this,"particleMaterial",new o({uniforms:{uTx:{value:this.particleTexture},uVisible:{value:[]},uAngle:{value:[]},uSize:{value:[]},uColor:{value:[]},uOpacity:{value:[]}},vertexShader:x,fragmentShader:V,transparent:!0,alphaTest:.5,blending:s,depthTest:!0})),t(this,"particleMesh",new D),this.particleCount=this.particlesPerSecond*Math.min(this.particleDeathAge,this.emitterDeathAge)}randomValue(e,t){return e+t*(Math.random()-.5)}randomVector3(e,t){var s=new i(Math.random()-.5,Math.random()-.5,Math.random()-.5);return(new i).addVectors(e,(new i).multiplyVectors(t,s))}createParticle(){var e=new M;if(this.positionStyle==C.CUBE)e.position=this.randomVector3(this.positionBase,this.positionSpread);else if(this.positionStyle==C.SPHERE){var t=2*Math.random()-1,s=6.2832*Math.random(),a=Math.sqrt(1-t*t),o=new i(a*Math.cos(s),a*Math.sin(s),t);e.position=(new i).addVectors(this.positionBase,o.multiplyScalar(this.positionRadius))}if(this.velocityStyle==C.CUBE)e.velocity=this.randomVector3(this.velocityBase,this.velocitySpread);else if(this.velocityStyle==C.SPHERE){var l=(new i).subVectors(e.position,this.positionBase),n=this.randomValue(this.speedBase,this.speedSpread);e.velocity=l.normalize().multiplyScalar(n)}e.acceleration=this.randomVector3(this.accelerationBase,this.accelerationSpread),e.angle=this.randomValue(this.angleBase,this.angleSpread),e.angleVelocity=this.randomValue(this.angleVelocityBase,this.angleVelocitySpread),e.angleAcceleration=this.randomValue(this.angleAccelerationBase,this.angleAccelerationSpread),e.size=this.randomValue(this.sizeBase,this.sizeSpread);var c=this.randomVector3(this.colorBase,this.colorSpread);return e.color=(new r).setHSL(c.x,c.y,c.z),e.opacity=this.randomValue(this.opacityBase,this.opacitySpread),e.age=0,e.alive=0,e}setValues(e){if(void 0!==e){this.sizeTween=new P,this.colorTween=new P,this.opacityTween=new P;for(let t in e)this[t]=e[t];M.prototype.sizeTween=this.sizeTween,M.prototype.colorTween=this.colorTween,M.prototype.opacityTween=this.opacityTween,this.particleArray=[],this.emitterAge=0,this.emitterAlive=!0,this.particleCount=this.particlesPerSecond*Math.min(this.particleDeathAge,this.emitterDeathAge),this.particleGeometry=new a,this.particleMaterial=new o({uniforms:{uTx:{value:this.particleTexture},uVisible:{value:[]},uAngle:{value:[]},uSize:{value:[]},uColor:{value:[]},uOpacity:{value:[]}},vertexShader:x,fragmentShader:V,transparent:!0,alphaTest:.5,blending:s,depthTest:!0})}}initialize(){const e=[],t=[],i=[],a=[],o=[],r=[];for(var c=0;c<this.particleCount;c++){const s=this.createParticle();this.particleArray[c]=s,t.push(s.alive);const l=s.color;i.push(l.r,l.g,l.b),a.push(s.opacity),o.push(s.size),r.push(s.angle),e.push(s.position);const n=this.particleMaterial.uniforms;n&&(n.uVisible.value[c]=s.alive,n.uColor.value[c]=s.color,n.uOpacity.value[c]=s.opacity,n.uSize.value[c]=s.size,n.uAngle.value[c]=s.angle)}this.particleGeometry.setFromPoints(e),this.particleGeometry.setAttribute("uVisible",new l(t,1)),this.particleGeometry.setAttribute("uColor",new l(i,3)),this.particleGeometry.setAttribute("uOpacity",new l(a,1)),this.particleGeometry.setAttribute("uSize",new l(o,1)),this.particleGeometry.setAttribute("uAngle",new l(r,1)),this.particleMaterial.blending=this.blendStyle,this.blendStyle!=s&&(this.particleMaterial.depthTest=!1),this.particleMesh=new n(this.particleGeometry,this.particleMaterial),this.particleMesh.dynamic=!0,this.particleMesh.sortParticles=!0}update(e){const t=[];if(!this.particleArray.length)return;const i=this.particleGeometry.attributes.uVisible,s=this.particleGeometry.attributes.uOpacity,a=this.particleGeometry.attributes.uSize,o=this.particleGeometry.attributes.uAngle,r=this.particleGeometry.attributes.uColor;for(let l=0;l<this.particleCount;l++){const n=this.particleArray[l];if(n.alive){n.update(e),n.age>this.particleDeathAge&&(n.alive=0,t.push(l)),i.setX(l,n.alive),i.needsUpdate=!0,s.setX(l,n.opacity),s.needsUpdate=!0,a.setX(l,n.size),a.needsUpdate=!0,o.setX(l,n.angle),o.needsUpdate=!0;const c=n.color;r.setXYZ(l,c.r,c.g,c.b),r.needsUpdate=!0;const p=this.particleMaterial.uniforms;p&&(p.uVisible.value[l]=n.alive,p.uColor.value[l]=n.color,p.uOpacity.value[l]=n.opacity,p.uSize.value[l]=n.size,p.uAngle.value[l]=n.angle)}}if(this.emitterAlive){if(this.emitterAge<this.particleDeathAge){const t=Math.round(this.particlesPerSecond*(this.emitterAge+0));let i=Math.round(this.particlesPerSecond*(this.emitterAge+e));i>this.particleCount&&(i=this.particleCount);for(let e=t;e<i;e++)this.particleArray[e].alive=1}for(let e=0;e<t.length;e++){const i=t[e],s=this.createParticle();s.alive=1,this.particleArray[i]=s;const a=this.particleGeometry.attributes.position,{x:o,y:r,z:l}=s.position;a.setXYZ(i,o,r,l),a.needsUpdate=!0}this.emitterAge+=e,this.emitterAge>this.emitterDeathAge&&(this.emitterAlive=!1)}}destroy(e){e.remove(this.particleMesh)}}const k=new h,G={fountain:{positionStyle:C.CUBE,positionBase:new i(0,5,0),positionSpread:new i(10,0,10),velocityStyle:C.CUBE,velocityBase:new i(0,160,0),velocitySpread:new i(100,20,100),accelerationBase:new i(0,-100,0),particleTexture:k.load("/oss/textures/effect/star.png"),angleBase:0,angleSpread:180,angleVelocityBase:0,angleVelocitySpread:1440,sizeTween:new P([0,1],[1,20]),opacityTween:new P([2,3],[1,0]),colorTween:new P([.5,2],[new i(0,1,.5),new i(.8,1,.5)]),particlesPerSecond:200,particleDeathAge:3,emitterDeathAge:60},fireball:{positionStyle:C.SPHERE,positionBase:new i(0,50,0),positionRadius:2,velocityStyle:C.SPHERE,speedBase:40,speedSpread:8,particleTexture:k.load("/oss/textures/effect/smokeparticle.png"),sizeTween:new P([0,.1],[1,150]),opacityTween:new P([.7,1],[1,0]),colorBase:new i(.02,1,.4),blendStyle:d,particlesPerSecond:60,particleDeathAge:1.5,emitterDeathAge:60},smoke:{positionStyle:C.CUBE,positionBase:new i(0,0,0),positionSpread:new i(10,0,10),velocityStyle:C.CUBE,velocityBase:new i(0,150,0),velocitySpread:new i(80,50,80),accelerationBase:new i(0,-10,0),particleTexture:k.load("/oss/textures/effect/smokeparticle.png"),angleBase:0,angleSpread:720,angleVelocityBase:0,angleVelocitySpread:720,sizeTween:new P([0,1],[32,128]),opacityTween:new P([.8,2],[.5,0]),colorTween:new P([.4,1],[new i(0,0,.2),new i(0,0,.5)]),particlesPerSecond:200,particleDeathAge:2,emitterDeathAge:60},clouds:{positionStyle:C.CUBE,positionBase:new i(-100,100,0),positionSpread:new i(0,50,60),velocityStyle:C.CUBE,velocityBase:new i(40,0,0),velocitySpread:new i(20,0,0),particleTexture:k.load("/oss/textures/effect/smokeparticle.png"),sizeBase:80,sizeSpread:100,colorBase:new i(0,0,1),opacityTween:new P([0,1,4,5],[0,1,1,0]),particlesPerSecond:50,particleDeathAge:10,emitterDeathAge:60},snow:{positionStyle:C.CUBE,positionBase:new i(0,200,0),positionSpread:new i(500,0,500),velocityStyle:C.CUBE,velocityBase:new i(0,-60,0),velocitySpread:new i(50,20,50),accelerationBase:new i(0,-10,0),angleBase:0,angleSpread:720,angleVelocityBase:0,angleVelocitySpread:60,particleTexture:k.load("/oss/textures/effect/snowflake.png"),sizeTween:new P([0,.25],[1,10]),colorBase:new i(.66,1,.9),opacityTween:new P([2,3],[.8,0]),particlesPerSecond:200,particleDeathAge:4,emitterDeathAge:60},rain:{positionStyle:C.CUBE,positionBase:new i(0,200,0),positionSpread:new i(600,0,600),velocityStyle:C.CUBE,velocityBase:new i(0,-400,0),velocitySpread:new i(10,50,10),accelerationBase:new i(0,-10,0),particleTexture:k.load("/oss/textures/effect/raindrop2flip.png"),sizeBase:8,sizeSpread:4,colorBase:new i(.66,1,.7),colorSpread:new i(0,0,.2),opacityBase:.6,particlesPerSecond:1e3,particleDeathAge:1,emitterDeathAge:60},starfield:{positionStyle:C.CUBE,positionBase:new i(0,200,0),positionSpread:new i(600,400,600),velocityStyle:C.CUBE,velocityBase:new i(0,0,0),velocitySpread:new i(.5,.5,.5),angleBase:0,angleSpread:720,angleVelocityBase:0,angleVelocitySpread:4,particleTexture:k.load("/oss/textures/effect/spikey.png"),sizeBase:10,sizeSpread:2,colorBase:new i(.15,1,.9),colorSpread:new i(0,0,.2),opacityBase:1,particlesPerSecond:2e4,particleDeathAge:60,emitterDeathAge:.1},fireflies:{positionStyle:C.CUBE,positionBase:new i(0,100,0),positionSpread:new i(400,200,400),velocityStyle:C.CUBE,velocityBase:new i(0,0,0),velocitySpread:new i(60,20,60),particleTexture:k.load("/oss/textures/effect/spark.png"),sizeBase:30,sizeSpread:2,opacityTween:new P([0,1,1.1,2,2.1,3,3.1,4,4.1,5,5.1,6,6.1],[.2,.2,1,1,.2,.2,1,1,.2,.2,1,1,.2]),colorBase:new i(.3,1,.6),colorSpread:new i(.3,0,0),particlesPerSecond:20,particleDeathAge:6.1,emitterDeathAge:600},startunnel:{positionStyle:C.CUBE,positionBase:new i(0,0,0),positionSpread:new i(10,10,10),velocityStyle:C.CUBE,velocityBase:new i(0,100,200),velocitySpread:new i(40,40,80),angleBase:0,angleSpread:720,angleVelocityBase:10,angleVelocitySpread:0,particleTexture:k.load("/oss/textures/effect/spikey.png"),sizeBase:4,sizeSpread:2,colorBase:new i(.15,1,.8),opacityBase:1,blendStyle:d,particlesPerSecond:500,particleDeathAge:4,emitterDeathAge:60},firework:{positionStyle:C.SPHERE,positionBase:new i(0,100,0),positionRadius:10,velocityStyle:C.SPHERE,speedBase:90,speedSpread:10,accelerationBase:new i(0,-80,0),particleTexture:k.load("/oss/textures/effect/spark.png"),sizeTween:new P([.5,.7,1.3],[5,40,1]),opacityTween:new P([.2,.7,2.5],[.75,1,0]),colorTween:new P([.4,.8,1],[new i(0,1,1),new i(0,1,.6),new i(.8,1,.6)]),blendStyle:d,particlesPerSecond:3e3,particleDeathAge:2.5,emitterDeathAge:.2},candle:{positionStyle:C.SPHERE,positionBase:new i(0,50,0),positionRadius:2,velocityStyle:C.CUBE,velocityBase:new i(0,100,0),velocitySpread:new i(20,0,20),particleTexture:k.load("/oss/textures/effect/smokeparticle.png"),sizeTween:new P([0,.3,1.2],[20,150,1]),opacityTween:new P([.9,1.5],[1,0]),colorTween:new P([.5,1],[new i(.02,1,.5),new i(.05,1,0)]),blendStyle:d,particlesPerSecond:60,particleDeathAge:1.5,emitterDeathAge:60}};class R extends T{constructor(e){super(e),t(this,"engine"),this.createClock(),this.addModel()}addModel(){const e=new U;e.setValues(G.rain),e.initialize(),this.engine=e,this.addObject(e.particleMesh);const t=new u(10,10,10);let i=new Array(8).fill(0).map((()=>[1,0,0,0,1,0,0,0,1])).flat(),s=new y(new Float32Array(i),3);t.setAttribute("color",s);const a=new n(t,new w({vertexColors:!0,side:g,wireframe:!1}));a.position.x=50,this.addObject(a)}modelAnimate(){var e;const t=null==(e=this.clock)?void 0:e.getDelta();this.engine&&this.engine.update(.5*t)}}const O={class:"three-page"},_=v({__name:"index",setup(e){b.useBackground();const t=S(),i={axes:{},grid:{}};let s;return m((()=>{i.container=t.value,s=new R(i),s.run(),z(s).resize()})),(e,i)=>(B(),f("div",O,[A("div",{class:"h-100",ref_key:"containerRef",ref:t},null,512)]))}});export{_ as default};
