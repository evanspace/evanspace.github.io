var e=Object.defineProperty,s=(s,t,a)=>(((s,t,a)=>{t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a})(s,"symbol"!=typeof t?t+"":t,a),a);import{eW as t,eX as a,eY as n,bu as r,eZ as o,ec as i,ea as d,e_ as l,e as c,Y as u,i as p,l as m,o as h,g,h as v}from"./vendor-46b9e856.js";import{E as b,p as f,u as w,i as _}from"./scene-resize-af96d43c.js";import"./index-efec42cd.js";const{pass:x,mrt:y,output:j,emissive:M}=l;class P extends b{constructor(e){super(e),s(this,"gui"),s(this,"postProcessing");const o=x(this.scene,this.camera);o.setMRT(y({output:j,emissive:M}));const i=o.getTextureNode(),d=o.getTextureNode("emissive"),l=t(d,2.5,.5);this.renderer.toneMapping=a;const c=new n(this.renderer);c.outputNode=i.add(l),this.postProcessing=c,this.gui=new r,this.addGui(l)}setEnv(e){this.scene.environment=e,this.scene.background=e}createRender(){return new o}createAmbientLight(e,s){return new i(e,s)}createDirectionalLight(e,s){return new d(e,s)}addGui(e){var s;const t=this.gui,a=t.addFolder("发光");a.add(e.threshold,"value",0,1).step(.01).name("阈值/起点"),a.add(e.strength,"value",0,3).step(.01).name("强度"),a.add(e.radius,"value",0,1).step(.01).name("半径"),a.open();const n=t.addFolder("色调映射");n.add(this.renderer,"toneMappingExposure",.1,3).name("曝光"),n.open(),t.domElement.className+=" gui-wrap",null==(s=this.container.parentNode)||s.appendChild(t.domElement)}animate(){this.postProcessing.renderAsync()}}const E={class:"three-page"},N=c({__name:"index",setup(e){const s=u({base:"https://raw.githubusercontent.com/zlevan/3d-demo-data/main",models:[{key:"helmet",name:"头盔",size:3.4,url:"/models/gpu/头盔.glb"}],objects:[{type:"helmet",name:"头盔"}]}),{progress:t,loadModels:a,getModel:n,initModels:r}=f.useModelLoader({baseUrl:s.base}),o=p(),i={baseUrl:s.base,env:"/textures/hdr/moonless_golf_1k.hdr",camera:{position:[0,0,10]}};let d;return m((()=>{i.container=o.value,d=new P(i).run(),w(d).resize(),a(s.models,(()=>{t.percentage=100,t.show=!1,r(s.objects,(e=>{const{type:s}=e,t=n(s);if(!t)return Promise.resolve();let a=_.modelDeepClone(t);const{position:r,scale:o,rotation:i}=_.get_P_S_R_param(a,e),[l,c,u]=r;return a.scale.set(...o),a.position.set(l,c,u),a.rotation.set(...i),d.addObject(a),Promise.resolve()}))}))})),(e,s)=>(h(),g("div",E,[v("div",{class:"h-100",ref_key:"containerRef",ref:o},null,512)]))}});export{N as default};
