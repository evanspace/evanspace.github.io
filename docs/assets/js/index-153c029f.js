import{e,i as a,Y as s,g as o,q as r,p as l,j as d,b4 as t,o as n,h as w,u,I as p,b as i,au as c,aT as f,ak as m,aR as g}from"./vendor-f2ff441f.js";import{u as _,b,_ as h}from"./index-30eca53d.js";const P={class:"content"},v={class:"change-pwd"},$=h(e({__name:"index",setup(e){const h=a(null),$=s({password:"",newPassword:"",confirmNewPassword:""}),V=a(!1),y={password:[{required:!0,trigger:"blur",message:"请输入旧密码。"}],newPassword:[{trigger:"blur",required:!0,validator:(e,a,s)=>{if(""===a)s(new Error("请输入密码"));else{const e=h.value;""!==$.confirmNewPassword&&e.validateField("confirmNewPassword"),(a.length<6||a.length>24)&&s(new Error("确保至少包含6个或最多24个字符"));/^(?![a-zA-Z]+$)(?![A-Z0-9]+$)(?![A-Z\W_!@#$%^&*`~()-+=]+$)(?![a-z0-9]+$)(?![a-z\W_!@#$%^&*`~()-+=]+$)(?![0-9\W_!@#$%^&*`~()-+=]+$)[a-zA-Z0-9\W_!@#$%^&*`~()-+=]/.test(a)||s(new Error("密码必须包含数字，特殊字符，小写字母，大写字母其中三项")),a===$.password&&s(new Error("新密码不能与旧密码相同")),s()}}}],confirmNewPassword:[{trigger:"blur",required:!0,validator:(e,a,s)=>{""===a?s(new Error("请再次输入密码")):a!==$.newPassword?s(new Error("两个输入不匹配！")):s()}}]},N=_(),E=d(),x=()=>{h.value.validate((e=>{if(!e)return!1;V.value=!0;const a={...$};console.log(a),N.changePwd(a).then((async()=>{i({type:"success",title:"提示",message:"密码修改成功！"}),await N.logout(),E.push(`${b}/login`)}))}))},k=()=>{h.value.resetFields()};return(e,a)=>{const s=c,d=f,i=m,_=g,b=t;return n(),o("div",P,[r(b,{class:"box-card"},{header:l((()=>a[3]||(a[3]=[w("div",{class:"clearfix"},[w("span",null,"修改密码")],-1)]))),default:l((()=>[w("div",v,[r(_,{ref_key:"formRef",ref:h,model:u($),rules:y,"status-icon":"","label-position":"top"},{default:l((()=>[r(d,{label:"旧密码",prop:"password"},{default:l((()=>[r(s,{modelValue:u($).password,"onUpdate:modelValue":a[0]||(a[0]=e=>u($).password=e),type:"password",placeholder:"旧密码",clearable:"","show-password":"",autocomplete:"off"},null,8,["modelValue"])])),_:1}),r(d,{label:"新密码",prop:"newPassword"},{default:l((()=>[r(s,{modelValue:u($).newPassword,"onUpdate:modelValue":a[1]||(a[1]=e=>u($).newPassword=e),type:"password",placeholder:"新密码",clearable:"","show-password":"",autocomplete:"off"},null,8,["modelValue"])])),_:1}),r(d,{label:"确认新密码",prop:"confirmNewPassword"},{default:l((()=>[r(s,{modelValue:u($).confirmNewPassword,"onUpdate:modelValue":a[2]||(a[2]=e=>u($).confirmNewPassword=e),type:"password",placeholder:"确认密码",clearable:"","show-password":"",autocomplete:"off"},null,8,["modelValue"])])),_:1}),r(d,null,{default:l((()=>[r(i,{type:"primary",loading:u(V),onClick:x},{default:l((()=>a[4]||(a[4]=[p("提交")]))),_:1},8,["loading"]),r(i,{onClick:k},{default:l((()=>a[5]||(a[5]=[p("重置")]))),_:1})])),_:1})])),_:1},8,["model"])])])),_:1})])}}}),[["__scopeId","data-v-669ebc71"]]);export{$ as default};
