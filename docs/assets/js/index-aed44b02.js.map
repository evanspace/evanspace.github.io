{"version":3,"file":"index-aed44b02.js","sources":["../../../code/src/pages/webgl/light/spot/methods.ts","../../../code/src/pages/webgl/light/spot/index.vue"],"sourcesContent":["import * as THREE from 'three'\n\nimport * as ThreeScene from 'three-scene'\n\nimport { GUI } from 'dat.gui'\n\nconst base = import.meta.env.VITE_BEFORE_STATIC_PATH\n\nconst textureLoader = new THREE.TextureLoader().setPath(`${base}/oss/textures/`)\nconst texture = textureLoader.load('disturb.jpg')\n\nexport class LightScene extends ThreeScene.Scene {\n  spotLight: InstanceType<typeof THREE.SpotLight>\n  lightHelper: InstanceType<typeof THREE.SpotLightHelper>\n  gui: InstanceType<typeof GUI>\n  constructor(options: ConstructorParameters<typeof ThreeScene.Scene>[0]) {\n    super(options)\n\n    // 灯光\n    const spotLight = this.createSpolight()\n    this.spotLight = spotLight\n    this.addObject(this.spotLight)\n    const lightHelper = new THREE.SpotLightHelper(spotLight)\n    this.lightHelper = lightHelper\n    this.addObject(lightHelper)\n\n    const ground = this.createGround(0xffffff)\n    this.addObject(ground)\n\n    this.addModel()\n\n    this.createClock()\n\n    this.gui = new GUI()\n    this.addGui()\n  }\n\n  createSpolight() {\n    const spotLight = new THREE.SpotLight(0xffffff, 1)\n    spotLight.position.set(200, 500, 200)\n    spotLight.angle = Math.PI / 6\n    spotLight.penumbra = 1 // 聚光锥的半影衰减百分比\n    spotLight.decay = 0 // 衰减\n    spotLight.distance = 1500 // 距离\n    spotLight.map = texture\n\n    spotLight.castShadow = true\n    spotLight.shadow.mapSize.width = 1024\n    spotLight.shadow.mapSize.height = 1024\n    spotLight.shadow.camera.near = 1 // 大于 1 否则闪屏\n    spotLight.shadow.camera.far = 10\n    spotLight.shadow.focus = 1\n    spotLight.shadow.bias = -0.003\n\n    return spotLight\n  }\n\n  addModel() {\n    const box = new THREE.Mesh(\n      new THREE.BoxGeometry(100, 100, 100),\n      new THREE.MeshStandardMaterial({ color: 0xffffff })\n    )\n    box.position.set(-60, 50, 0)\n\n    const sphere = new THREE.Mesh(\n      new THREE.SphereGeometry(50, 32, 32),\n      new THREE.MeshStandardMaterial({ color: 0xffffff })\n    )\n    sphere.position.set(60, 50, 0)\n    this.addObject(box, sphere)\n  }\n\n  addGui() {\n    const gui = this.gui\n    const spotLight = this.spotLight\n    gui.add(spotLight, 'intensity', 0, 10).name('光照强度')\n    gui\n      .addColor(\n        {\n          color: spotLight.color.getHex()\n        },\n        'color'\n      )\n      .name('光照颜色')\n      .onChange(x => {\n        spotLight.color.set(x)\n      })\n    gui.add(spotLight, 'angle', 0, Math.PI / 3).name('角度')\n    gui.add(spotLight, 'penumbra', 0, 1).name('半影')\n    gui.add(spotLight, 'decay', 0, 2).name('衰减')\n    gui.add(spotLight, 'distance', 0, 2000).name('距离')\n\n    gui.domElement.className += ' gui-wrap'\n    this.container.parentNode?.appendChild(gui.domElement)\n  }\n\n  modelAnimate(): void {\n    const time = performance.now() / 3000\n    const spotLight = this.spotLight\n\n    spotLight.position.x = Math.cos(time) * 300\n    spotLight.position.z = Math.sin(time) * 300\n\n    this.lightHelper.update()\n  }\n}\n","<template>\n  <div class=\"three-page\">\n    <div class=\"h-100\" ref=\"containerRef\"></div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { LightScene } from './methods'\n\nimport { useResize } from '@/hooks/scene-resize'\n\nconst containerRef = ref()\nconst options: ConstructorParameters<typeof LightScene>[0] = {\n  ambientLight: {\n    intensity: 0.15\n  },\n  directionalLight: {\n    visible: false\n  }\n}\nlet scene: InstanceType<typeof LightScene>\n\nonMounted(() => {\n  options.container = containerRef.value\n  scene = new LightScene(options)\n  scene.run()\n\n  useResize(scene).resize()\n})\n</script>\n\n<style lang=\"scss\"></style>\n"],"names":["texture","THREE.TextureLoader","setPath","load","LightScene","ThreeScene.Scene","constructor","options","super","__publicField","this","spotLight","createSpolight","addObject","lightHelper","THREE.SpotLightHelper","ground","createGround","addModel","createClock","gui","GUI","addGui","THREE.SpotLight","position","set","angle","Math","PI","penumbra","decay","distance","map","castShadow","shadow","mapSize","width","height","camera","near","far","focus","bias","box","THREE.Mesh","THREE.BoxGeometry","THREE.MeshStandardMaterial","color","sphere","THREE.SphereGeometry","add","name","addColor","getHex","onChange","x","domElement","className","_a","container","parentNode","appendChild","modelAnimate","time","performance","now","cos","z","sin","update","containerRef","ref","ambientLight","intensity","directionalLight","visible","scene","onMounted","value","run","useResize","resize"],"mappings":"8XAMA,MAGMA,GADgB,IAAIC,GAAsBC,QAAQ,kBAC1BC,KAAK,eAEtB,MAAAC,UAAmBC,EAI9B,WAAAC,CAAYC,GACVC,MAAMD,GAJRE,EAAAC,KAAA,aACAD,EAAAC,KAAA,eACAD,EAAAC,KAAA,OAKQ,MAAAC,EAAYD,KAAKE,iBACvBF,KAAKC,UAAYA,EACZD,KAAAG,UAAUH,KAAKC,WACd,MAAAG,EAAc,IAAIC,EAAsBJ,GAC9CD,KAAKI,YAAcA,EACnBJ,KAAKG,UAAUC,GAET,MAAAE,EAASN,KAAKO,aAAa,UACjCP,KAAKG,UAAUG,GAEfN,KAAKQ,WAELR,KAAKS,cAEAT,KAAAU,IAAM,IAAIC,EACfX,KAAKY,QACP,CAEA,cAAAV,GACE,MAAMD,EAAY,IAAIY,EAAgB,SAAU,GAgBzC,OAfPZ,EAAUa,SAASC,IAAI,IAAK,IAAK,KACvBd,EAAAe,MAAQC,KAAKC,GAAK,EAC5BjB,EAAUkB,SAAW,EACrBlB,EAAUmB,MAAQ,EAClBnB,EAAUoB,SAAW,KACrBpB,EAAUqB,IAAMhC,EAEhBW,EAAUsB,YAAa,EACbtB,EAAAuB,OAAOC,QAAQC,MAAQ,KACvBzB,EAAAuB,OAAOC,QAAQE,OAAS,KACxB1B,EAAAuB,OAAOI,OAAOC,KAAO,EACrB5B,EAAAuB,OAAOI,OAAOE,IAAM,GAC9B7B,EAAUuB,OAAOO,MAAQ,EACzB9B,EAAUuB,OAAOQ,MAAO,KAEjB/B,CACT,CAEA,QAAAO,GACQ,MAAAyB,EAAM,IAAIC,EACd,IAAIC,EAAkB,IAAK,IAAK,KAChC,IAAIC,EAA2B,CAAEC,MAAO,YAE1CJ,EAAInB,SAASC,KAAS,GAAA,GAAI,GAEpB,MAAAuB,EAAS,IAAIJ,EACjB,IAAIK,EAAqB,GAAI,GAAI,IACjC,IAAIH,EAA2B,CAAEC,MAAO,YAE1CC,EAAOxB,SAASC,IAAI,GAAI,GAAI,GACvBf,KAAAG,UAAU8B,EAAKK,EACtB,CAEA,MAAA1B,SACE,MAAMF,EAAMV,KAAKU,IACXT,EAAYD,KAAKC,UACvBS,EAAI8B,IAAIvC,EAAW,YAAa,EAAG,IAAIwC,KAAK,QAEzC/B,EAAAgC,SACC,CACEL,MAAOpC,EAAUoC,MAAMM,UAEzB,SAEDF,KAAK,QACLG,UAAcC,IACH5C,EAAAoC,MAAMtB,IAAI8B,EAAC,IAErBnC,EAAA8B,IAAIvC,EAAW,QAAS,EAAGgB,KAAKC,GAAK,GAAGuB,KAAK,MACjD/B,EAAI8B,IAAIvC,EAAW,WAAY,EAAG,GAAGwC,KAAK,MAC1C/B,EAAI8B,IAAIvC,EAAW,QAAS,EAAG,GAAGwC,KAAK,MACvC/B,EAAI8B,IAAIvC,EAAW,WAAY,EAAG,KAAMwC,KAAK,MAE7C/B,EAAIoC,WAAWC,WAAa,YAC5B,OAAAC,EAAAhD,KAAKiD,UAAUC,aAAYF,EAAAG,YAAYzC,EAAIoC,WAC7C,CAEA,YAAAM,GACQ,MAAAC,EAAOC,YAAYC,MAAQ,IAC3BtD,EAAYD,KAAKC,UAEvBA,EAAUa,SAAS+B,EAAqB,IAAjB5B,KAAKuC,IAAIH,GAChCpD,EAAUa,SAAS2C,EAAqB,IAAjBxC,KAAKyC,IAAIL,GAEhCrD,KAAKI,YAAYuD,QACnB,4DC7FF,MAAAC,EAAAC,IACAhE,EAAA,CAA6DiE,aAAA,CAC7CC,UAAA,KAEdC,iBAAA,CACkBC,SAAA,IAIpB,IAAAC,SAEAC,GAAA,KACEtE,EAAAoD,UAAAW,EAAAQ,MACAF,EAAA,IAAAxE,EAAAG,GACAqE,EAAAG,MAEAC,EAAAJ,GAAAK"}