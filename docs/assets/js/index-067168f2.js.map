{"version":3,"file":"index-067168f2.js","sources":["../../../code/src/pages/webgpu/effect/smoke/data.ts","../../../code/src/pages/webgpu/effect/smoke/methods.ts","../../../code/src/pages/webgpu/effect/smoke/index.vue"],"sourcesContent":["const base = import.meta.env.VITE_BEFORE_STATIC_PATH\n\nexport const getPageOpts = () => ({\n  base,\n\n  models: [\n    {\n      key: 'coffeeMug',\n      name: '咖啡杯',\n      size: 0.5,\n      url: '/oss/model/gpu/coffeeMug.glb'\n    }\n  ],\n\n  objects: [\n    {\n      type: 'coffeeMug',\n      name: '咖啡杯',\n      position: { x: -80, y: 25, z: 0 },\n      scale: { x: 10, y: 10, z: 10 }\n    }\n  ]\n})\n","import * as ThreeScene from 'three-scene'\n\nimport * as THREE from 'three/webgpu'\n\nimport { GUI } from 'dat.gui'\n\n// const { createStripSmoke } = ThreeScene.Hooks.useSmoke()\n\nconst TSL = THREE.TSL\nconst {\n  mix,\n  mul,\n  oneMinus,\n  positionLocal,\n  smoothstep,\n  texture,\n  time,\n  rotateUV,\n  Fn,\n  uv,\n  vec2,\n  vec3,\n  vec4,\n  uniform\n} = TSL\n\nconst base = import.meta.env.VITE_BEFORE_STATIC_PATH\nconst textureLoader = new THREE.TextureLoader()\n\n// 速度\nconst speed = uniform(0.2)\n\nexport class SmokeScene extends ThreeScene.Scene {\n  gui: InstanceType<typeof GUI>\n\n  smokeInstancedSprite?: any\n  fireInstancedSprite?: any\n\n  constructor(options: ConstructorParameters<typeof ThreeScene.Scene>[0]) {\n    super(options)\n\n    // const ground = this.createGround()\n    // this.addObject(ground)\n\n    this.addModel()\n\n    this.gui = new GUI()\n    this.addGui()\n  }\n\n  render() {\n    this.renderer.renderAsync(this.scene, this.camera)\n  }\n\n  createScene() {\n    return new THREE.Scene()\n  }\n\n  createRender() {\n    return new THREE.WebGPURenderer()\n  }\n\n  createDirectionalLight(color: string | number, intensity: number) {\n    return new THREE.DirectionalLight(color, intensity)\n  }\n\n  createAmbientLight(color: string | number, intensity: number) {\n    return new THREE.AmbientLight(color, intensity)\n  }\n\n  createPerspectiveCamera(fov: number, aspect: number, near: number, far: number) {\n    return new THREE.PerspectiveCamera(fov, aspect, near, far)\n  }\n\n  addModel() {\n    this.addSmoke()\n    this.addSmallSmoke()\n  }\n\n  addSmoke() {\n    // 动画周期范围\n    const lifeRange = TSL.range(0.1, 1)\n    const offsetRange = TSL.range(new THREE.Vector3(-2, 3, -2), new THREE.Vector3(2, 5, 2))\n\n    const scaledTime = TSL.time.add(5).mul(speed) // + 5 * speed\n\n    const lifeTime = scaledTime.mul(lifeRange).mod(1)\n    const scaleRange = TSL.range(0.3, 2)\n    const roteRange = TSL.range(0.1, 4)\n\n    const life = lifeTime.div(lifeRange)\n    const fakeLightEffect = TSL.positionLocal.y.oneMinus().max(0.2)\n\n    const textureNode = TSL.texture(\n      textureLoader.load(`${base}/oss/textures/effect/smoke1.png`),\n      TSL.rotateUV(TSL.uv(), scaledTime.mul(roteRange))\n    )\n\n    const opacityNode = textureNode.a.mul(life.oneMinus())\n\n    // 混合/颜色\n    const smokeColor = TSL.mix(\n      TSL.color(0xffffff),\n      TSL.color(0x222222),\n      // TSL.color(0xf00f00),\n      TSL.positionLocal.y.mul(0.5).clamp()\n    )\n\n    // 缩放倍数\n    const s = 40\n\n    // 烟\n    const smokeNodeMaterial = new THREE.SpriteNodeMaterial()\n    // 烟 混合颜色\n    smokeNodeMaterial.colorNode = TSL.mix(\n      TSL.color(0xf27d0c),\n      smokeColor,\n      life.mul(2.5).min(1)\n    ).mul(fakeLightEffect)\n\n    smokeNodeMaterial.opacityNode = opacityNode\n    smokeNodeMaterial.positionNode = offsetRange.mul(lifeTime)\n    smokeNodeMaterial.scaleNode = scaleRange.mul(lifeTime.max(0.3))\n    smokeNodeMaterial.depthWrite = false\n    smokeNodeMaterial.transparent = true\n\n    // 烟 精灵材质\n    const smokeInstancedSprite = new THREE.Mesh(new THREE.PlaneGeometry(1, 1), smokeNodeMaterial)\n    smokeInstancedSprite.scale.setScalar(s)\n    // @ts-ignore\n    smokeInstancedSprite.count = 2000\n    smokeInstancedSprite.position.y = s / 4\n    smokeInstancedSprite.castShadow = true\n    this.smokeInstancedSprite = smokeInstancedSprite\n    this.addObject(smokeInstancedSprite)\n\n    // 烟中心（火焰）\n    const fireGeometry = new THREE.PlaneGeometry(1, 1)\n    const fireCount = 1000\n\n    const fireNodeMaterial = new THREE.SpriteNodeMaterial()\n    fireNodeMaterial.colorNode = TSL.mix(TSL.color(0xb72f17), TSL.color(0xb72f17), life)\n    fireNodeMaterial.positionNode = TSL.range(\n      new THREE.Vector3(-1, 1, -1),\n      new THREE.Vector3(1, 2, 1)\n    ).mul(lifeTime)\n    fireNodeMaterial.scaleNode = smokeNodeMaterial.scaleNode\n    fireNodeMaterial.opacityNode = opacityNode.mul(0.5)\n    fireNodeMaterial.blending = THREE.AdditiveBlending\n    fireNodeMaterial.transparent = true\n    fireNodeMaterial.depthWrite = false\n\n    const fireInstancedSprite = new THREE.Mesh(fireGeometry, fireNodeMaterial)\n    fireInstancedSprite.scale.setScalar(s)\n    // @ts-ignore\n    fireInstancedSprite.count = fireCount\n    fireInstancedSprite.position.y = s / 4\n    // fireInstancedSprite.renderOrder = 1\n    fireInstancedSprite.castShadow = true\n    this.fireInstancedSprite = fireInstancedSprite\n    this.addObject(fireInstancedSprite)\n  }\n\n  addSmallSmoke() {\n    // 网格\n    const smokeGeometry = new THREE.PlaneGeometry(1, 1, 16, 64)\n    // 位置\n    smokeGeometry.translate(0, 0.5, 0)\n    smokeGeometry.scale(15, 60, 15)\n\n    const noiseTexture = textureLoader.load(`${base}/oss/textures/gpu/128x128.png`)\n    noiseTexture.wrapS = THREE.RepeatWrapping\n    noiseTexture.wrapT = THREE.RepeatWrapping\n\n    const smokeMaterial = new THREE.MeshBasicNodeMaterial({\n      transparent: true,\n      side: THREE.DoubleSide,\n      depthWrite: false\n    })\n\n    // 位置\n    smokeMaterial.positionNode = Fn(() => {\n      // 扭曲\n      const twistNoiseUv = vec2(0.6, uv().y.mul(0.3).sub(time.mul(speed)).mod(1)) // 扭曲位置、速度\n      const twist = texture(noiseTexture, twistNoiseUv).r.mul(5) // 扭曲数量\n      positionLocal.xz.assign(rotateUV(positionLocal.xz, twist, vec2(1))) // 扭曲偏差位置\n\n      // 气流\n      const windOffset = vec2(\n        texture(noiseTexture, vec2(0.25, time.mul(0.01)).mod(1)).r.sub(0.5), // 向右气流\n        texture(noiseTexture, vec2(0.75, time.mul(0.01)).mod(1)).r.sub(0) // 上下气流\n      ).mul(uv().y.pow(2).mul(80)) // 风力偏差\n      positionLocal.addAssign(windOffset)\n      return positionLocal\n    })()\n\n    // 颜色\n    smokeMaterial.colorNode = Fn(() => {\n      // 透明度\n      const alphaNoiseUv = uv()\n        .mul(vec2(0.8, 0.3))\n        .add(vec2(0, time.mul(0.03).negate()))\n      const alpha = mul(\n        // 图案\n        texture(noiseTexture, alphaNoiseUv).r.smoothstep(0.4, 1),\n\n        // 边缘褪色\n        smoothstep(0, 0.1, uv().x),\n        smoothstep(0, 0.1, oneMinus(uv().x)),\n        smoothstep(0, 0.1, uv().y),\n        smoothstep(0, 0.1, oneMinus(uv().y))\n      )\n\n      const finalColor = mix(vec3(0.6, 0.3, 0.2), vec3(1, 1, 1), alpha.pow(3))\n      return vec4(finalColor, alpha)\n    })()\n\n    const smoke = new THREE.Mesh(smokeGeometry, smokeMaterial)\n    smoke.position.x = -80\n    smoke.position.y = 30\n    this.addObject(smoke)\n\n    const width = 100,\n      height = 50\n    // const sm = createStripSmoke({\n    const sm = this.createSmoke({\n      width,\n      height,\n      twistNums: 1,\n      twistRange: 0.1,\n      // color: 0xf00f00,\n      offset: 0.1,\n      segment: 10\n      // speed: uniform(0.2),\n      // power: uniform(2)\n    })\n    sm.position.set(-100, 0, 200)\n    this.addObject(sm)\n    console.log(sm)\n    // sm.geometry = new THREE.PlaneGeometry(200, 200, 64, 64)\n\n    const ts = new THREE.Mesh(\n      new THREE.PlaneGeometry(width, height),\n      new THREE.MeshBasicMaterial({ color: 0xf00f00, wireframe: true })\n    )\n    ts.position.copy(sm.position.clone().add(new THREE.Vector3(0, height / 2, 0)))\n    this.addObject(ts)\n  }\n\n  createSmoke(\n    opts: {\n      width?: number\n      height?: number\n      segment?: number\n      // 速度（风速、扭曲）\n      speed?: number | ReturnType<typeof uniform>\n      // 颜色\n      color?: number | string\n      // 颜色饱和\n      alphaPow?: number\n      // 扭曲次数\n      twistNums?: number\n      // 扭曲范围\n      twistRange?: number\n      // 左右风速\n      RLSpeed?: number\n      // 上下风速\n      TDSpeed?: number\n      // 锋利偏差\n      offset?: number\n      // 风力\n      power?: number | ReturnType<typeof uniform>\n    } = {}\n  ) {\n    const {\n      width = 10,\n      height = 10,\n      speed = 0.2,\n      color = 0xffffff,\n      alphaPow = 3,\n      twistNums = 5,\n      twistRange = 0,\n      RLSpeed = 0.1,\n      TDSpeed = 0.1,\n      offset = 50,\n      segment = 10,\n      power = 0.03\n    } = opts\n    const geometry = new THREE.PlaneGeometry(1, 1, width * segment, height * segment)\n    geometry.scale(width, height, 1)\n    geometry.rotateY(((Math.PI * 0.5) / 3) * twistNums)\n    geometry.translate(0, height / 2, 0)\n    const material = new THREE.MeshBasicNodeMaterial({\n      transparent: true,\n      side: THREE.DoubleSide,\n      depthWrite: false\n    })\n\n    const noiseTexture = textureLoader.load(`${base}/oss/textures/gpu/128x128.png`)\n    noiseTexture.wrapS = THREE.RepeatWrapping\n    noiseTexture.wrapT = THREE.RepeatWrapping\n\n    // 位置\n    material.positionNode = Fn(() => {\n      // 扭曲\n      const twistNoiseUv = vec2(0.8, uv().y.mul(0.3).sub(time.mul(speed))) // 扭曲位置、速度\n      const twist = texture(noiseTexture, twistNoiseUv).r.mul(twistNums) // 扭曲数量\n      positionLocal.xz.assign(rotateUV(positionLocal.xz, twist, vec2(twistRange))) // 扭曲偏差位置\n\n      // 气流\n      const windOffset = vec2(\n        texture(noiseTexture, vec2(0.25, time.mul(RLSpeed)).mod(1)).r.sub(0.5), // 向右气流\n        texture(noiseTexture, vec2(0.75, time.mul(TDSpeed)).mod(1)).r.sub(0) // 上下气流\n      ).mul(uv().y.pow(1).mul(offset)) // 风力偏差\n      positionLocal.addAssign(windOffset)\n      return positionLocal\n    })()\n\n    // 颜色\n    material.colorNode = Fn(() => {\n      // 透明度\n      const alphaNoiseUv = uv()\n        // 范围\n        .mul(vec2(0.8, 0.3))\n        .add(vec2(0, time.mul(power).negate()))\n      const alpha = mul(\n        // 图案\n        texture(noiseTexture, alphaNoiseUv).r.smoothstep(0.4, 1),\n\n        // 边缘褪色\n        smoothstep(0, 0.1, uv().x),\n        smoothstep(0, 0.1, oneMinus(uv().x)),\n        smoothstep(0, 0.1, uv().y),\n        smoothstep(0, 0.1, oneMinus(uv().y))\n      )\n\n      const c = new THREE.Color(color)\n      const finalColor = mix(vec3(c.r, c.g, c.b), vec3(1, 1, 1), alpha.pow(alphaPow))\n      return vec4(finalColor, alpha)\n    })()\n\n    const mesh = new THREE.Mesh(geometry, material)\n    return mesh\n  }\n\n  addGui() {\n    const gui = this.gui\n\n    gui.add(speed, 'value', 0.01, 1, 0.01).name('烟雾速度')\n\n    if (this.fireInstancedSprite) {\n      gui\n        .add(this.fireInstancedSprite, 'count', 200, 2000)\n        .name('烟雾浓度')\n        .onChange(v => {\n          this.smokeInstancedSprite.count = v * 2\n        })\n    }\n    gui.domElement.className += ' gui-wrap'\n    this.container.parentNode?.appendChild(gui.domElement)\n  }\n}\n","<template>\n  <div class=\"three-page\">\n    <div class=\"h-100\" ref=\"containerRef\"></div>\n\n    <t-loading v-model=\"progress.show\" :progress=\"progress.percentage\"></t-loading>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport tLoading from '@/components/loading/index.vue'\n\nimport { getPageOpts } from './data'\nimport { SmokeScene } from './methods'\n\nimport { useResize } from '@/hooks/scene-resize'\n\nimport { Hooks, Utils } from 'three-scene'\n\nconst pageOpts = reactive(getPageOpts())\nconst { progress, loadModels, getModel, initModels } = Hooks.useModelLoader({\n  baseUrl: pageOpts.base\n})\n\nconst containerRef = ref()\nconst options: ConstructorParameters<typeof SmokeScene>[0] = {\n  grid: {\n    visible: true\n  },\n  axes: {\n    visible: true\n  },\n  render: {\n    logarithmicDepthBuffer: false\n  }\n}\nlet scene: InstanceType<typeof SmokeScene>\n\nconst initPage = () => {\n  loadModels(pageOpts.models, () => {\n    // 加载进度 100\n    progress.percentage = 100\n    progress.show = false\n\n    // 初始化模型\n    initModels(pageOpts.objects, item => {\n      const { type } = item\n      const obj = getModel(type)\n      if (!obj) return Promise.resolve()\n\n      // 深克隆\n      let model = Utils.modelDeepClone(obj)\n      const { position: POS, scale: SCA, rotation: ROT } = Utils.get_P_S_R_param(model, item)\n      const [x, y, z] = POS\n\n      // 缩放\n      model.scale.set(...SCA)\n\n      // 摆放位置\n      model.position.set(x, y, z)\n      // 转换方位\n      model.rotation.set(...ROT)\n\n      scene.addObject(model)\n      return Promise.resolve()\n    })\n  })\n}\n\nonMounted(() => {\n  options.container = containerRef.value\n  scene = new SmokeScene(options)\n  scene.run()\n\n  useResize(scene).resize()\n\n  initPage()\n})\n</script>\n\n<style lang=\"scss\" module></style>\n"],"names":["TSL","THREE.TSL","mix","mul","oneMinus","positionLocal","smoothstep","texture","time","rotateUV","Fn","uv","vec2","vec3","vec4","uniform","textureLoader","THREE.TextureLoader","speed","SmokeScene","ThreeScene.Scene","constructor","options","super","__publicField","this","addModel","gui","GUI","addGui","render","renderer","renderAsync","scene","camera","createScene","THREE.Scene","createRender","THREE.WebGPURenderer","createDirectionalLight","color","intensity","THREE.DirectionalLight","createAmbientLight","THREE.AmbientLight","createPerspectiveCamera","fov","aspect","near","far","THREE.PerspectiveCamera","addSmoke","addSmallSmoke","lifeRange","range","offsetRange","THREE.Vector3","scaledTime","add","lifeTime","mod","scaleRange","roteRange","life","div","fakeLightEffect","y","max","opacityNode","load","a","smokeColor","clamp","smokeNodeMaterial","THREE.SpriteNodeMaterial","colorNode","min","positionNode","scaleNode","depthWrite","transparent","smokeInstancedSprite","THREE.Mesh","THREE.PlaneGeometry","scale","setScalar","count","position","s","castShadow","addObject","fireGeometry","fireNodeMaterial","blending","THREE.AdditiveBlending","fireInstancedSprite","smokeGeometry","translate","noiseTexture","wrapS","THREE.RepeatWrapping","wrapT","smokeMaterial","THREE.MeshBasicNodeMaterial","side","THREE.DoubleSide","twistNoiseUv","sub","twist","r","xz","assign","windOffset","pow","addAssign","alphaNoiseUv","negate","alpha","x","finalColor","smoke","sm","createSmoke","width","height","twistNums","twistRange","offset","segment","set","console","log","ts","THREE.MeshBasicMaterial","wireframe","copy","clone","opts","alphaPow","RLSpeed","TDSpeed","power","geometry","rotateY","Math","PI","material","c","THREE.Color","g","b","name","onChange","v","domElement","className","_a","container","parentNode","appendChild","pageOpts","reactive","base","models","key","size","url","objects","type","z","progress","loadModels","getModel","initModels","Hooks","useModelLoader","baseUrl","containerRef","ref","grid","visible","axes","logarithmicDepthBuffer","onMounted","value","run","useResize","resize","percentage","show","item","obj","Promise","resolve","model","Utils","modelDeepClone","POS","SCA","rotation","ROT","get_P_S_R_param"],"mappings":"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"}