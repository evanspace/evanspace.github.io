import{e,i as a,dv as n,c$ as t,Y as o,l as i,af as s,o as r,g as l,h as d,dy as c,dX as m,dY as u,bm as p,bd as f,bo as g,bp as h,bq as w,dZ as x,di as v,cS as C,be as y,bf as b,cX as E}from"./vendor-75d44f4a.js";import{c as S,a as z,b as M,e as D}from"./common-3624cbdb.js";import{f as P}from"./index-5784889a.js";const j={class:"page h-100"},F=e({__name:"index",setup(e){const F=P(),G=a(),_=new n;let L,W,k,A;_.background=new t("#fff");const R=()=>{const e=G.value;if(!L)return;const a=e.clientWidth,n=e.clientHeight,t=a/n;L.aspect=t,L.updateProjectionMatrix(),W.setSize(a,n)};let T;const q=()=>{T=requestAnimationFrame(q),H(),W.render(_,L)},H=()=>{let e=.001*performance.now();K.position.y=20*Math.sin(e)+5,K.rotation.x=.5*e,K.rotation.z=.51*e,Y.material.uniforms.time.value+=1/60},I=o({turbidity:10,rayleigh:2,mieCoefficient:.005,mieDirectionalG:.2,elevation:2,azimuth:180,exposure:null});let X;let Y;const $=()=>{const e=new f(1e4,1e4);Y=new g(e,{textureWidth:512,textureHeight:512,waterNormals:(new h).load(`${F.oss}/textures/waternormals.jpg`,(e=>{e.wrapS=e.wrapT=w})),sunDirection:new p,sunColor:16777215,waterColor:7695,distortionScale:3.7,fog:void 0!==_.fog}),Y.rotation.x=-Math.PI/2,_.add(Y)};let B;const N=()=>{B=new x,B.scale.setScalar(1e4),_.add(B)};let Z;const J=()=>{const e=B.material.uniforms;e.turbidity.value=I.turbidity,e.rayleigh.value=I.rayleigh,e.mieCoefficient.value=I.mieCoefficient,e.mieDirectionalG.value=I.mieDirectionalG;const a=v.degToRad(90-I.elevation),n=v.degToRad(I.azimuth);Z.setFromSphericalCoords(1,a,n),B.material.uniforms.sunPosition.value.copy(Z),Y.material.uniforms.sunDirection.value.copy(Z).normalize(),_.environment=X.fromScene(B).texture,W.toneMappingExposure=I.exposure};let K;const O=()=>{let e=new C(30,30,30),a=new y({roughness:0,color:1365});K=new b(e,a),_.add(K)},Q=()=>{const e=G.value;W=S(e),L=z(e,1,1e6),A=new c(16777215,1.5),_.add(A),D(16777215,1.5),k=M(L,W),k.maxPolarAngle=.45*Math.PI,k.screenSpacePanning=!1,$(),N(),W.toneMapping=m,W.toneMappingExposure=1,I.exposure=W.toneMappingExposure,X=new u(W),Z=new p,J(),O(),(e=>{const a=new E,n=a.addFolder("Sky");n.add(I,"turbidity",0,100,.1).name("浑浊").onChange(J),n.add(I,"rayleigh",0,4,.001).name("锐利").onChange(J),n.add(I,"mieCoefficient",0,.1,.001).name("散射系数").onChange(J),n.add(I,"mieDirectionalG",0,1,.001).name("方向").onChange(J),n.add(I,"elevation",0,90,.1).name("高度").onChange(J),n.add(I,"azimuth",-180,180,.1).name("方位").onChange(J),n.add(I,"exposure",0,1,1e-4).name("光晕强度").onChange(J);const t=a.addFolder("Water"),o=Y.material.uniforms;t.add(o.distortionScale,"value",0,100,.1).name("变形尺度"),t.add(o.size,"value",.1,10,.1).name("大小"),a.domElement.style="position: absolute; top: 10px; right: 10px",e.appendChild(a.domElement)})(e)};return i((()=>{Q(),q(),window.addEventListener("resize",R,!1)})),s((()=>{window.addEventListener("resize",R,!1),cancelAnimationFrame(T);try{_.clear(),W.dispose(),W.forceContextLoss(),W.content=null;let e=W.domElement.getContext("webgl");e&&e.getExtension("WEBGL_lose_context").loseContext()}catch(e){}})),(e,a)=>(r(),l("div",j,[d("div",{ref_key:"containerRef",ref:G,class:"container h-100",style:{position:"relative"}},null,512)]))}});export{F as default};
