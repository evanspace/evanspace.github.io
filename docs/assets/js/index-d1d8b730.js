import{e,Y as o,i as s,l as a,c as t,o as i,g as r,h as l,q as n,u as p,p as m,I as c,n as d,R as y,aK as g}from"./vendor-35ba52b8.js";import{t as u}from"./index-b38560a5.js";import{d as _,A as f,j as h,_ as b}from"./index-d110e4b7.js";import{u as L}from"./scene-resize-49d2e39e.js";import"./index-61123474.js";import"./sky-a5e3e5d2.js";const x={class:"flex flex-ac"},v=b(e({__name:"index",setup(e){const b=h(),v=o({devEnv:!0,baseUrl:"",bgColor:"",colors:{normal:{main:[8954293,2698801],text:12180479,FM:8954293},runing:{main:3045368,FM:22799},error:{FM:11877897}},indexDB:{cache:!0,dbName:"THREE__DEVICE__DB",tbName:"TB",version:2},camera:{far:1e6},cruise:{visible:!0,points:[[450,.1,450],[450,.1,-450],[-450,.1,-450],[-450,.1,450]],offset:10},render:{alpha:!0,preserveDrawingBuffer:!0},controls:{screenSpacePanning:!1,maxDistance:1500,maxPolarAngle:.46*Math.PI},grid:{visible:!1,gridColor:44469,centerLineColor:44469,fork:!0,forkColor:44469},axes:{visible:!1},ambientLight:{intensity:1.5},directionalLight:{helper:!1},statusOffset:{TEXT:{JSQ:{position:{x:0,y:10,z:20}},LDB:{position:{x:0,y:0,z:75},rotation:{x:0,y:90,z:0}},LGJ_3:{position:{x:0,y:16,z:50},rotation:{x:-20,y:0,z:0}},LQT:{position:{x:-55,y:12,z:0}}},WARNING:{LDB:{position:{x:0,y:45,z:4},rotation:{x:0,y:90,z:0}},LQT:{position:{x:0,y:115,z:0}}}},config:{},models:[{key:"JSQ",name:"分集水器",size:2,url:"/分集水器.glb"},{key:"LXJ",name:"离心机",size:1.4,url:"/离心机.glb"},{key:"LGJ",name:"螺杆机",size:1.2,url:"/螺杆机.glb"},{key:"LGJ_3",name:"螺杆机",size:1.2,url:"/螺杆机-三机头.glb"},{key:"LQT",name:"冷却塔",size:.8,url:"/冷却塔.glb"},{key:"LDB",name:"冷冻泵",size:2.5,url:"/冷冻泵.glb"},{key:"LQB",name:"冷却泵",size:2.5,url:"/冷却泵.glb"},{key:"FM",name:"阀门",size:.05,url:"/阀门.glb"},{key:"BSHLQ",name:"板式换热器-制冷",size:.4,url:"/板式换热器-制冷.glb"},{key:"JGBS",name:"警告标识",size:.2,type:"warning",url:"/警告标识.glb"},{key:"COLD_CAMERA",name:"摄像头",type:"sprite",size:1,range:{x:37,y:77},mapUrl:"/sxt.png"},{key:"COLD_ROOM_INLET",name:"房间入口",type:"sprite",size:1,range:{x:37,y:77},mapUrl:"/fjdw.png"},{key:"COLD_GPS",name:"定位",type:"sprite",size:1,range:{x:51,y:56},mapUrl:"/dw.png"},{key:"LDH_PIPE_ERECT",type:"pipe",name:"冷冻回水",size:.01,url:"/oss/model/pipe/冷冻回.glb",mapUrl:"/oss/model/pipe/002.png",mapMeshName:"贴图"},{key:"LDH_PIPE_RIGHT_ANGLE",type:"pipe",name:"冷冻回-弯头",size:.12,url:"/oss/model/pipe/冷冻回-弯头.glb",repeat:[1,.25],mapUrl:"/oss/model/pipe/002.png",mapMeshName:"贴图"},{key:"LDG_PIPE_ERECT",type:"pipe",name:"冷冻供水",size:.01,url:"/oss/model/pipe/冷冻供.glb",mapUrl:"/oss/model/pipe/002.png",mapMeshName:"贴图"},{key:"LDG_PIPE_RIGHT_ANGLE",type:"pipe",name:"冷冻供-弯头",size:.12,url:"/oss/model/pipe/冷冻供-弯头.glb",repeat:[1,.25],mapUrl:"/oss/model/pipe/002.png",mapMeshName:"贴图"},{key:"LQG_PIPE_ERECT",type:"pipe",name:"冷却供水",size:.01,url:"/oss/model/pipe/冷却供.glb",mapUrl:"/oss/model/pipe/002.png",mapMeshName:"贴图"},{key:"LQG_PIPE_RIGHT_ANGLE",type:"pipe",name:"冷却供-弯头",size:.12,repeat:[1,.25],url:"/oss/model/pipe/冷却供-弯头.glb",mapUrl:"/oss/model/pipe/002.png",mapMeshName:"贴图"},{key:"LQH_PIPE_ERECT",type:"pipe",name:"冷却回水",size:.01,url:"/oss/model/pipe/冷却回.glb",mapUrl:"/oss/model/pipe/002.png",mapMeshName:"贴图"},{key:"LQH_PIPE_RIGHT_ANGLE",type:"pipe",name:"冷却回-弯头",size:.12,url:"/oss/model/pipe/冷却回-弯头.glb",repeat:[1,.25],mapUrl:"/oss/model/pipe/002.png",mapMeshName:"贴图"},{key:"FONT_WRYH",name:"微软雅黑字体",type:"font",size:26.35,url:"/oss/font/YaHei_Regular.json"}].map((e=>("sprite"!==e.type&&e.url&&e.url.indexOf("/oss")<0&&(e.url="/oss/model/cool"+e.url),e.mapUrl&&e.mapUrl.indexOf("/oss")<0&&(e.mapUrl="/oss/textures/floor"+e.mapUrl),e))),objects:[],pipes:[],dotShowStrict:!0,textChangeColor:!0,mainBodyChangeColor:!1,anchorType:["COLD_CAMERA","COLD_ROOM_INLET","COLD_GPS"],colorMeshName:["电动阀门","叶轮","螺杆A","螺杆B","螺杆C","螺杆D","螺杆E","螺杆F","螺杆G","螺杆H"],animationModelType:["LDB","LQB","SB","LXJ","LGJ","LGJ_3","LQT"],textModelType:["LDB","LQB","JSQ","LXJ","LGJ","LGJ_3","LQT","BSHLQ"]}),C=s(),k=e=>b.formatData(e),z=(e,o)=>{const s=e.deviceCode||"",a=40*Math.random();void 0!==a&&(e.value=a);const t=s.split("_")[0]||"";return o.findIndex((e=>{var o;return e.data&&e.data.deviceCode===t&&((null==(o=e.data)?void 0:o.status)||0)>0}))>-1||["SYS","CSC"].includes(t)?e.show=!0:e.show=!1,e.value=Number(Number(e.value||0).toFixed(2)),{value:e.value,show:e.show,font:{...e.font||{},color:"#"+(16777215+1e6*a).toString(16).substring(0,6)}}},E=(e,o)=>{const s=Math.random()>.5?1:0,a=Math.random()>.5?1:0,t=Math.random()>.8?1:0,i=Math.floor(3*Math.random());return{status:t>0?0:s,error:t>0?0:a,remote:1==i?1:0,local:2==i?1:0,disabled:t}},M=e=>{L(e).resize()},D=(e,o)=>{},T=e=>{},N=()=>{const e=[[450,.1,350],[450,.1,-350],[-450,.1,-350],[-450,.1,350]].map((e=>e.map((e=>e*(.2-.2*Math.random()+1)))));v.cruise&&(v.cruise.points=e)},S=()=>{var e;return null==(e=C.value)?void 0:e.exportImage()};return a((()=>{_.get(f.d3.device2).then((e=>{let o=e.JsonList;const s=e.ModelUrl;o.unshift({name:e.Name,type:"",url:s?`${v.baseUrl}${s}`:""});let a={};if(e.ConfigJson instanceof Object)a=e.ConfigJson;else if("string"==typeof e.ConfigJson)try{a=JSON.parse(e.ConfigJson)}catch(i){}a.cruise&&v.cruise&&(v.cruise.points=a.cruise),Object.keys(a).forEach((e=>{v.config&&(v.config[e]=a[e])})),v.pipes=e.PipeList||[],v.objects=o.map((e=>("COLD_ROOM_INLET"===e.type&&(e.onClick=e=>{t.success({message:e.name,grouping:!0})}),e)))}))})),(e,o)=>{const s=y,a=g;return i(),r("div",{class:d([e.$style.page,"h-100 o-h"])},[l("div",{class:d(e.$style.operate)},[l("div",x,[o[1]||(o[1]=l("span",null,"点位：",-1)),n(s,{modelValue:p(v).dotShowStrict,"onUpdate:modelValue":o[0]||(o[0]=e=>p(v).dotShowStrict=e),"active-text":"严格","inactive-text":"全显","inline-prompt":""},null,8,["modelValue"])]),n(a,{type:"success",onClick:N},{default:m((()=>o[2]||(o[2]=[c("切换巡航点位")]))),_:1}),n(a,{type:"primary",size:"small",onClick:S},{default:m((()=>o[3]||(o[3]=[c("导出")]))),_:1})],2),n(u,{ref_key:"threeSceneRef",ref:C,"dev-env":p(v).devEnv,"base-url":p(v).baseUrl,"bg-color":p(v).bgColor,"bg-url":p(v).bgUrl,"sky-code":p(v).skyCode,env:p(v).env,colors:p(v).colors,indexDB:p(v).indexDB,camera:p(v).camera,cruise:p(v).cruise,render:p(v).render,controls:p(v).controls,config:p(v).config,grid:p(v).grid,axes:p(v).axes,"ambient-light":p(v).ambientLight,"directional-light":p(v).directionalLight,"status-offset":p(v).statusOffset,models:p(v).models,objects:p(v).objects,pipes:p(v).pipes,"dot-show-strict":p(v).dotShowStrict,"anchor-type":p(v).anchorType,"text-change-color":p(v).textChangeColor,"main-body-change-color":p(v).mainBodyChangeColor,"color-mesh-name":p(v).colorMeshName,"animation-model-type":p(v).animationModelType,"text-model-type":p(v).textModelType,"format-object":k,"dot-update-object-call":z,"update-object-call":E,onInit:M,onClickDot:D,onDblclick:T},null,8,["dev-env","base-url","bg-color","bg-url","sky-code","env","colors","indexDB","camera","cruise","render","controls","config","grid","axes","ambient-light","directional-light","status-offset","models","objects","pipes","dot-show-strict","anchor-type","text-change-color","main-body-change-color","color-mesh-name","animation-model-type","text-model-type"])],2)}}}),[["__cssModules",{$style:{page:"_page_fyyv5_2",operate:"_operate_fyyv5_8","dialog-wrap":"_dialog-wrap_fyyv5_20",circle:"_circle_fyyv5_26",line:"_line_fyyv5_56",content:"_content_fyyv5_82",title:"_title_fyyv5_89",data:"_data_fyyv5_93"}}]]);export{v as default};
