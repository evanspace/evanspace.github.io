var e,t,s,a,o=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)},n=(e,t,s)=>(o(e,t,"read from private field"),s?s.call(e):t.get(e)),i=(e,t,s)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,s)},r=(e,t,s,a)=>(o(e,t,"write to private field"),a?a.call(e,s):t.set(e,s),s),l=(e,t,s)=>(o(e,t,"access private method"),s);import{c0 as c,c1 as p,bs as g,be as d,c2 as u,c3 as m,c4 as h,c5 as f,bw as v,c6 as y,c7 as w,bd as x,c8 as b,bh as C,bc as k,c9 as j,ca as S,b6 as M,ba as I,bk as A,bp as L,bx as P,cc as O,cw as _,cv as z,cz as U,ce as R,cf as B,cx as G,ck as E,cS as F,bF as D,by as T,bE as Y,d9 as X,da as J,bo as W,db as $,cq as Z,dc as K,co as N,e as V,i as Q,w as H,l as q,aP as ee,o as te,g as se,h as ae,n as oe,u as ne,a9 as ie,a5 as re,B as le,Y as ce,q as pe,p as ge,I as de,t as ue,c as me,ak as he}from"./vendor-706835b2.js";import{_ as fe,a as ve,b as ye,c as we,d as xe,e as be,f as Ce,g as ke,h as je,j as Se,k as Me,l as Ie,m as Ae,n as Le,o as Pe,p as Oe,q as _e,r as ze,s as Ue,t as Re,u as Be,v as Ge,w as Ee,x as Fe,y as De,z as Te,A as Ye,B as Xe,C as Je,D as We,E as $e,F as Ze,G as Ke,H as Ne,I as Ve,J as Qe,K as He,L as qe,M as et,N as tt,O as st,P as at,Q as ot,R as nt,U as it,V as rt,W as lt,X as ct,Y as pt,Z as gt,$ as dt,a0 as ut,a1 as mt,a2 as ht,a3 as ft,a4 as vt,a5 as yt,a6 as wt,a7 as xt,a8 as bt,a9 as Ct,aa as kt,ab as jt,ac as St,ad as Mt,ae as It,i as At}from"./three-scene.module-58bdfa82.js";import{d as Lt,c as Pt,u as Ot,S as _t,D as zt,_ as Ut,e as Rt,f as Bt,h as Gt,i as Et,j as Ft,k as Dt,l as Tt,m as Yt,n as Xt,o as Jt,p as Wt,q as $t,r as Zt,s as Kt,t as Nt,v as Vt,g as Qt,a as Ht,b as qt,w as es}from"./index-d89b8c3e.js";import{_ as ts,e as ss,A as as,n as os}from"./index-d9f99ba1.js";import{u as ns}from"./scene-resize-c71cb45a.js";const is=()=>({initCSS3DRender:(e,t)=>{const{width:s,height:a}=e,o=new v;return o.setSize(s,a),o.domElement.style.position="absolute",o.domElement.style.left="0px",o.domElement.style.top="0px",o.domElement.style.pointerEvents="none",t.appendChild(o.domElement),o},createCSS3DDom:e=>{const{name:t,className:s="",onClick:a,position:o,sprite:n}=e,i=document.createElement("div");i.innerHTML=t,i.className=s;const r=n?new y(i):new w(i);return i.style.pointerEvents=a?"auto":"none",i.style.position="absolute","function"==typeof a&&i.addEventListener("click",a),o&&r.position.set(...o),r}}),{createCSS3DDom:rs}=is(),ls={depth:1,scale:40,plateRadius:200,rightClickBackDiffTime:100,areaLabel:!1,markLight:!1,border:!0,mapBg:!0,mapBar:!0,bgOutFactor:1,bgInnerFactor:.9,map:{}},cs={main:3377879,mainHover:9633791,borderColor:9633791,borderHoverColor:1066618,light:1066618,lightHover:9633791,plateColor:3377879,plateLight:1066618,line:9559027,line2:6421501,gridColor:663606,gridFork:927811,outline:11856636,markColor1:13303807,markColor2:6945023,flyColor1:9559027,flyColor2:6421501,scatterColor1:9559027,scatterColor2:6421501},{initCSS3DRender:ps,createCSS3DDom:gs}=is(),{raycaster:ds,pointer:us,style:ms,update:hs}=Ot(),{createCorrugatedPlate:fs,corrugatedPlateUpdate:vs}=((e={})=>{let t=Lt({range:100,interval:.8,size:.2,color:47273,light:881527,factor:1},e);const s=(e,t)=>{const s=e.material,a=s.uniforms.uRange.value,o=s.uniforms.uLength.value;s.uniforms.uRadius.value+=t*(a/4),s.uniforms.uRadius.value>=a+o&&(s.uniforms.uRadius.value=0)};return{createCorrugatedPlate:(e={})=>{t=Lt(t,e);let{range:s,color:a,light:o,factor:n}=t;s*=n;const i=(()=>{let{range:e,interval:s,size:a,factor:o}=t;e*=o,s*=o,a*=o;const n=[],i=Math.floor(e/s);for(let t=-i;t<=i;t++)for(let e=-i;e<=i;e++){const o=new I(a,a),i=t*s,r=e*s,l=new _,c=new d(i,-a,r),p=new U,g=new z,u=new d(1,1,1);p.setFromEuler(g),l.compose(c,p,u),o.applyMatrix4(l),n.push(o)}return n})(),r=O(i),l=new b({uniforms:{uColor:{value:new C(o)},uTcolor:{value:new C(a)},uRadius:{value:1.25},uLength:{value:s/10},uRange:{value:s}},vertexShader:"\n        varying vec3 vp;\n        void main(){\n          vp = position;\n          gl_Position\t= projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:"\n        varying vec3 vp;\n        uniform vec3 uColor;\n        uniform vec3 uTcolor;\n        uniform float uRadius;\n        uniform float uLength;\n        float getLeng(float x, float y){\n          return  sqrt((x-0.0)*(x-0.0)+(y-0.0)*(y-0.0));\n        }\n        void main(){\n          float uOpacity = 0.8;\n          vec3 vColor = uColor;\n          float length = getLeng(vp.x,vp.z);\n          if ( length <= uRadius && length > uRadius - uLength ) {\n            float op = sin( (uRadius - length) / uLength ) ;\n            uOpacity = op;\n            if ( vp.y < 0.0 ) {\n              vColor = uColor * op;\n            } else {\n              vColor = uTcolor;\n            };\n            vColor = uTcolor;\n          }\n          gl_FragColor = vec4(vColor,uOpacity);\n        }\n      ",transparent:!0,depthWrite:!1,side:L}),c=new k(r,l);return c.name="波纹板",c},update:s,corrugatedPlateUpdate:s}})(),{getBoundingBox:ys}={getBoundingBox:e=>{var t=new E;t.expandByObject(e);var s=new d;t.getSize(s);var a=new d;return t.getCenter(a),{box3:t,center:a,size:s}}},{createMarkLight:ws}=((e={})=>{let t=Lt({pointTextureUrl:Pt("point.png"),circleTextureUrl:Pt("circle.png"),lightTextureUrl:Pt("light.png"),factor:1,color:65535},e);const s=new M,a=()=>{const e=new I(3,3),a=new A({map:s.load(t.circleTextureUrl),color:t.color,side:L,opacity:0,transparent:!0,depthWrite:!1});let o=new k(e,a);o.renderOrder=2,o.name="createLightHalo";const n=.5*t.factor;o.scale.setScalar(n);const i=(r=0,l=2e3,Math.floor(Math.random()*(l-r+1))+r);var r,l;return o.tween1=new P({scale:n,opacity:0}).to({scale:1.5*n,opacity:1},1e3).delay(i).onUpdate((e=>{let{scale:t,opacity:s}=e;o.scale.setScalar(t),o.material.opacity=s})),o.tween2=new P({scale:1.5*n,opacity:1}).to({scale:2*n,opacity:0},1e3).onUpdate((e=>{let{scale:t,opacity:s}=e;o.scale.setScalar(t),o.material.opacity=s})),o.tween1.chain(o.tween2),o.tween2.chain(o.tween1),o.tween1.start(),o};return{createMarkLight:(e=[0,0,0],o=10,n={})=>{t=Lt(t,n);const i=new g,r=new I(o/6.219,o);r.rotateX(-Math.PI/2),r.translate(0,0,o/2);const l=new A({map:s.load(t.lightTextureUrl),color:t.color,transparent:!0,depthWrite:!1,side:L});let c=new k(r,l);c.rotateX(Math.PI),c.position.z=o,c.renderOrder=3,c.name="光柱 01";let p=c.clone();p.name="光柱 02",p.rotateZ(Math.PI/2);const d=(()=>{const e=new I(3,3),a=new A({map:s.load(t.pointTextureUrl),color:t.color,side:L,transparent:!0,depthWrite:!1});let o=new k(e,a);o.renderOrder=1,o.name="底部光点";const n=.3*t.factor;return o.scale.setScalar(n),o})(),u=a();i.add(c,p,d,u);const[m,h,f]=e;return i.position.set(m,h,f),i.rotateX(.5*Math.PI),i.name="光柱标记",i}}})(),{createCountryFlatLine:xs,getPoints:bs}=(()=>{const e=(e,t,s="LineLoop")=>{let a;if("Line2"===s){const s=new u;s.setPositions(e),a=new m(s,t),a.name="countryLine2",a.computeLineDistances()}else{const o=new h;o.setFromPoints(e),a=new f[s](o,t),a.name="countryLine"}return a};return{createCountryFlatLine:(t,s,a="LineLoop")=>{let o={color:65535,linewidth:1,depthTest:!1};o=Lt(o,s);let n=new c(o);"Line2"===a&&(n=new p(o));let i=t.features,r=new g;for(let l=0;l<i.length;l++){const t=i[l].geometry.coordinates;for(let s=0;s<t.length;s++){const o=t[s],i=[];"Line2"===a?o.forEach((e=>{e.forEach((e=>{i.push(e[0],0,-e[1])}))})):o.forEach((e=>{e.forEach((e=>{i.push(new d(e[0],e[1],0))}))}));let l=e(i,n,a);r.add(l)}}return r},getPoints:(e,t=0,s)=>{let a=e.features;const o=[];for(let n=0;n<a.length;n++){const e=a[n].geometry.coordinates;for(let a=0;a<e.length;a++)e[a].forEach((e=>{e.forEach((e=>{s?o.push(new d(e[0],t,-e[1])):o.push(e[0],t,-e[1])}))}))}return o}}})(),{createOutline:Cs,outlineUpdate:ks}=((e={})=>{let t=Lt({size:.1,color:16085360,range:500,factor:1,speed:6},e);const s=e=>{const s=e.material,a=s.uniforms.uLength.value;s.uniforms.uIndex.value+=t.speed,s.uniforms.uIndex.value>=a&&(s.uniforms.uIndex.value=0)};return{createOutline:(e,s={})=>{t=Lt(t,s);const{size:a,factor:o,range:n,color:i}=t,r=new Float32Array(e),l=new h;l.setAttribute("position",new j(r,3));const c=new Float32Array(Math.floor(r.length/3)).map(((e,t)=>t));l.setAttribute("aIndex",new j(c,1));const p=new b({vertexShader:"\n        attribute float aOpacity;\n        uniform float uSize;\n\n        attribute float aIndex;\n        varying vec3 vp;\n        varying float vertexIndex;\n\n        void main(){\n          gl_Position = projectionMatrix*modelViewMatrix*vec4(position,1.0);\n          gl_PointSize = uSize;\n\n          vp = position;\n          vertexIndex = aIndex;\n        }\n      ",fragmentShader:"\n        varying float vertexIndex;\n        uniform vec3 uColor;\n        uniform float uIndex;\n        uniform float uRange;\n\n        float invert(float n){\n          return 1.-n;\n        }\n\n        void main(){\n          float uOpacity = 1.0;\n          if(vertexIndex <= uIndex || vertexIndex >= (uRange + uIndex)){\n              discard;\n          }\n          uOpacity = (vertexIndex - uIndex)/uRange;\n          if ( uOpacity < 0.2) {\n            discard;\n          }\n          vec2 uv=vec2(gl_PointCoord.x,invert(gl_PointCoord.y));\n          vec2 cUv=2.*uv-1.;\n          vec4 color=vec4(1./length(cUv));\n          color*=uOpacity;\n          color.rgb*=uColor;\n          gl_FragColor=color;\n        }\n      ",transparent:!0,depthTest:!1,uniforms:{uSize:{value:a*o},uIndex:{value:0},uLength:{value:c.length},uRange:{value:n},uColor:{value:new C(i)}}}),g=new S(l,p);return g.name="轮廓",g.scale.setScalar(o),g},update:s,outlineUpdate:s}})(),{createFlywireTexture:js,createFlywire:Ss,flywireUpdate:Ms}=((e={})=>{let t,s,a=Lt({depth:0,height:4,divisions:1e3,color:16777215,flyColor:16761095,pointColor:16715760,pointWidth:2.5,flyPointWidth:2.4,tubularSegments:256,radius:.5,radialSegments:8,closed:!1,length:100,factor:1,speed:4},e);const o=e=>{const[t,o]=e;let{pointWidth:n,depth:i,factor:r}=a;const l=n*r;i*=r;const c=new I(l,l,1,1),p=new k(c,s);return p.position.set(t,i,-o),p.rotateX(.5*-Math.PI),p},n=(e={})=>{a=Lt(a,e),t=new b({depthTest:!1,uniforms:{uColor:{value:new C(a.flyColor)},uIndex:{value:0},uTotal:{value:a.divisions},uWidth:{value:a.flyPointWidth},uLength:{value:a.length}},vertexShader:["attribute float aIndex;","uniform float uIndex;","uniform float uWidth;","uniform vec3 uColor;","varying float vSize;","uniform float uLength;","void main(){","    vec4 viewPosition = viewMatrix * modelMatrix * vec4(position,1);","    gl_Position = projectionMatrix * viewPosition;","    if(aIndex >= uIndex - uLength && aIndex < uIndex){","      vSize = uWidth * ((aIndex - uIndex + uLength) / uLength);","    }","    gl_PointSize = vSize;","}"].join(""),side:L,fragmentShader:["varying float vSize;","uniform vec3 uColor;","void main(){","    if(vSize<=0.0){","      gl_FragColor = vec4(1,0,0,0);","    }else{","      gl_FragColor = vec4(uColor,1);","    }","}"].join(""),transparent:!0,vertexColors:!1}),s=new b({uniforms:{uColor:{value:new C(a.pointColor)},uOpacity:{value:1},uSpeed:{value:.1},uSge:{value:4},uRadius:{value:a.pointWidth*a.factor/2},time:{value:0}},transparent:!0,depthTest:!1,vertexShader:["varying vec2 vUv;","void main() {","  vUv = uv;","  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(""),fragmentShader:["varying vec2 vUv;","uniform vec3 uColor;","uniform float uOpacity;","uniform float uSpeed;","uniform float uSge;","uniform float time;","float PI = 3.14159265;","float drawCircle(float index, float range) {","  float opacity = 1.0;","  if (index >= 1.0 - range) {","    opacity = 1.0 - (index - (1.0 - range)) / range;","  } else if(index <= range) {","    opacity = index / range;","  }","  return opacity;","}","float distanceTo(vec2 src, vec2 dst) {","  float dx = src.x - dst.x;","  float dy = src.y - dst.y;","  float dv = dx * dx + dy * dy;","  return sqrt(dv);","}","void main() {","  float iTime = -time * uSpeed;","  float opacity = 0.0;","  float len = distanceTo(vec2(0.5, 0.5), vec2(vUv.x, vUv.y));","  float size = 1.0 / uSge;","  vec2 range = vec2(0.65, 0.75);","  float index = mod(iTime + len, size);","  vec2 cRadius = vec2(0.06, 0.12);","  if (index < size && len <= 0.5) {","    float i = sin(index / size * PI);","    if (i >= range.x && i <= range.y){","      // 归一","      float t = (i - range.x) / (range.y - range.x);","      // 边缘锯齿范围","      float r = 0.3;","      opacity = drawCircle(t, r);","    }","    // 渐变","    opacity *=  1.0 - len / 0.5;","  };","  gl_FragColor = vec4(uColor, uOpacity * opacity);","}"].join("\n"),side:L})},i=()=>{const e=t,o=e.uniforms.uTotal.value;e.uniforms.uIndex.value+=a.speed,e.uniforms.uIndex.value>=o&&(e.uniforms.uIndex.value=0);const n=.001*performance.now();s.uniforms.time.value=n};return n(),{createFlywireTexture:n,createFlywire:e=>{const s=new g,n=o(e[0]),i=o(e[1]);s.add(n,i);const r=(e=>{const[t,s]=e[0],[o,n]=e[1];let{depth:i,height:r,factor:l,divisions:c}=a;r=(i+r)*l,i*=l;const p=new d(t,i,-s),g=new d(t+(o-t)/4,r,-(s+(n-s)/4)),u=new d(t+3*(o-t)/4,r,-(s+3*(n-s)/4)),m=new d(o,i,-n);return new G(p,g,u,m).getPoints(c)})(e),l=new R(r,!1,"centripetal",.5),c=new B(l,a.tubularSegments,a.radius,a.radialSegments,a.closed),p=new b({transparent:!0,opacity:1,depthTest:!1,vertexColors:!1,uniforms:{uColor:{value:new C(a.color)},uOpacity:{value:.6}},vertexShader:["varying vec3 vColor;","uniform vec3 uColor;","void main() {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join(""),fragmentShader:["uniform vec3 uColor;","uniform float uOpacity;","void main() {","  gl_FragColor = vec4(uColor, uOpacity);","}"].join("")}),u=new k(c,p);u.renderOrder=10;const m=(e=>{const s=new Float32Array(e.map(((e,t)=>t))),a=(new h).setFromPoints(e);return a.setAttribute("aIndex",new j(s,1)),new S(a,t)})(r);return s.add(u,m),s},update:i,flywireUpdate:i}})(),{createBar:Is}=((e={})=>{let t=Lt({height:10,size:2,factor:1,color1:1048575,color2:16777215},e);return{createBar:(e={},s={})=>{t=Lt(t,s);let{size:a,height:o,factor:n,color1:i,color2:r}=t;a*=n,o*=n,o*=e.heightRatio??n;const[l,c,p]=e.position||[0,0,0],d=new g,u=new x(a,a,o),m=new b({depthTest:!1,transparent:!0,vertexColors:!1,uniforms:{uColor1:{value:new C(i)},uColor2:{value:new C(r)},uOpacity:{value:.6}},vertexShader:"\n        varying vec3 vColor;\n        uniform vec3 uColor1;\n        uniform vec3 uColor2;\n        void main() {\n          float percent = (position.z + 0.0) / 100.0; // 计算当前像素点在立方体高度上的百分比\n          vColor = mix(uColor1.rgb, uColor2.rgb, percent);\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:"\n        varying vec3 vColor;\n        uniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(vColor, uOpacity);\n        }\n      "}),h=new k(u,m);if(d.add(h),d.name="柱状图",d.position.set(l,c,p+o/2),d.renderOrder=99,e.label){const{name:t="",className:s="",onClick:a}=e.label,n=rs({name:t,className:s,position:[0,0,o/2],onClick:a});n.rotateX(.5*Math.PI),d.add(n)}return d}}})(),As={x:105.06,y:0,z:32.93},Ls=new M;let Ps,Os,_s,zs,Us;const Rs=(e,t="/texttures")=>new URL(Object.assign({"../../assets/imgs/label.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAK+SURBVHgB7dzNbdswGIdxSugCRtGBuklWSO17nXs/J0hHywA11AEMu3wDsLFT5WCJ5PtI/D8nQ5cA/FmxJJLqtofhHBSmPihUAoElEFgCgfVu7ODX95suqOKNXVDpDIElEFgCgSUQWAKBJRBYAoE1G2Q3DJ/j9fRjUGE7DI+f4niEGc0CMYzzKezjx7vWUQwjnMJdF8djDsq8M+QYLu/om0VJGP8OXI/LTc0C+fJhs4/fiIeLQ82hvMaI/zEevsVxCROb/RvSMkpuDCvLVVaLKCUwrGyXvS2hlMKwst6HtIBSEsPKfmO4ZpTSGFaRO/U1otTAsIo9OlkTSi0Mq+izrDWg1MSwij9cXDJKbQyrytPeJaJ4YFjVHr8vCcULw6o6H7IEFE8Mq/oEFRnFG8NymTEkohAwLLcpXBIKBcNynVMnoJAwLPdFDp4oNAwLserEA4WIYXVjK7C9Vr+fY8Gh7e8/Lhha/f5GhDMjJRBYAoElEFgCgSUQWAKBJRBYAoElEFgCgSUQWAKBJRBYAoElEFgCgSUQWAKBJRBYAoElEFgCgSUQWAKBJZDwvIIQs2kIA/K81tYvzKYhBMh/75vyCYHiDgLBSLmjuIK8xrBV6J1HoO11biCk/Rmk7XUuIMTNMhSU6iDUnUsWAaUqCBkj5Y1SDWQJGClPlCogS8JIeaEUB1kiRsoDpSjIkjFStVGKgawBI1UTpQjImjBStVCyg6wRI1UDJSvImjFSpVGygbSAkSqJkgWkJYxUKZTZIC1ipEqgzAJpGSOVG2UyiDBeyokyCWR3OOyFcd0Yyu4wfA83Ngnk2Pe/ziE82WdhvHSJYuNz7MPPcGOTQH5sNk+nPnyMf/xeGNcZSvyS3tv42DiFG0O94q+19Iq/BSQQWAKBJRBYAoElEFgCgSUQWKM3hsovnSGwBAJLILAEAusvLK6Na4P/Au0AAAAASUVORK5CYII=","../../assets/imgs/sky/216/negX.jpeg":fe,"../../assets/imgs/sky/216/negY.jpeg":ve,"../../assets/imgs/sky/216/negZ.jpeg":ye,"../../assets/imgs/sky/216/posX.jpeg":we,"../../assets/imgs/sky/216/posY.jpeg":xe,"../../assets/imgs/sky/216/posZ.jpeg":be,"../../assets/imgs/sky/217/negX.jpeg":Ce,"../../assets/imgs/sky/217/negY.jpeg":ke,"../../assets/imgs/sky/217/negZ.jpeg":je,"../../assets/imgs/sky/217/posX.jpeg":Se,"../../assets/imgs/sky/217/posY.jpeg":Me,"../../assets/imgs/sky/217/posZ.jpeg":Ie,"../../assets/imgs/sky/218/negX.jpeg":Ae,"../../assets/imgs/sky/218/negY.jpeg":Le,"../../assets/imgs/sky/218/negZ.jpeg":Pe,"../../assets/imgs/sky/218/posX.jpeg":Oe,"../../assets/imgs/sky/218/posY.jpeg":_e,"../../assets/imgs/sky/218/posZ.jpeg":ze,"../../assets/imgs/sky/219/negX.jpeg":Ue,"../../assets/imgs/sky/219/negY.jpeg":Re,"../../assets/imgs/sky/219/negZ.jpeg":Be,"../../assets/imgs/sky/219/posX.jpeg":Ge,"../../assets/imgs/sky/219/posY.jpeg":Ee,"../../assets/imgs/sky/219/posZ.jpeg":Fe,"../../assets/imgs/sky/220/negX.jpeg":De,"../../assets/imgs/sky/220/negY.jpeg":Te,"../../assets/imgs/sky/220/negZ.jpeg":Ye,"../../assets/imgs/sky/220/posX.jpeg":Xe,"../../assets/imgs/sky/220/posY.jpeg":Je,"../../assets/imgs/sky/220/posZ.jpeg":We,"../../assets/imgs/sky/221/negX.jpeg":$e,"../../assets/imgs/sky/221/negY.jpeg":Ze,"../../assets/imgs/sky/221/negZ.jpeg":Ke,"../../assets/imgs/sky/221/posX.jpeg":Ne,"../../assets/imgs/sky/221/posY.jpeg":Ve,"../../assets/imgs/sky/221/posZ.jpeg":Qe,"../../assets/imgs/sky/222/negX.jpeg":He,"../../assets/imgs/sky/222/negY.jpeg":qe,"../../assets/imgs/sky/222/negZ.jpeg":et,"../../assets/imgs/sky/222/posX.jpeg":tt,"../../assets/imgs/sky/222/posY.jpeg":st,"../../assets/imgs/sky/222/posZ.jpeg":at,"../../assets/imgs/sky/223/negX.jpeg":ot,"../../assets/imgs/sky/223/negY.jpeg":nt,"../../assets/imgs/sky/223/negZ.jpeg":it,"../../assets/imgs/sky/223/posX.jpeg":rt,"../../assets/imgs/sky/223/posY.jpeg":lt,"../../assets/imgs/sky/223/posZ.jpeg":ct,"../../assets/imgs/sky/224/negX.jpeg":pt,"../../assets/imgs/sky/224/negY.jpeg":gt,"../../assets/imgs/sky/224/negZ.jpeg":dt,"../../assets/imgs/sky/224/posX.jpeg":ut,"../../assets/imgs/sky/224/posY.jpeg":mt,"../../assets/imgs/sky/224/posZ.jpeg":ht,"../../assets/imgs/sky/225/negX.jpeg":ft,"../../assets/imgs/sky/225/negY.jpeg":vt,"../../assets/imgs/sky/225/negZ.jpeg":yt,"../../assets/imgs/sky/225/posX.jpeg":wt,"../../assets/imgs/sky/225/posY.jpeg":xt,"../../assets/imgs/sky/225/posZ.jpeg":bt,"../../assets/imgs/sky/226/negX.jpeg":Ct,"../../assets/imgs/sky/226/negY.jpeg":kt,"../../assets/imgs/sky/226/negZ.jpeg":jt,"../../assets/imgs/sky/226/posX.jpeg":St,"../../assets/imgs/sky/226/posY.jpeg":Mt,"../../assets/imgs/sky/226/posZ.jpeg":It,"../../assets/imgs/texttures/arrow.png":Ut,"../../assets/imgs/texttures/border.png":Rt,"../../assets/imgs/texttures/circle.png":Bt,"../../assets/imgs/texttures/fenceMap0.png":Gt,"../../assets/imgs/texttures/fenceMap1.png":Et,"../../assets/imgs/texttures/fenceMap2.png":Ft,"../../assets/imgs/texttures/gz-map-fx.jpg":Dt,"../../assets/imgs/texttures/gz-map.jpg":Tt,"../../assets/imgs/texttures/inner-circle.png":Yt,"../../assets/imgs/texttures/lensflare0.png":Xt,"../../assets/imgs/texttures/lensflare0_alpha.png":Jt,"../../assets/imgs/texttures/lensflare1.png":Wt,"../../assets/imgs/texttures/lensflare2.png":$t,"../../assets/imgs/texttures/lensflare3.png":Zt,"../../assets/imgs/texttures/light.png":Kt,"../../assets/imgs/texttures/out-circle.png":Nt,"../../assets/imgs/texttures/point.png":Vt})[`../../assets/imgs${t}/${e}`],self.location).href,Bs=(e,t,s)=>t?Qt(t,s):e,Gs=(e,t)=>{const s=new X(t),a={depth:e.config.depth,bevelEnabled:!0,bevelSegments:1,bevelThickness:0,steps:0,bevelSize:0},o=new J(s,a),n=new W({color:e.color.main,map:Ps,normalMap:Os,combine:$,transparent:!0,opacity:.8}),i=new Z({color:cs.borderColor,map:_s,transparent:!0,opacity:.9}),r=new k(o,[n,i]);return r.scale.setScalar(e.config.scale),r.name="地图拼块",r},Es=Rs("label.png",""),Fs=(e,t,s)=>{if(!t.centroid&&!t.center)return!1;const{depth:a,scale:o}=e.config,[n,i]=t.centroid||t.center,r=gs({name:`\n      <img src="${Es}" />\n      <div class="name">${t.name}</div>\n    `,className:"map-3D-label",position:[n*o,i*o*.995,a*o]});r.rotateX(.5*Math.PI),r.name=t.name+"_CSS3D_label",r.isLabel=!0,s.add(r)},Ds=(e,t,s)=>{if(!t.centroid&&!t.center)return!1;const{depth:a,scale:o}=e.config,n=1+(i=5,r=10,(Math.floor(Math.random()*(r-i+1))+i)/4);var i,r;const[l,c]=t.centroid||t.center,p=ws([l,c,1.01*a].map((e=>e*o)),n*o,{factor:o,color:e.color.markColor1});p.rotateX(-Math.PI/2),s.add(p)},Ts=(e,t,s)=>{const{scale:a,depth:o}=e.config,n=new g,i=.2*a,r=new K(i,32),l=new A({color:cs.scatterColor1,transparent:!0,opacity:1}),c=new k(r,l),p=new N(.8*i,32,32,0,Math.PI),d=new A({color:cs.scatterColor2,transparent:!0,opacity:1}),u=new k(p,d);return n.add(c,u),n.position.set(t*a,s*a,o*a*1.005),n};class Ys extends _t{constructor(a,o={},n={},l,c){super(a),i(this,s),i(this,e,void 0),i(this,t,void 0),this.config=Lt(ls,o),this.color=Lt(cs,n),r(this,e,l),r(this,t,c),this.createClock(),this.css3DRender=ps(this.options,this.container),((e,t)=>{Ps=Ls.load(Bs(Rs("gz-map.jpg"),e.map.map,t)),Os=Ls.load(Bs(Rs("gz-map-fx.jpg"),e.map.normal,t)),_s=Ls.load(Bs(Rs("border.png"),e.map.side,t)),Ps.wrapS=Os.wrapS=_s.wrapS=Y,Ps.wrapT=Os.wrapT=_s.wrapT=Y,Ps.flipY=!1;const s=.0128;Ps.repeat.set(s,s),Os.repeat.set(s,s),zs=Ls.load(Bs(Rs("out-circle.png"),e.map.bgOutCircle,t)),Us=Ls.load(Bs(Rs("inner-circle.png"),e.map.bgInnerCircle,t))})(this.config,this.options.baseUrl),this.bindEvent()}addCorrugatedPlate(){this.corrugatedPlate&&(this.disposeObj(this.corrugatedPlate),this.corrugatedPlate=void 0);const e=fs({range:this.config.plateRadius,factor:this.config.scale,color:this.color.plateColor,light:this.color.plateLight});e.renderOrder=0,this.corrugatedPlate=e,this.addObject(e)}initMap(e){this.mapGroup&&(this.disposeObj(this.mapGroup),this.mapGroup=void 0);const t=new g;t.name="地图";const s=e.features,a=s.length;for(let c=0;c<a;c++){const e=s[c],a=new F,o=e.geometry.coordinates,n=e.properties;for(let t=0;t<o.length;t++)o[t].forEach((e=>{const t=e.map((e=>new D(e[0],e[1]))),s=Gs(this,t);s.isProvinceBlock=!0,a.add(s)}));this.config.areaLabel&&Fs(this,n,a),this.config.markLight&&Ds(this,n,a),a.rotateX(-Math.PI/2),a.isProvinceGroup=!0,a.name=n.name,a.data=n,t.add(a)}this.mapGroup=t,this.addObject(t),this.config.border&&((e,t)=>{let s=xs(t,{color:cs.line,transparent:!0},"Line2");const{depth:a,scale:o}=e.config;s.name="地图上边框",s.position.y+=a*o;let n=xs(t,{color:cs.line2},"Line2");n.name="地图下边框",s.scale.setScalar(o),n.scale.setScalar(o),e.scene.add(s),e.scene.add(n)})(this,e);const o=ys(t);if(!this.corrugatedPlate)return;let{size:n,center:{x:i,y:r,z:l}}=o;if(As.x=i,As.y=r,As.z=l,this.corrugatedPlate.position.set(i,0-.1*this.config.scale,l),this.resetSceneEle(),this.config.mapBg){const e=n.x<n.y?n.y+1:n.x+1;this.outRingMesh=((e,t)=>{let s=new I(t,t),a=new A({map:zs,transparent:!0,opacity:.6,depthTest:!0}),o=new k(s,a);const{x:n,z:i}=As;return o.position.set(n,-1,i),o.scale.setScalar(1.2),o.rotateX(.5*-Math.PI),e.add(o),o})(this.scene,e*this.config.bgOutFactor),this.innerRingMesh=((e,t)=>{let s=new I(t,t),a=new A({map:Us,transparent:!0,opacity:.3,depthTest:!0}),o=new k(s,a);const{x:n,z:i}=As;return o.position.set(n,-2,i),o.scale.setScalar(1.2),o.rotateX(.5*-Math.PI),e.add(o),o})(this.scene,e*this.config.bgInnerFactor)}}initMapOutLine(e){this.outline&&(this.disposeObj(this.outline),this.outline=void 0);const t=bs(e,this.config.depth,!1),s=Cs(t,{factor:this.config.scale,color:this.color.outline});s.renderOrder=10,this.outline=s,this.addObject(s)}initFlywire(e){this.flywireGroup&&(this.disposeObj(this.flywireGroup),this.flywireGroup=void 0);const{scale:t,depth:s}=this.config,a=this.color;js({depth:s,color:a.line,flyColor:a.flyColor2,pointColor:a.flyColor1,factor:t});const o=new g;for(let n=0;n<e.length;n++){const{coords:s,path:a}=e[n],i=Ss(s.map((e=>e.map((e=>e*t)))));i.name=a,o.add(i)}o.name="飞线集合",o.renderOrder=20,this.flywireGroup=o,this.addObject(o)}initMapBar(e,t){if(!this.config.mapBar)return;if(!this.mapGroup)return;this.clearMapBar();const s=Math.max(...e.map((e=>e.value||0))),{scale:a,depth:o}=this.config,n=this.color,i={height:5,size:.2,factor:a,color1:n.markColor1,color2:n.markColor2};for(let r=0;r<e.length;r++){const{name:n="",value:l=0}=e[r],c=this.mapGroup.getObjectByName(n);if(c){const n=l/s||0,{centroid:p,center:g}=c.data,d=p||g,u=Is({position:[d[0]*a,d[1]*a,o*a],heightRatio:n,label:t(e[r])},i);u.isBar=!0,c.add(u)}else;}}clearMapBar(){var e;null==(e=this.mapGroup)||e.traverse((e=>{e.isBar&&this.disposeObj(e)}))}initScatter(e){this.scatterGroup&&(this.disposeObj(this.scatterGroup),this.scatterGroup=void 0);const t=new g;t.name="散点集合";for(let s=0;s<e.length;s++){const a=e[s],[o=0,n=0]=a.coord||[],i=Ts(this,o,n);i.name=a.name,i.data=a,i.isScatter=!0,t.add(i)}t.rotateX(.5*-Math.PI),this.scatterGroup=t,this.addObject(t)}onDblclick(e){}onPointerDown(e){this.pointer.isClick=!0,this.pointer.tsp=e.timeStamp}onPointerMove(e){const t=this.container,o=this.options.scale;if(hs(e,t,o),this.mapGroup){ds.setFromCamera(us,this.camera);const e=[this.mapGroup];this.scatterGroup&&e.push(this.scatterGroup);const t=ds.intersectObjects(e);if(this.container.style.cursor=t.length?"pointer":"auto",t.length>0){const e=t[0].object;let o;const n=this.findParentGroupGroupUuid(e);n&&(o=n.uuid,l(this,s,a).call(this,n)),this.setMapBlockColor(o)}else l(this,s,a).call(this),this.setMapBlockColor()}}onPointerUp(e){this.pointer.isClick=!1;const t=e.timeStamp-this.pointer.tsp<(this.config.rightClickBackDiffTime||zt.rightClickBackDiffTime);2==e.button||(0==e.button?t&&this.clickObject(e):e.button)}findParentGroupGroupUuid(e){const t=e=>{let s=e.parent;if(s)return s&&s.isProvinceGroup||s.isScatter?s:t(s)};return t(e)}setMapBlockColor(e){var t;null==(t=this.mapGroup)||t.traverse((t=>{if(t.isProvinceBlock)t.material[0].color.set(t.parent.uuid===e?this.color.mainHover:this.color.main),t.material[1].color.set(t.parent.uuid===e?this.color.borderHoverColor:this.color.borderColor);else if(t.isLabel){const s=t.parent.uuid===e;t.element.className="map-3D-label"+(s?" is-active":"")}}))}clickObject(e){const s=this.container,a=this.options.scale;if(hs(e,s,a),this.scatterGroup){ds.setFromCamera(us,this.camera);const e=[this.scatterGroup],s=ds.intersectObjects(e);if(this.container.style.cursor=s.length?"pointer":"auto",s.length){const e=s[0].object,a=this.findParentGroupGroupUuid(e).data||{};"function"==typeof n(this,t)&&n(this,t).call(this,a)}}}resetSceneEle(){const{x:e,y:t,z:s}=As;if(this.camera.lookAt(e,t,s),new P(this.camera.position).to({x:e,y:90*this.config.scale,z:s+40*this.config.scale},1e3).easing(T.Quadratic.In).start().onUpdate((()=>{})),this.controls&&(this.controls.target=new d(e,t,s-5*this.config.scale)),this.grid){this.grid.position.set(e,0,s);const t=this.scene.getObjectByProperty("_isGridFork_",!0);t&&t.position.set(e,0,s)}}modelAnimate(){var e;let t=null==(e=this.clock)?void 0:e.getDelta();this.corrugatedPlate&&vs(this.corrugatedPlate,t),this.css3DRender&&this.css3DRender.render(this.scene,this.camera),_s&&(_s.offset.y+=.005),this.outRingMesh&&(this.outRingMesh.rotation.z+=5e-4),this.innerRingMesh&&(this.innerRingMesh.rotation.z-=5e-4),this.outline&&ks(this.outline),this.flywireGroup&&Ms()}resize(){if(super.resize(),this.css3DRender){const{width:e,height:t}=this.options;this.css3DRender.setSize(e,t)}}dispose(){this.disposeObj(this.corrugatedPlate),this.disposeObj(this.mapGroup),this.disposeObj(this.scatterGroup),this.disposeObj(this.flywireGroup),this.disposeObj(this.outline),this.disposeObj(this.outRingMesh),this.disposeObj(this.innerRingMesh),this.clock=void 0,this.css3DRender=void 0,this.corrugatedPlate=void 0,this.mapGroup=void 0,this.scatterGroup=void 0,this.flywireGroup=void 0,this.outline=void 0,this.outRingMesh=void 0,this.innerRingMesh=void 0,super.dispose()}}e=new WeakMap,t=new WeakMap,s=new WeakSet,a=function(t){"function"==typeof n(this,e)&&n(this,e).call(this,t,ms)};const Xs=ts(V({__name:"index",props:{devEnv:{type:Boolean},baseUrl:{},bgColor:{},skyCode:{},bgUrl:{},env:{},scale:{},camera:{default:()=>({})},cruise:{default:()=>({})},fog:{default:()=>({})},render:{default:()=>({})},controls:{default:()=>({})},grid:{default:()=>({})},axes:{default:()=>({})},directionalLight:{},color:{default:()=>({})},config:{default:()=>({})},corrugatedPlate:{type:Boolean,default:!0},mapJson:{},outlineJson:{},flywire:{},barList:{},scatters:{},barLabelRender:{}},emits:["init","click"],setup(e,{expose:t,emit:s}){const{backgroundLoad:a,skys:o}=Ht(),{transformGeoJSON:n}={transformGeoJSON:e=>{let t=e.features;for(let s=0;s<t.length;s++){const e=t[s];"Polygon"===e.geometry.type&&(e.geometry.coordinates=[e.geometry.coordinates])}return e}},{show:i,dialog:r}=qt({style:{left:"0px",top:"0px"},extend:{}}),l=e,c=Q(),p=s;H((()=>l.scale),(e=>{null==u||u.setScale(e||1)})),H((()=>l.mapJson),(e=>{e&&(null==u||u.initMap(n(e)))})),H((()=>l.outlineJson),(e=>{e&&(null==u||u.initMapOutLine(n(e)),l.barList&&(null==u||u.initMapBar(l.barList||[],g)))})),H((()=>l.flywire),(e=>{null==u||u.initFlywire(e||[])})),H((()=>l.barList),(e=>{null==u||u.initMapBar(e||[],g)})),H((()=>l.scatters),(e=>{null==u||u.initScatter(e||[])}));const g=e=>{if("function"==typeof l.barLabelRender)return l.barLabelRender(e);const{name:t="",value:s=0,unit:a=""}=e;return{name:`\n      <div class="label-wrap">\n        <div class="name">${t}</div>\n        <div class="text">\n          <span class="value">${es(s)}</span>\n          <span class="unit">${a}</span>\n        </div>\n      </div>\n    `,className:"map-bar-label"}},d={baseUrl:l.baseUrl,bgUrl:l.bgUrl,env:l.env,bgColor:l.bgColor,camera:l.camera,cruise:l.cruise,fog:l.fog,render:l.render,grid:l.grid,controls:l.controls,axes:l.axes};let u;return q((()=>{d.container=c.value,u=new Ys(d,l.config,l.color,((e,t)=>{let s=!!e;if(s){r.style&&(r.style.left=t.left+"px",r.style.top=t.top+"px");const a=e.isScatter,o=e.data;if(a)o.isScatter=!0,r.extend=o;else{const t=(l.barList||[]).find((t=>t.name==e.name));t?r.extend=t:s=!1}}i.value=s}),(e=>{p("click",ee(e))})),u.run(),p("init",u),l.skyCode&&a(u,l.skyCode),l.corrugatedPlate&&(null==u||u.addCorrugatedPlate()),l.flywire&&l.flywire.length&&(null==u||u.initFlywire(l.flywire))})),t({exportImage:()=>null==u?void 0:u.exportImage()}),(e,t)=>(te(),se("div",{class:oe(e.$style["map-scene"])},[ae("div",{class:oe(e.$style.container),ref_key:"containerRef",ref:c},null,2),ne(i)?(te(),se("div",{key:0,class:oe(e.$style["dialog-view"]),style:ie(ne(r).style)},[re(e.$slots,"dialog",{data:ne(r).extend})],6)):le("",!0)],2))}}),[["__cssModules",{$style:{"map-scene":"_map-scene_5opvk_2",container:"_container_5opvk_8","dialog-view":"_dialog-view_5opvk_12"}}]]),Js={depth:2,scale:40,plateRadius:100},Ws={main:3377879,mainHover:9633791,borderColor:9633791,borderHoverColor:1066618,light:1066618,lightHover:9633791,plateColor:3377879,plateLight:1066618,line:9559027,line2:6421501,gridColor:663606,gridFork:927811,outline:11856636,markColor1:13303807,markColor2:6945023,flyColor1:9559027,flyColor2:6421501,scatterColor1:9559027,scatterColor2:6421501},$s=["src"],Zs=ts(V({__name:"index",setup(e){const{load:t}=At.useFileLoader(),s=Q(),a=ce({devEnv:!0,baseUrl:"",bgColor:464681,color:Ws,config:{...Js,areaLabel:!0,markLight:!0,map:{}},camera:{position:[0,100,200]},directionalLight:{helper:!0},fog:{visible:!1,near:2e3,far:3e3},render:{preserveDrawingBuffer:!0},grid:{visible:!0,gridColor:Ws.gridColor,centerLineColor:Ws.gridColor,fork:!0,divisions:40,width:2*Js.plateRadius*Js.scale,forkSize:1.4*Js.scale,forkColor:Ws.gridFork},controls:{maxPolarAngle:.46*Math.PI,maxDistance:5e3,enableDamping:!0,screenSpacePanning:!1},axes:{visible:!0},mapJson:null,outlineJson:null,flywire:[],barList:[],scatters:[]}),o=()=>{var e;return null==(e=s.value)?void 0:e.exportImage()},n=e=>{const s=a.baseUrl;t(`${s}/oss/map/china.json`).then((e=>{a.mapJson=e})),t(`${s}/oss/map/china-outline.json`).then((e=>{a.outlineJson=e})),ns(e).resize()},i=e=>{me.info({message:e.name,grouping:!0})},r=e=>{const{name:t="",value:s=0,unit:a=""}=e;return{name:`\n      <div class="label-wrap">\n        <div class="name">${t}</div>\n        <div class="text">\n          <span class="value">${os(s)}</span>\n          <span class="unit">${a}</span>\n        </div>\n      </div>\n    `,className:"map-bar-label"}},l=()=>{ss.get(as.d3.map).then((e=>{const t=[],s=[];return e.list.forEach((e=>{const a=e.projects.length;let o=e.province;["重庆","北京","天津","上海"].includes(o)&&(o+="市"),["台湾"].includes(o)&&(o+="省"),e.projects.forEach((s=>{t.push({coord:[s.lng,s.lat],name:s.name,carbon:s.carbon,value:s.use,total:a,city:e.province,id:s.id})}));const n=e.total;-1===s.findIndex((e=>e.name===o))&&s.push({id:e.code,name:o,total:a,value:n,unit:"kWh"})})),{citys:s,projects:t,lines:e.lines}})).then((e=>{a.flywire=e.lines,a.barList=e.citys,a.scatters=e.projects}))};return q((()=>{l()})),(e,t)=>{const l=he;return te(),se("div",{class:oe([e.$style.page,"h-100 o-h"])},[ae("div",{class:oe(e.$style.operate)},[pe(l,{type:"primary",size:"small",onClick:o},{default:ge((()=>t[0]||(t[0]=[de("导出")]))),_:1})],2),pe(Xs,{ref_key:"threeSceneRef",ref:s,"dev-env":ne(a).devEnv,"base-url":ne(a).baseUrl,"bg-color":ne(a).bgColor,"bg-url":ne(a).bgUrl,env:ne(a).env,"sky-code":ne(a).skyCode,camera:ne(a).camera,cruise:ne(a).cruise,render:ne(a).render,controls:ne(a).controls,"directional-light":ne(a).directionalLight,grid:ne(a).grid,axes:ne(a).axes,config:ne(a).config,color:ne(a).color,"map-json":ne(a).mapJson,"outline-json":ne(a).outlineJson,flywire:ne(a).flywire,"bar-list":ne(a).barList,scatters:ne(a).scatters,"bar-label-render":r,onInit:n,onClick:i},{dialog:ge((({data:s})=>[ae("div",{class:oe(e.$style["dialog-view"])},[ae("div",{class:oe([e.$style.city,"flex"])},[ae("span",{class:oe(e.$style.name)},ue(s.isScatter?s.city:s.name),3),ae("span",{class:oe(e.$style.total)},ue(s.total)+"个项目",3)],2),s.isScatter?(te(),se("div",{key:0,class:oe([e.$style.project,"flex flex-ac"])},[ae("img",{src:`${ne(a).baseUrl}/oss/img/map/pos.png`,alt:""},null,8,$s),ae("span",{class:oe(e.$style.name)},ue(s.name),3)],2)):le("",!0),ae("div",{class:oe(e.$style.count)},[ae("div",{class:oe(e.$style.item)},[t[1]||(t[1]=ae("span",null,"今日用电量",-1)),ae("span",null,ue(ne(os)(s.value)),1),t[2]||(t[2]=ae("span",null,"kWh",-1))],2),s.isScatter?(te(),se("div",{key:0,class:oe(e.$style.item)},[t[3]||(t[3]=ae("span",null,"今日碳排放",-1)),ae("span",null,ue(ne(os)(s.carbon)),1),t[4]||(t[4]=ae("span",null,"kgCO₂",-1))],2)):le("",!0)],2)],2)])),_:1},8,["dev-env","base-url","bg-color","bg-url","env","sky-code","camera","cruise","render","controls","directional-light","grid","axes","config","color","map-json","outline-json","flywire","bar-list","scatters"])],2)}}}),[["__cssModules",{$style:{page:"_page_dcgzt_2",operate:"_operate_dcgzt_8","dialog-view":"_dialog-view_dcgzt_15",city:"_city_dcgzt_20",name:"_name_dcgzt_20",total:"_total_dcgzt_28",project:"_project_dcgzt_33",count:"_count_dcgzt_48",item:"_item_dcgzt_52"}}]]);export{Zs as default};
