var t=Object.defineProperty,i=(i,e,n)=>(((i,e,n)=>{e in i?t(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n})(i,"symbol"!=typeof e?e+"":e,n),n);import{ba as e,bc as n,aW as s,ch as o,bj as r,bf as a,bg as h,b1 as c,aX as l,aY as d,aZ as p,be as b,bb as m,af as g}from"./vendor-e5aa4d71.js";const f=t=>((t,i)=>Object.prototype.toString.call(i)===`[object ${t}]`)("Object",t),w=(t,i=new Map)=>{if(null!=t&&f(t)){let e=i.get(t);if(e)return e;const n=Array.isArray(t);let s=n?[]:{};return e=i.set(t,s),n?t.forEach(((t,i)=>{s[i]=w(t,e)})):Object.keys(t).forEach((i=>{f(s[i])?s[i]=w(t[i],e):s[i]=t[i]})),s}return t},u=(t,i)=>{t=w(t);for(let e in i)e in t&&f(i[e])&&f(t[e])?t[e]=u(t[e],i[e]):t[e]=i[e];return t},y={container:document.body,width:window.innerWidth,height:window.innerHeight,bgColor:null,fog:{visible:!1,near:100,far:1e3},controls:{visible:!0,enableDamping:!1,dampingFactor:.25,autoRotate:!1,enableZoom:!0,enablePan:!0,screenSpacePanning:!0,minDistance:1,maxDistance:2e3},lightHelperVisible:!1,ambientLight:{visible:!0,color:16777215,intensity:1.5},directionalLight:{visible:!0,light2:!0,color:16777215,intensity:1.5},camera:{near:1,far:1e4,position:[-350,510,700]},grid:{visible:!1,opacity:.3,transparent:!0},axes:{visible:!1,size:50}};class v{constructor(t={}){i(this,"options"),i(this,"container"),i(this,"scene"),i(this,"renderer"),i(this,"camera"),i(this,"controls"),i(this,"animationId"),i(this,"clear",(t=>{t&&t.traverse&&(t.traverse((t=>{t.material&&t.material.dispose(),t.geometry&&t.geometry.dispose(),null==t||t.clear()})),null==t||t.clear())}));const n=y;var s;this.options=u(n,t),(s=this.options.container)&&("object"==typeof HTMLElement?s instanceof HTMLElement:s&&"object"==typeof s&&1===s.nodeType&&"string"==typeof s.nodeName)?this.container=this.options.container:this.container=document.querySelector(this.options.container),this.options.width=this.container.offsetWidth,this.options.height=this.container.offsetHeight,this.scene=new e,this.renderer=this.initRenderer(),this.init(),this.camera=this.initCamera(),this.controls=this.initControls()}init(){this.initLight(),this.initGrid(),this.initAxes(),this.initModel()}run(){this.loop()}loop(){this.animationId=window.requestAnimationFrame((()=>{this.loop()})),this.animate(),this.modelAnimate()}animate(){this.renderer&&this.renderer.render(this.scene,this.camera),this.options.controls.visible&&this.controls.update(),n()}initModel(){}modelAnimate(){}initRenderer(){const{width:t,height:i,bgColor:e}=this.options,n=new s({antialias:!0});if(this.setBgColor(e),this.options.fog.visible){const{color:t,near:i,far:e}=this.options.fog;this.scene.fog=new o(t??this.scene.background,i,e)}return n.shadowMap.enabled=!0,n.shadowMap.type=r,n.setSize(t,i),n.setPixelRatio(window.devicePixelRatio),this.container.appendChild(n.domElement),n}initLight(){const{ambientLight:t,directionalLight:i,lightHelperVisible:e}=this.options;if(t.visible){const i=new a(t.color,t.intensity);this.addObject(i)}if(i.visible){const t=this.createDirectionalLight();if(this.addObject(t),e){const i=new h(t,1);this.addObject(i)}if(i.light2){const t=this.createDirectionalLight(!1);if(t.position.set(-500,800,-800),this.addObject(t),e){const i=new h(t,1);this.addObject(i)}}}}createDirectionalLight(t=!0,i=800,e=4096,n=1,s=2e3){const{color:o,intensity:r}=this.options.directionalLight,a=new c(o,r);if(a.position.set(500,800,800),t){a.shadow.mapSize.setScalar(e),a.shadow.bias=1e-5,a.shadow.normalBias=.01,a.castShadow=t;const o=a.shadow.camera;o.radius=10,o.near=n,o.far=s,o.top=o.right=i,o.left=o.bottom=-i,o.updateProjectionMatrix()}return a}initCamera(){const{width:t,height:i,camera:e}=this.options,n=new l(36,t/i,e.near,e.far);return n.position.set(...e.position),this.addObject(n),n}initControls(){const t=this.options.controls;if(!t.visible)return;const i=new d(this.camera,this.renderer.domElement);return Object.keys(t).forEach((e=>{i[e]=t[e]})),i.target.set(0,0,0),i}initGrid(){const t=this.options.grid;if(!t.visible)return;let i=new p(800,80,10592673,10592673);i.material.opacity=t.opacity,i.material.transparent=t.transparent,this.addObject(i)}initAxes(){if(!this.options.axes.visible)return;let t=new b(this.options.axes.size);this.addObject(t)}setBgColor(t){this.scene.background=t?new m(t):null}addObject(t){Array.isArray(t)?this.scene.add(...t):this.scene.add(t)}resize(){if(!this.camera)return;this.options.width=this.container.offsetWidth||window.innerWidth,this.options.height=this.container.offsetHeight||window.innerHeight;const{width:t,height:i}=this.options,e=t/i;this.camera.aspect=e,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,i)}stopAnimate(){window.cancelAnimationFrame(this.animationId)}dispose(){try{this.scene.clear(),this.renderer.dispose(),this.renderer.forceContextLoss(),this.renderer.content=null;let t=this.renderer.domElement.getContext("webgl");t&&t.getExtension("WEBGL_lose_context").loseContext()}catch(t){}}}const j=t=>({resize:()=>{const i=()=>null==t?void 0:t.resize();window.addEventListener("resize",i,!1),g((()=>{null==t||t.stopAnimate(),null==t||t.dispose(),window.removeEventListener("resize",i)}))}});export{v as T,j as u};
