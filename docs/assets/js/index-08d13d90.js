var e=Object.defineProperty,s=(s,a,o)=>(((s,a,o)=>{a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[a]=o})(s,"symbol"!=typeof a?a+"":a,o),o);import{t as a}from"./index-9841f34b.js";import{D as o,p as t,u as n,n as r}from"./scene-resize-83c18528.js";import{eZ as i,bk as l,bc as d,eE as c,e_ as u,eF as m,e as h,Y as p,i as g,l as v,o as b,g as y,h as f,q as w,u as x}from"./vendor-08e99294.js";import"./index-a5d3af4f.js";const{uniform:M,color:j,atan:P,PI2:_,Fn:I,If:z,positionLocal:k,output:C,frontFacing:E,vec4:N}=m,S=new i({metalness:.5,roughness:.25,envMapIntensity:.5,color:"#858080"}),V=new i({metalness:.5,roughness:.25,envMapIntensity:.5,color:"#858080",side:l}),D=M(1.75),F=M(1.25),G=M(j("#b62f58")),L=I((([e,s,a])=>{const o=P(e.y,e.x).sub(s).mod(_).toVar();return o.greaterThan(0).and(o.lessThan(a))}));V.outputNode=I((()=>{L(k.xy,D,F).discard();const e=C;return z(E.not(),(()=>{e.assign(N(G,1))})),e}))(),V.castShadowNode=I((()=>(L(k.xy,D,F).discard(),N(0,0,0,1))))();class O extends o{constructor(e){super(e),s(this,"gui");const a=this.createGround(1e3,1e3,11184810);this.addObject(a),this.gui=new d,this.addGui()}render(){this.renderer.renderAsync(this.scene,this.camera)}createRender(){return new c}setEnv(e){e.mapping=u,this.scene.environment=e,this.scene.background=this.scene.environment}addModel(e){e.traverse((e=>{e.isMesh&&("outerHull"===e.name?e.material=V:e.material=S,e.castShadow=!0,e.receiveShadow=!0)})),console.log(e),this.addObject(e)}addGui(){var e;const s=this.gui;s.add(D,"value",-Math.PI,Math.PI,.001).name("开始位置"),s.add(F,"value",0,2*Math.PI,.001).name("角度"),s.addColor({color:G.value.getHex()},"color").onChange((e=>G.value.set(e))),s.domElement.className+=" gui-wrap",null==(e=this.container.parentNode)||e.appendChild(s.domElement)}}const R={class:"three-page"},U=h({__name:"index",setup(e){const s=p({base:"",models:[{key:"gears",name:"齿轮",size:.07,url:"/oss/model/gpu/gears.glb"}],objects:[{type:"gears",name:"齿轮",position:{x:0,y:150,z:0},scale:{x:50,y:50,z:50}}]}),{progress:o,loadModels:i,initModels:l,getModel:d}=t.useModelLoader({baseUrl:s.base,indexDB:{}}),c=g(),u={baseUrl:s.base,env:"/oss/textures/hdr/8.hdr",directionalLight:{intensity:4}};let m;return v((()=>{u.container=c.value,m=new O(u).run(),n(m).resize(),i(s.models,(()=>{o.percentage=100,o.show=!1,l(s.objects,(e=>{const{type:s}=e,a=d(s);if(!a)return Promise.resolve();console.log(a);let o=r.modelDeepClone(a);const{position:t,scale:n,rotation:i}=r.get_P_S_R_param(o,e),[l,c,u]=t;return o.scale.set(...n),o.position.set(l,c,u),o.rotation.set(...i),m.addModel(o),Promise.resolve()}))}))})),(e,s)=>(b(),y("div",R,[f("div",{class:"h-100",ref_key:"containerRef",ref:c},null,512),w(a,{modelValue:x(o).show,"onUpdate:modelValue":s[0]||(s[0]=e=>x(o).show=e),progress:x(o).percentage},null,8,["modelValue","progress"])]))}});export{U as default};
//# sourceMappingURL=index-08d13d90.js.map
