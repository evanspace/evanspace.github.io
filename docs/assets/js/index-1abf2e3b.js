var e=Object.defineProperty,t=(t,s,a)=>(((t,s,a)=>{s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a})(t,"symbol"!=typeof s?s+"":s,a),a);import{m as s,s as a,u as n}from"./scene-resize-8ac40260.js";import{bh as o,cT as i,bf as r,cU as c,cV as l,cW as h,e as d,i as m,l as u,o as b,g as p,h as v,I as f,n as M}from"./vendor-29458cef.js";import{_ as j}from"./index-c9e1fac8.js";const y=a,{insertEvent:E,destroyEvent:w}=y.useKeyboardState(),{pointer:_,update:g,raycaster:S}=y.useRaycaster();class k extends s{constructor(e){super(e),t(this,"enableSelection",!1),t(this,"select",new o),t(this,"objects",[]),this.addObject(this.select),this.addModel(),this.container.addEventListener("click",this.onClick.bind(this))}addModel(){this.objects=[];const e=new i;for(let t=0;t<200;t++){const t=new r(e,new c({color:16777215*Math.random()}));t.position.set(300*Math.random()-150,150*Math.random()-75,200*Math.random()-100),t.rotation.set(2*Math.random()*Math.PI,2*Math.random()*Math.PI,2*Math.random()*Math.PI),t.scale.set(20*Math.random()+10,20*Math.random()+10,20*Math.random()+10),t.castShadow=!0,t.receiveShadow=!0,this.objects.push(t),this.addObject(t)}this.controls&&(this.controls.objects=[...this.objects])}createConstrols(){const e=new l([],this.camera,this.renderer.domElement);return e.addEventListener("dragstart",(e=>{})),e.addEventListener("dragend",(e=>{})),e.addEventListener("hoveron",(e=>{})),e.addEventListener("hoveroff",(e=>{})),E((e=>{var t;if(this.enableSelection=16===e.keyCode,77===e.keyCode){if(!this.controls)return;this.controls.touches.ONE=(null==(t=this.controls)?void 0:t.touches.ONE)===h.PAN?h.ROTATE:h.PAN}}),(()=>{this.enableSelection=!1})),e}onClick(e){var t;if(this.enableSelection){const s=null==(t=this.controls)?void 0:t.objects;s.length=0,g(e,this.container),S.setFromCamera(_,this.camera);const a=this.objects,n=S.intersectObjects(a,!0);if(n.length>0){const e=n[0].object;this.select.children.includes(e)?(e.material.emissive.set(0),this.scene.attach(e)):(e.material.emissive.set(11184810),this.select.attach(e)),this.controls.transformGroup=!0,s.push(this.select)}0===this.select.children.length&&(this.controls.transformGroup=!1,s.push(...a))}}dispose(){w(),super.dispose()}}const C={class:"three-page"},O=j(d({__name:"index",setup(e){const t=m(),s={axes:{visible:!0},camera:{position:[0,0,400]}};let a;return u((()=>{s.container=t.value,a=new k(s).run(),n(a).resize()})),(e,s)=>(b(),p("div",C,[v("div",{class:"h-100",ref_key:"containerRef",ref:t},null,512),v("div",{class:M(e.$style.tip)},s[0]||(s[0]=[f(" 使用“Shift+Click”向组添加对象或从组中删除对象"),v("br",null,null,-1),f(" 使用“M”在旋转和平移模式之间切换（仅限触摸）"),v("br",null,null,-1),f(" 分组对象可以转换为联合。 ")]),2)]))}}),[["__cssModules",{$style:{tip:"_tip_2m92f_2"}}]]);export{O as default};
