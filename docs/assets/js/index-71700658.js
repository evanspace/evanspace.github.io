var e=Object.defineProperty,s=(s,t,o)=>(((s,t,o)=>{t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[t]=o})(s,"symbol"!=typeof t?t+"":t,o),o);import{eB as t,eC as o,eD as a,bc as n,eE as r,eF as i,e as d,Y as l,i as c,l as p,o as u,g as m,h}from"./vendor-750afcd3.js";import{I as g,m as v,u as b,n as f}from"./scene-resize-8cf31fff.js";import"./index-617d5fb6.js";const{pass:_,mrt:x,output:y,emissive:j}=i;class w extends g{constructor(e){super(e),s(this,"gui"),s(this,"postProcessing");const r=_(this.scene,this.camera);r.setMRT(x({output:y,emissive:j}));const i=r.getTextureNode(),d=r.getTextureNode("emissive"),l=t(d,2.5,.5);this.renderer.toneMapping=o;const c=new a(this.renderer);c.outputNode=i.add(l),this.postProcessing=c,this.gui=new n,this.addGui(l)}setEnv(e){this.scene.environment=e,this.scene.background=e}createRender(){return new r}addGui(e){var s;const t=this.gui,o=t.addFolder("发光");o.add(e.threshold,"value",0,1).step(.01).name("阈值/起点"),o.add(e.strength,"value",0,3).step(.01).name("强度"),o.add(e.radius,"value",0,1).step(.01).name("半径"),o.open();const a=t.addFolder("色调映射");a.add(this.renderer,"toneMappingExposure",.1,3).name("曝光"),a.open(),t.domElement.className+=" gui-wrap",null==(s=this.container.parentNode)||s.appendChild(t.domElement)}animate(){this.postProcessing.renderAsync()}}const M={class:"three-page"},P=d({__name:"index",setup(e){const s=l({base:"",models:[{key:"helmet",name:"头盔",size:3.4,url:"/oss/model/gpu/头盔.glb"}],objects:[{type:"helmet",name:"头盔"}]}),{progress:t,loadModels:o,getModel:a,initModels:n}=v.useModelLoader({baseUrl:s.base}),r=c(),i={baseUrl:s.base,env:"/oss/textures/hdr/moonless_golf_1k.hdr",camera:{position:[0,0,10]}};let d;return p((()=>{i.container=r.value,d=new w(i).run(),b(d).resize(),o(s.models,(()=>{t.percentage=100,t.show=!1,n(s.objects,(e=>{const{type:s}=e,t=a(s);if(!t)return Promise.resolve();let o=f.modelDeepClone(t);const{position:n,scale:r,rotation:i}=f.get_P_S_R_param(o,e),[l,c,p]=n;return o.scale.set(...r),o.position.set(l,c,p),o.rotation.set(...i),d.addObject(o),Promise.resolve()}))}))})),(e,s)=>(u(),m("div",M,[h("div",{class:"h-100",ref_key:"containerRef",ref:r},null,512)]))}});export{P as default};
