import{e8 as e,e9 as a,ea as t,eb as n,c as o,h as i,ec as s,dl as r,X as l,k as d,ae as c,o as m,f as u,g as h,ed as p,ee as g,ef as w,bx as f,bt as x,bu as v,bv as C,bw as y,eg as b,dG as E,db as S,di as z,bA as P,dg as M}from"./vendor-d07051c1.js";const D={class:"page h-100"},G=o({__name:"index",setup(o){const G=i(),W=new s;let A,F,R,_;W.background=new r("#fff");const k=()=>{_=new p(16777215,1.5),W.add(_),((e=16777215,a=1,t=800,o=2048,i=1,s=2e3)=>{const r=new n(e,a);r.position.set(500,800,500),r.castShadow=!0,r.shadow.camera.near=i,r.shadow.camera.far=s,r.shadow.camera.right=t,r.shadow.camera.left=-t,r.shadow.camera.top=t,r.shadow.camera.bottom=-t,r.shadow.mapSize.set(o,o)})(16777215,1.5)},H=()=>{const e=G.value;if(!A)return;const a=e.clientWidth,t=e.clientHeight,n=a/t;A.aspect=n,A.updateProjectionMatrix(),F.setSize(a,t)};let L;const j=()=>{L=requestAnimationFrame(j),I(),F.render(W,A)},I=()=>{let e=.001*performance.now();Q.position.y=20*Math.sin(e)+5,Q.rotation.x=.5*e,Q.rotation.z=.51*e,B.material.uniforms.time.value+=1/60},T=l({turbidity:10,rayleigh:2,mieCoefficient:.005,mieDirectionalG:.2,elevation:2,azimuth:180,exposure:null});let q;let B;const N=()=>{const e=new x(1e4,1e4);B=new v(e,{textureWidth:512,textureHeight:512,waterNormals:(new C).load("https://ye6.atomgit.net/3d-demo-data/textures/waternormals.jpg",(e=>{e.wrapS=e.wrapT=y})),sunDirection:new f,sunColor:16777215,waterColor:7695,distortionScale:3.7,fog:void 0!==W.fog}),B.rotation.x=-Math.PI/2,W.add(B)};let X;const J=()=>{X=new b,X.scale.setScalar(1e4),W.add(X)};let K;const O=()=>{const e=X.material.uniforms;e.turbidity.value=T.turbidity,e.rayleigh.value=T.rayleigh,e.mieCoefficient.value=T.mieCoefficient,e.mieDirectionalG.value=T.mieDirectionalG;const a=E.degToRad(90-T.elevation),t=E.degToRad(T.azimuth);K.setFromSphericalCoords(1,a,t),X.material.uniforms.sunPosition.value.copy(K),B.material.uniforms.sunDirection.value.copy(K).normalize(),W.environment=q.fromScene(X).texture,F.toneMappingExposure=T.exposure};let Q;const U=()=>{let e=new S(30,30,30),a=new z({roughness:0,color:1365});Q=new P(e,a),W.add(Q)},V=()=>{const n=G.value;F=(a=>{const t=a.clientWidth,n=a.clientHeight,o=new e({antialias:!0});return o.setSize(t,n),o.setPixelRatio(window.devicePixelRatio),a.appendChild(o.domElement),o})(n),A=((e,t=.1,n=1e4)=>{const o=e.clientWidth,i=e.clientHeight,s=new a(36,o/i,t,n);return s.position.set(-350,510,700),s})(n,1,1e6),k(),R=((e,a)=>{const n=new t(e,a.domElement);return n.minDistance=.1,n.maxPolarAngle=.495*Math.PI*1.1,n.target.set(0,20,0),n})(A,F),R.maxPolarAngle=.45*Math.PI,R.screenSpacePanning=!1,N(),J(),F.toneMapping=g,F.toneMappingExposure=1,T.exposure=F.toneMappingExposure,q=new w(F),K=new f,O(),U(),(e=>{const a=new M,t=a.addFolder("Sky");t.add(T,"turbidity",0,100,.1).name("浑浊").onChange(O),t.add(T,"rayleigh",0,4,.001).name("锐利").onChange(O),t.add(T,"mieCoefficient",0,.1,.001).name("散射系数").onChange(O),t.add(T,"mieDirectionalG",0,1,.001).name("方向").onChange(O),t.add(T,"elevation",0,90,.1).name("高度").onChange(O),t.add(T,"azimuth",-180,180,.1).name("方位").onChange(O),t.add(T,"exposure",0,1,1e-4).name("光晕强度").onChange(O);const n=a.addFolder("Water"),o=B.material.uniforms;n.add(o.distortionScale,"value",0,100,.1).name("变形尺度"),n.add(o.size,"value",.1,10,.1).name("大小"),a.domElement.style="position: absolute; top: 10px; right: 10px",e.appendChild(a.domElement)})(n)};return d((()=>{V(),j(),window.addEventListener("resize",H,!1)})),c((()=>{window.addEventListener("resize",H,!1),cancelAnimationFrame(L);try{W.clear(),F.dispose(),F.forceContextLoss(),F.content=null;let e=F.domElement.getContext("webgl");e&&e.getExtension("WEBGL_lose_context").loseContext()}catch(e){console.log(e)}})),(e,a)=>(m(),u("div",D,[h("div",{ref_key:"containerRef",ref:G,class:"container h-100",style:{position:"relative"}},null,512)]))}});export{G as default};
