{"version":3,"file":"index-f0e8256b.js","sources":["../../../code/src/pages/webgl/light/shadow/methods.ts","../../../code/src/pages/webgl/light/shadow/index.vue"],"sourcesContent":["import * as THREE from 'three'\nimport * as ThreeScene from 'three-scene'\n\nimport { GUI } from 'dat.gui'\n\nexport class ShadowScene extends ThreeScene.Scene {\n  gui: InstanceType<typeof GUI>\n  directionalLight = new THREE.DirectionalLight()\n\n  constructor(options: ConstructorParameters<typeof ThreeScene.Scene>[0]) {\n    super(options)\n\n    const ground = this.createGround(1000, 1000, 0xffffff)\n    this.addObject(ground)\n\n    this.addModel()\n\n    this.gui = new GUI()\n    this.addGui()\n  }\n\n  createDirectionalLight(color: string | number, intensity: number) {\n    const light = new THREE.DirectionalLight(color, intensity)\n    this.directionalLight = light\n    return light\n  }\n\n  addModel() {\n    const geometries = [\n      new THREE.BoxGeometry(4, 4, 4),\n      new THREE.IcosahedronGeometry(3),\n      new THREE.TorusKnotGeometry(4, 0.5, 256, 24, 1, 3)\n    ]\n\n    const material = new THREE.MeshNormalMaterial()\n\n    for (let i = 0, l = geometries.length; i < l; i++) {\n      const angle = (i / l) * Math.PI * 2\n\n      const geometry = geometries[i]\n      const mesh = new THREE.Mesh(geometry, material)\n      mesh.position.y = 60\n      mesh.position.x = (Math.cos(angle) / 2.0) * 100\n      mesh.position.z = (Math.sin(angle) / 2.0) * 100\n      mesh.castShadow = true\n      mesh.scale.setScalar(10)\n      this.addObject(mesh)\n    }\n    this.renderer.shadowMap.type = THREE.VSMShadowMap\n  }\n\n  addGui() {\n    const gui = this.gui\n\n    gui\n      .add(this.renderer.shadowMap, 'enabled')\n      .name('开启阴影')\n      .onChange(v => {\n        this.renderer.shadowMap.enabled = v\n        this.scene.traverse(el => {\n          if (el.name === 'ground') {\n            el.receiveShadow = v\n          }\n        })\n      })\n    gui.domElement.className += ' gui-wrap'\n    this.container.parentNode?.appendChild(gui.domElement)\n  }\n}\n","<template>\n  <div class=\"three-page\">\n    <div class=\"h-100\" ref=\"containerRef\"></div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { ShadowScene } from './methods'\nimport { useResize } from '@/hooks/scene-resize'\n\nconst containerRef = ref()\nconst options: ConstructorParameters<typeof ShadowScene>[0] = {\n  grid: {\n    visible: true\n  },\n  directionalLight: {\n    light2: false\n  }\n}\nlet scene: InstanceType<typeof ShadowScene>\n\nonMounted(() => {\n  options.container = containerRef.value\n  scene = new ShadowScene(options).run()\n\n  useResize(scene).resize()\n})\n</script>\n\n<style lang=\"scss\"></style>\n"],"names":["ShadowScene","ThreeScene.Scene","constructor","options","super","__publicField","this","THREE.DirectionalLight","ground","createGround","addObject","addModel","gui","GUI","addGui","createDirectionalLight","color","intensity","light","directionalLight","geometries","THREE.BoxGeometry","THREE.IcosahedronGeometry","THREE.TorusKnotGeometry","material","THREE.MeshNormalMaterial","i","l","length","angle","Math","PI","mesh","THREE.Mesh","position","y","x","cos","z","sin","castShadow","scale","setScalar","renderer","shadowMap","type","THREE.VSMShadowMap","add","name","onChange","v","enabled","scene","traverse","el","receiveShadow","domElement","className","_a","container","parentNode","appendChild","containerRef","ref","grid","visible","light2","onMounted","value","run","useResize","resize"],"mappings":"8XAKa,MAAAA,UAAoBC,EAI/B,WAAAC,CAAYC,GACVC,MAAMD,GAJRE,EAAAC,KAAA,OACAD,EAAAC,KAAA,mBAAmB,IAAIC,GAKrB,MAAMC,EAASF,KAAKG,aAAa,IAAM,IAAM,UAC7CH,KAAKI,UAAUF,GAEfF,KAAKK,WAEAL,KAAAM,IAAM,IAAIC,EACfP,KAAKQ,QACP,CAEA,sBAAAC,CAAuBC,EAAwBC,GAC7C,MAAMC,EAAQ,IAAIX,EAAuBS,EAAOC,GAEzC,OADPX,KAAKa,iBAAmBD,EACjBA,CACT,CAEA,QAAAP,GACE,MAAMS,EAAa,CACjB,IAAIC,EAAkB,EAAG,EAAG,GAC5B,IAAIC,EAA0B,GAC9B,IAAIC,EAAwB,EAAG,GAAK,IAAK,GAAI,EAAG,IAG5CC,EAAW,IAAIC,EAErB,IAAA,IAASC,EAAI,EAAGC,EAAIP,EAAWQ,OAAQF,EAAIC,EAAGD,IAAK,CACjD,MAAMG,EAASH,EAAIC,EAAKG,KAAKC,GAAK,EAG5BC,EAAO,IAAIC,EADAb,EAAWM,GACUF,GACtCQ,EAAKE,SAASC,EAAI,GAClBH,EAAKE,SAASE,EAAKN,KAAKO,IAAIR,GAAS,EAAO,IAC5CG,EAAKE,SAASI,EAAKR,KAAKS,IAAIV,GAAS,EAAO,IAC5CG,EAAKQ,YAAa,EACbR,EAAAS,MAAMC,UAAU,IACrBpC,KAAKI,UAAUsB,EACjB,CACK1B,KAAAqC,SAASC,UAAUC,KAAOC,CACjC,CAEA,MAAAhC,SACE,MAAMF,EAAMN,KAAKM,IAGdA,EAAAmC,IAAIzC,KAAKqC,SAASC,UAAW,WAC7BI,KAAK,QACLC,UAAcC,IACR5C,KAAAqC,SAASC,UAAUO,QAAUD,EAC7B5C,KAAA8C,MAAMC,UAAeC,IACR,WAAZA,EAAGN,OACLM,EAAGC,cAAgBL,EACrB,GACD,IAELtC,EAAI4C,WAAWC,WAAa,YAC5B,OAAAC,EAAApD,KAAKqD,UAAUC,aAAYF,EAAAG,YAAYjD,EAAI4C,WAC7C,4DCzDF,MAAAM,EAAAC,IACA5D,EAAA,CAA8D6D,KAAA,CACtDC,SAAA,GAEN9C,iBAAA,CACkB+C,QAAA,IAIpB,IAAAd,SAEAe,GAAA,KACEhE,EAAAwD,UAAAG,EAAAM,MACAhB,EAAA,IAAApD,EAAAG,GAAAkE,MAEAC,EAAAlB,GAAAmB"}