var e=Object.defineProperty,s=(s,t,o)=>(((s,t,o)=>{t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[t]=o})(s,"symbol"!=typeof t?t+"":t,o),o);import{eu as t,ev as o,ew as a,bb as n,ex as r,ey as i,e as d,Y as l,i as u,l as p,o as c,g as m,h}from"./vendor-75d44f4a.js";import{m as g,l as v,u as b,A as f}from"./scene-resize-311d5dd4.js";import"./index-5784889a.js";const{pass:x,mrt:_,output:w,emissive:y}=i;class j extends g{constructor(e){super(e),s(this,"gui"),s(this,"postProcessing");const r=x(this.scene,this.camera);r.setMRT(_({output:w,emissive:y}));const i=r.getTextureNode(),d=r.getTextureNode("emissive"),l=t(d,2.5,.5);this.renderer.toneMapping=o;const u=new a(this.renderer);u.outputNode=i.add(l),this.postProcessing=u,this.gui=new n,this.addGui(l)}setEnv(e){this.scene.environment=e,this.scene.background=e}createRender(){return new r}addGui(e){var s;const t=this.gui,o=t.addFolder("发光");o.add(e.threshold,"value",0,1).step(.01).name("阈值/起点"),o.add(e.strength,"value",0,3).step(.01).name("强度"),o.add(e.radius,"value",0,1).step(.01).name("半径"),o.open();const a=t.addFolder("色调映射");a.add(this.renderer,"toneMappingExposure",.1,3).name("曝光"),a.open(),t.domElement.className+=" gui-wrap",null==(s=this.container.parentNode)||s.appendChild(t.domElement)}animate(){this.postProcessing.render()}}const M={class:"three-page"},P=d({__name:"index",setup(e){const s=l({base:"",models:[{key:"helmet",name:"头盔",size:.5,url:"/oss/model/gpu/头盔.glb"}],objects:[{type:"helmet",name:"头盔"}]}),{progress:t,loadModels:o,getModel:a,initModels:n}=v.useModelLoader({baseUrl:s.base}),r=u(),i={baseUrl:s.base,env:"/oss/textures/hdr/moonless_golf_1k.hdr",camera:{position:[0,0,10]}};let d;return p((()=>{i.container=r.value,d=new j(i).run(),b(d).resize(),o(s.models,(()=>{t.percentage=100,t.show=!1,n(s.objects,(e=>{const{type:s}=e,t=a(s);if(!t)return Promise.resolve();let o=f.modelDeepClone(t);const{position:n,scale:r,rotation:i}=f.get_P_S_R_param(o,e),[l,u,p]=n;return o.scale.set(...r),o.position.set(l,u,p),o.rotation.set(...i),d.addObject(o),Promise.resolve()}))}))})),(e,s)=>(c(),m("div",M,[h("div",{class:"h-100",ref_key:"containerRef",ref:r},null,512)]))}});export{P as default};
