import{e,w as s,j as n,ba as t,bb as a,bx as o,m as i,af as l,o as d,g as c,h as r,n as m,bc as p,be as u,bf as h,b1 as v,bk as b,bj as w,cg as g,bq as E,b3 as f,bl as x,b4 as _,c as y,ch as M,bY as k}from"./vendor-8d16b5c9.js";import{c as j,a as $,b as L,d as C,e as S,l as T}from"./common-8910aff7.js";import{u as z,e as H,_ as P}from"./common-8f22681c.js";const A={class:"page h-100"},W=P(e({__name:"index",setup(e){const P=z(),W=H();let q;s((()=>P.sidebar.opened),(()=>{clearTimeout(q),q=setTimeout(V,300)}));const F=n(),N=new t;let Y,B,D,G,I,O,R;N.background=new a("#fff");const V=()=>{const e=F.value;if(!Y)return;const s=(null==e?void 0:e.clientWidth)??0,n=(null==e?void 0:e.clientHeight)??0,t=s/n;Y.aspect=t,Y.updateProjectionMatrix(),B.setSize(s,n),ee&&ee.setSize(s,n)};let J;const K=()=>{J=requestAnimationFrame(K),X(),B.render(N,Y)},Q=new b;let U;const X=()=>{p(),ee.render(N,Y);const e=Q.getElapsedTime();U&&U.position.set(200*Math.sin(e),0,200*Math.cos(e))},Z=n("217");let ee;const se=new o,ne=()=>{const e=new E(50,160,160),s=new f({specular:3355443,shininess:5,map:se.load(`${W.oss}/textures/planets/earth_atmos_2048.jpg`),specularMap:se.load(`${W.oss}/textures/planets/earth_specular_2048.jpg`),normalMap:se.load(`${W.oss}/textures/planets/earth_normal_2048.jpg`),normalScale:new x(.85,.85)}),n=new _(e,s);n.name="earth",N.add(n);const t=document.createElement("div");t.className="dot",t.innerHTML='\n    <div class="bg"></div>\n    <span class="inner">Earth</span>\n  ',t.style.pointerEvents="auto",t.addEventListener("click",(e=>{y.success("click Earth ！")}));const a=new M(t);a.position.set(0,50,0),n.add(a)},te=()=>{const e=new E(40,160,160),s=new f({shininess:5,map:se.load(`${W.oss}/textures/planets/moon_1024.jpg`)});U=new _(e,s),U.position.set(0,100,0),N.add(U);const n=document.createElement("div");n.className="dot",n.innerHTML='\n    <div class="bg"></div>\n    <span class="inner">Moon</span>\n  ',n.style.pointerEvents="auto",n.addEventListener("click",(e=>{y.success("click Moon ！")}));const t=new M(n);t.position.set(0,40,0),U.add(t)},ae=()=>{const e=F.value;B=j(e),Y=$(e,1,1e6),I=new h(16777215,1.5),N.add(I),O=S(16777215,1.5),N.add(O),R=new v(16777215,1.5),R.position.set(-500,800,-500),N.add(R),D=L(Y,B),D.maxPolarAngle=.45*Math.PI,D.screenSpacePanning=!1,G=C(),N.add(G);let s=new u(50);N.add(s),(()=>{T(N,`${W.oss}/img/sky/${Z.value}`),B.shadowMap.enabled=!0,B.shadowMap.type=w;const e=F.value;ee=new g,ee.domElement.style.pointerEvents="none";const s=(null==e?void 0:e.clientWidth)??0,n=(null==e?void 0:e.clientHeight)??0;ee.setSize(s,n),ee.domElement.style.position="absolute",ee.domElement.style.top="0px";const t=F.value;null==t||t.appendChild(ee.domElement),ne(),te()})(),(e=>{const s=new k,n={background:"217",display:()=>{N.children.forEach((e=>{if(e.isMesh){const s=e.children.find((e=>e.isCSS2DObject));s.visible=!s.visible}}))},earth:()=>{const e=N.children.find((e=>"earth"==e.name));e?(e.clear(),N.remove(e)):ne()}};s.add(n,"background").options(["216","217","218","219","220","221","222","223","224","225"]).name("切换背景").onChange((e=>{Z.value=e,T(N,`${W.oss}/img/sky/${Z.value}`)})),s.add(n,"display").name("隐藏/展示"),s.add(n,"earth").name("删除/添加地球"),s.domElement.style="position: absolute; top: 10px; right: 10px",e.appendChild(s.domElement)})(e)};return i((()=>{ae(),K(),window.addEventListener("resize",V,!1)})),l((()=>{clearTimeout(q),window.addEventListener("resize",V,!1),cancelAnimationFrame(J);try{N.clear(),B.dispose(),B.forceContextLoss(),B.content=null;let e=B.domElement.getContext("webgl");e&&e.getExtension("WEBGL_lose_context").loseContext()}catch(e){}})),(e,s)=>(d(),c("div",A,[r("div",{ref_key:"containerRef",ref:F,class:m(e.$style.container)},null,2)]))}}),[["__cssModules",{$style:{container:"_container_1kxrr_2"}}]]);export{W as default};
