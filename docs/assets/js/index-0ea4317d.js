var e=Object.defineProperty,t=(t,a,s)=>(((t,a,s)=>{a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s})(t,"symbol"!=typeof a?a+"":a,s),s);import{ex as a,ey as s,ez as n,bc as r,dU as o,dS as i,eA as d,dz as c,d4 as l,eC as u,bg as m,eB as h,e as p,i as g,l as b,o as f,g as v,h as w}from"./vendor-ccff1e05.js";import{u as y,v as M,a as x}from"./scene-resize-4d8942ca.js";import"./index-1d4c3275.js";const{pass:j,mrt:N,output:z,float:P,uniform:C}=h,{pointer:E,update:I,raycaster:O}=y.useRaycaster();class R extends M{constructor(e){super(e),t(this,"gui"),t(this,"postProcessing"),this.addModel();const o=j(this.scene,this.camera);o.setMRT(N({output:z,bloomIntensity:P(0)}));const i=o.getTextureNode(),d=o.getTextureNode("bloomIntensity"),c=a(i.mul(d));this.renderer.toneMapping=s;const l=new n(this.renderer);l.outputColorTransform=!1,l.outputNode=i.add(c).renderOutput(),this.postProcessing=l,this.gui=new r,this.addGui(c),this.bindEvent()}createAmbientLight(e,t){return new o(e,t)}createDirectionalLight(e,t){return new i(e,t)}createRender(){return new d}addModel(){const e=new c(1,15);for(let t=0;t<50;t++){const t=new l;t.setHSL(Math.random(),.7,.2*Math.random()+.05);const a=Math.random()>.5?1:0,s=new u({color:t});s.mrtNode=N({bloomIntensity:C(a)});const n=new m(e,s);n.position.set(10*Math.random()-5,10*Math.random()-5,10*Math.random()-5),n.position.normalize().multiplyScalar(20*Math.random()+10),n.scale.setScalar(4*Math.random()+3),this.addObject(n)}}onPointerDown(e){I(e,this.container),O.setFromCamera(E,this.camera);const t=O.intersectObjects(this.scene.children,!1);if(t.length>0){const e=t[0].object.material.mrtNode.get("bloomIntensity");e.value=0===e.value?1:0}}addGui(e){var t;const a=this.gui,s=a.addFolder("发光");s.add(e.threshold,"value",0,1).step(.01).name("阈值/起点"),s.add(e.strength,"value",0,3).step(.01).name("强度"),s.add(e.radius,"value",0,1).step(.01).name("半径"),s.open();const n=a.addFolder("色调映射");n.add(this.renderer,"toneMappingExposure",.1,3).name("曝光"),n.open(),a.domElement.className+=" gui-wrap",null==(t=this.container.parentNode)||t.appendChild(a.domElement)}animate(){this.postProcessing.renderAsync()}}const S={class:"three-page"},T=p({__name:"index",setup(e){const t=g(),a={camera:{position:[0,0,100]}};let s;return b((()=>{a.container=t.value,s=new R(a).run(),x(s).resize()})),(e,a)=>(f(),v("div",S,[w("div",{class:"h-100",ref_key:"containerRef",ref:t},null,512)]))}});export{T as default};
//# sourceMappingURL=index-0ea4317d.js.map
