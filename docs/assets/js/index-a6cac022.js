import{c as e,X as l,k as a,o as s,f as t,p as n,m as i,H as o,g as r,u,F as c,r as d,l as m,A as p,n as g,bu as v,aD as f,O as x,P as h,aj as y,aH as w,b2 as j,at as V,aL as _}from"./vendor-e4ee7844.js";import{_ as b}from"./index-1d839e62.js";const U={class:"flex flex-ac"},k={class:"f-x pl-sm"},q={class:"flex flex-ac"},C={class:"f-x pl-sm"},D={class:"flex flex-ac"},L={class:"f-x pl-sm"},R={class:"flex flex-ac"},z={class:"f-x pl-sm"},A={key:0,class:"mt-sm"},E=b(e({__name:"index",setup(e){const b=l({quality:1,ratio:100,name:"",urls:[],types:["png","jpeg","jpg"],type:"image/jpeg",options:[{label:"png",value:"image/png"},{label:"jpg",value:"image/jpg"},{label:"jpeg",value:"image/jpeg"},{label:"webp",value:"image/webp"}]}),E=()=>{const e=b.name.split(".").pop()||"";return!!b.types.includes(e)||(_.error("图片格式错误，支持"+b.types.join("、")+" 格式"),!1)},F=e=>{const l=e.target.files[0];if(b.urls=[],b.name=l.name,!E())return;const a=new FileReader;a.onload=e=>{const l=e.target.result;b.urls.push(l)},a.readAsDataURL(l)},H=()=>{if(!E())return;const e=new Image;e.onload=function(){const l=b.ratio/100,a=document.createElement("canvas");a.width=e.width*l,a.height=e.height*l;const s=a.getContext("2d");if(!s)return;s.drawImage(e,0,0,a.width,a.height);const t=a.toDataURL(b.type,b.quality);console.log(b.quality);const n=document.createElement("a");n.href=t,b.urls[1]=t,n.download=b.name+"."+b.type.split("/")[1],n.click()},e.src=b.urls[0]},I=l({text:"hello world!",url:""}),$=()=>{v(I.text).then((e=>{I.url=e})).catch((e=>{console.log(e)}))};return a((()=>{$()})),(e,l)=>{const a=f,v=x,_=h,E=y,M=w,O=j,P=V;return s(),t("div",{class:g(e.$style.page)},[n(O,null,{header:i((()=>l[4]||(l[4]=[o("图片转换")]))),default:i((()=>[r("div",null,[r("div",U,[l[5]||(l[5]=r("div",{class:"name"},"上传文件",-1)),r("div",k,[r("input",{type:"file",accept:"image/png,image/jpeg,image/jpg",onChange:F},null,32)])]),r("div",q,[l[6]||(l[6]=r("div",{class:"name"},"图片大小占比",-1)),r("div",C,[n(a,{modelValue:u(b).ratio,"onUpdate:modelValue":l[0]||(l[0]=e=>u(b).ratio=e),max:200},null,8,["modelValue"])])]),r("div",D,[l[7]||(l[7]=r("div",{class:"name"},"压缩等级",-1)),r("div",L,[n(a,{modelValue:u(b).quality,"onUpdate:modelValue":l[1]||(l[1]=e=>u(b).quality=e),max:1,step:.01},null,8,["modelValue"])])]),r("div",R,[l[8]||(l[8]=r("div",{class:"name"},"导出格式",-1)),r("div",z,[n(_,{modelValue:u(b).type,"onUpdate:modelValue":l[2]||(l[2]=e=>u(b).type=e)},{default:i((()=>[(s(!0),t(c,null,d(u(b).options,(e=>(s(),m(v,{label:e.label,value:e.value},null,8,["label","value"])))),256))])),_:1},8,["modelValue"])])]),n(E,{type:"success",onClick:H},{default:i((()=>l[9]||(l[9]=[o("导出")]))),_:1}),u(b).urls.length?(s(),t("div",A,[(s(!0),t(c,null,d(u(b).urls,(e=>(s(),m(M,{src:e,"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-src-list":u(b).urls,"show-progress":"","initial-index":4,fit:"cover"},null,8,["src","preview-src-list"])))),256))])):p("",!0)])])),_:1}),n(O,null,{header:i((()=>l[10]||(l[10]=[o("二维码转换")]))),default:i((()=>[r("div",null,[n(P,{modelValue:u(I).text,"onUpdate:modelValue":l[3]||(l[3]=e=>u(I).text=e),onChange:$},null,8,["modelValue"]),u(I).url?(s(),m(M,{key:0,class:"mt-sm",src:u(I).url,"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-src-list":[u(I).url],"show-progress":"","initial-index":4,fit:"cover"},null,8,["src","preview-src-list"])):p("",!0)])])),_:1})],2)}}}),[["__cssModules",{$style:{page:"_page_r82yl_2"}}]]);export{E as default};
