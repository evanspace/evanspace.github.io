var e=Object.defineProperty,s=(s,t,n)=>(((s,t,n)=>{t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n})(s,"symbol"!=typeof t?t+"":t,n),n);import{eB as t,eC as n,eD as a,bc as r,eE as o,dY as i,dW as d,eF as l,e as c,Y as u,i as p,l as m,o as h,g,h as v}from"./vendor-08e99294.js";import{D as b,p as f,u as w,n as _}from"./scene-resize-cd148b1e.js";import"./index-90c03362.js";const{pass:x,mrt:y,output:j,emissive:M}=l;class P extends b{constructor(e){super(e),s(this,"gui"),s(this,"postProcessing");const o=x(this.scene,this.camera);o.setMRT(y({output:j,emissive:M}));const i=o.getTextureNode(),d=o.getTextureNode("emissive"),l=t(d,2.5,.5);this.renderer.toneMapping=n;const c=new a(this.renderer);c.outputNode=i.add(l),this.postProcessing=c,this.gui=new r,this.addGui(l)}setEnv(e){this.scene.environment=e,this.scene.background=e}createRender(){return new o}createAmbientLight(e,s){return new i(e,s)}createDirectionalLight(e,s){return new d(e,s)}addGui(e){var s;const t=this.gui,n=t.addFolder("发光");n.add(e.threshold,"value",0,1).step(.01).name("阈值/起点"),n.add(e.strength,"value",0,3).step(.01).name("强度"),n.add(e.radius,"value",0,1).step(.01).name("半径"),n.open();const a=t.addFolder("色调映射");a.add(this.renderer,"toneMappingExposure",.1,3).name("曝光"),a.open(),t.domElement.className+=" gui-wrap",null==(s=this.container.parentNode)||s.appendChild(t.domElement)}animate(){this.postProcessing.renderAsync()}}const E={class:"three-page"},N=c({__name:"index",setup(e){const s=u({base:"",models:[{key:"helmet",name:"头盔",size:3.4,url:"/oss/model/gpu/头盔.glb"}],objects:[{type:"helmet",name:"头盔"}]}),{progress:t,loadModels:n,getModel:a,initModels:r}=f.useModelLoader({baseUrl:s.base}),o=p(),i={baseUrl:s.base,env:"/oss/textures/hdr/moonless_golf_1k.hdr",camera:{position:[0,0,10]}};let d;return m((()=>{i.container=o.value,d=new P(i).run(),w(d).resize(),n(s.models,(()=>{t.percentage=100,t.show=!1,r(s.objects,(e=>{const{type:s}=e,t=a(s);if(!t)return Promise.resolve();let n=_.modelDeepClone(t);const{position:r,scale:o,rotation:i}=_.get_P_S_R_param(n,e),[l,c,u]=r;return n.scale.set(...o),n.position.set(l,c,u),n.rotation.set(...i),d.addObject(n),Promise.resolve()}))}))})),(e,s)=>(h(),g("div",E,[v("div",{class:"h-100",ref_key:"containerRef",ref:o},null,512)]))}});export{N as default};
//# sourceMappingURL=index-b7764ba7.js.map
