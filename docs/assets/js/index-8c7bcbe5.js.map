{"version":3,"file":"index-8c7bcbe5.js","sources":["../../../code/src/pages/canvas/character-rain/index.vue"],"sourcesContent":["<template>\n  <div class=\"page\" ref=\"page\">\n    <canvas ref=\"canvas\"></canvas>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nconst page = ref()\nconst canvas = ref()\nlet timer: any\nlet fontSize = 0\nlet columnCont = 0\nlet charIndex: Array<number> = []\n\n// 初始化\nconst initCanvas = () => {\n  const cvs = canvas.value\n  const ctx = cvs.getContext('2d')\n\n  // 设备缩放比例\n  const devicePixelRatio = window.devicePixelRatio\n  canvas.value.height = page.value.clientHeight * devicePixelRatio\n  canvas.value.width = page.value.clientWidth * devicePixelRatio\n  fontSize = 15 * devicePixelRatio\n  ctx.font = `${fontSize}px \"Roboto Mono\"`\n  columnCont = Math.floor(cvs.width / fontSize)\n  charIndex = new Array(columnCont).fill(0)\n\n  draw()\n  clearInterval(timer)\n  timer = setInterval(draw, 50)\n}\n\n// 随机字符\nconst getRandomChar = () => {\n  const str = 'qwertyuiopasdfghjklzxcvbnm1234567890`!@#$%^&*()_+-[]|',\n    len = str.length\n  const s = Math.floor(Math.random() * len)\n  return str[s]\n}\n\nconst draw = () => {\n  const cvs = canvas.value\n  const ctx = cvs.getContext('2d')\n  ctx.fillStyle = 'rgba(0,0,0,.1)'\n  ctx.fillRect(0, 0, cvs.width, cvs.height)\n\n  ctx.fillStyle = '#6BE445'\n  ctx.textAlign = 'left'\n  ctx.textBaseline = 'top'\n  for (let i = 0; i < columnCont; i++) {\n    const char = getRandomChar()\n    const x = i * fontSize,\n      y = charIndex[i] * fontSize\n    ctx.fillText(char, x, y)\n    if (y > cvs.height && Math.random() > 0.99) {\n      charIndex[i] = 0\n    } else {\n      charIndex[i]++\n    }\n  }\n}\n\nonMounted(() => {\n  initCanvas()\n  window.addEventListener('resize', initCanvas)\n})\nonBeforeUnmount(() => {\n  clearInterval(timer)\n  window.removeEventListener('resize', initCanvas)\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.page {\n  overflow: hidden;\n  background: #000;\n}\n\ncanvas {\n  width: 100%;\n  height: 100%;\n}\n</style>\n"],"names":["page","ref","canvas","timer","fontSize","columnCont","charIndex","initCanvas","cvs","value","ctx","getContext","devicePixelRatio","window","height","clientHeight","width","clientWidth","font","Math","floor","Array","fill","clearInterval","setInterval","draw","getRandomChar","str","random","fillStyle","fillRect","textAlign","textBaseline","i","char","x","y","fillText","onMounted","addEventListener","onBeforeUnmount","removeEventListener"],"mappings":"4JAOA,MAAAA,EAAAC,IACAC,EAAAD,IACA,IAAAE,EACAC,EAAA,EACAC,EAAA,EACAC,EAAA,GAGA,MAAAC,EAAA,KACE,MAAAC,EAAAN,EAAAO,MACAC,EAAAF,EAAAG,WAAA,MAGAC,EAAAC,OAAAD,iBACAV,EAAAO,MAAAK,OAAAd,EAAAS,MAAAM,aAAAH,EACAV,EAAAO,MAAAO,MAAAhB,EAAAS,MAAAQ,YAAAL,EACAR,EAAA,GAAAQ,EACAF,EAAAQ,KAAA,GAAAd,oBACAC,EAAAc,KAAAC,MAAAZ,EAAAQ,MAAAZ,GACAE,EAAA,IAAAe,MAAAhB,GAAAiB,KAAA,OAGAC,cAAApB,GACAA,EAAAqB,YAAAC,EAAA,GAAA,EAIFC,EAAA,KACE,MAAAC,EAAA,wDAGA,OAAAA,EADAR,KAAAC,MAFAO,GAEAR,KAAAS,UACA,EAGFH,EAAA,KACE,MAAAjB,EAAAN,EAAAO,MACAC,EAAAF,EAAAG,WAAA,MACAD,EAAAmB,UAAA,iBACAnB,EAAAoB,SAAA,EAAA,EAAAtB,EAAAQ,MAAAR,EAAAM,QAEAJ,EAAAmB,UAAA,UACAnB,EAAAqB,UAAA,OACArB,EAAAsB,aAAA,MACA,IAAA,IAAAC,EAAA,EAAAA,EAAA5B,EAAA4B,IAAA,CACE,MAAAC,EAAAR,IACAS,EAAAF,EAAA7B,EAAAgC,EAAA9B,EAAA2B,GAAA7B,EAEAM,EAAA2B,SAAAH,EAAAC,EAAAC,GACAA,EAAA5B,EAAAM,QAAAK,KAAAS,SAAA,IACEtB,EAAA2B,GAAA,EAEA3B,EAAA2B,IACF,UAIJK,GAAA,SAEEzB,OAAA0B,iBAAA,SAAAhC,EAAA,IAEFiC,GAAA,KACEjB,cAAApB,GACAU,OAAA4B,oBAAA,SAAAlC,EAAA"}