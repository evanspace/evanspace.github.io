import{e,aR as t,aS as o,f as n,l as a,ad as s,Y as i,m as l,p as r,u as c,A as d,aT as u,o as p,q as m,aU as f,aV as h,aW as y,aX as g,aY as v,aZ as b,a_ as w,a$ as x,b0 as _,b1 as O,b2 as C,b3 as k,b4 as M,b5 as E,b6 as L,b7 as z,b8 as S,w as j,i as B,b9 as T,ba as P,g as N,n as A,s as F,B as R,h as $,a9 as D,t as I,a5 as J,bb as U,aM as H,bc as X,aH as G,I as K,bd as Q,be as Y,bf as W,bg as Z,bh as q,bi as V,bj as ee,bk as te,bl as oe,aa as ne,bm as ae,bn as se,bo as ie,bp as le,bq as re,br as ce,bs as de,bt as ue,bu as pe,bv as me,bw as fe,bx as he,by as ye,bz as ge,bA as ve,bB as be,bC as we,bD as xe,bE as _e,bF as Oe,bG as Ce,bH as ke,F as Me,r as Ee,a7 as Le,a8 as ze,bI as Se,bJ as je,bK as Be,N as Te,bL as Pe,bM as Ne,bN as Ae,bO as Fe}from"./vendor-fd8a184d.js";import{u as Re,d as $e,a as De,_ as Ie,b as Je,D as Ue,r as He,i as Xe,s as Ge,c as Ke,e as Qe,f as Ye,g as We,h as Ze}from"./common-ce9ec953.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const qe=e({__name:"App",setup(e){const f=Re(),h={zhCN:{...t,...$e},en:{...o,...De}},y=n((()=>f.language)),g=(e,t="href")=>{const o=e.dataset[t];return e.removeAttribute("data-"+t),""+o};(()=>{const e=document.querySelector('link[rel="icon"]');e.href=g(e);const t=document.querySelector('link[rel="manifest"]');t.href=g(t)})(),a((()=>{v(),window.addEventListener("resize",v,!1)})),s((()=>{window.removeEventListener("resize",v)}));const v=()=>{f.sidebar.opened&&document.body.clientWidth,w()},b=i({width:1920,size:14}),w=()=>{let e=(document.getElementById("app").clientWidth||b.width)*(b.size/b.width);document.documentElement.style.fontSize=e+"px"};return(e,t)=>{const o=d("router-view"),n=u;return p(),l(n,{locale:h[c(y)],namespace:"el"},{default:r((()=>[m(o)])),_:1},8,["locale"])}}}),Ve={colors:{normal:{color:16777215,main:16316664,text:5280767},runing:{color:1211922,main:3045368,FM:422935},error:{color:12717056,main:11879461,FM:15215899}},isCruise:!1,modelSizeKB:1048576,loadPart:{},devices:[]},et={list:[]},tt=i({percentage:0,show:!1,isEnd:!1,list:[],total:0,loaded:0}),ot=i({show:!1,style:{left:"0px",top:"0px"},select:[],title:"",data:{},pos:{}}),nt={indexdb:{dbName:"THREE__MODEL__DB",tbName:"TB",version:1},mesh:{receiveShadowName:["地面","底座","底板","基础","基础底座","冷却塔基础"]},keys:{TEXT:"TEXT",JSQ:"JSQ",LDB:"LDB",LQB:"LQB",XBC:"XBC",LXJ:"LXJ",LGJ:"LGJ",LGJ_2:"LGJ_2",LGJ_3:"LGJ_3",LGJ_4:"LGJ_4",LQT:"LQT",GL:"GL",BSHRQ:"BSHRQ",BSHLQ:"BSHLQ",FLRB:"FLRB",FJY_X:"FJY_X",FJZ_X:"FJZ_X",FJY:"FJY",FJZ:"FJZ",FM:"FM",XFM:"XFM"},rightClickBackDiffTime:100},at=e=>{!e&&(e="");return!!/^([hH][tT]{2}[pP]:\/\/|[hH][tT]{2}[pP][sS]:\/\/)[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,}(\/\S*)?$/.test(e)},st=(e,t=.1,o=1e4)=>{const n=e.clientWidth,a=e.clientHeight,s=new y(36,n/a,t,o);return s.position.set(-350,510,700),s},it=(e,t,o="",n)=>{let a=(new b).load([`${t}${o}/${n}/posX.jpeg`,`${t}${o}/${n}/negX.jpeg`,`${t}${o}/${n}/posY.jpeg`,`${t}${o}/${n}/negY.jpeg`,`${t}${o}/${n}/posZ.jpeg`,`${t}${o}/${n}/negZ.jpeg`]);e.background=a},lt=(e,t,o)=>(e.lookAt(o),new Promise((n=>{new w(e.position).to(t,1e3).easing(x.Quadratic.In).start().onUpdate((()=>{e.lookAt(o)})).onComplete((()=>{n(e)}))}))),rt=(e,t,o=1)=>{const n=e.position,a=e.rotation,s=e.scale,i=t.position||{x:0,y:0,z:0},l=t.rotation||{x:0,y:0,z:0},r=t.scale||{x:1,y:1,z:1},c=Math.abs(l.x)<2?1:180,d=Math.abs(l.y)<2?1:180,u=Math.abs(l.z)<2?1:180;return{position:[n.x+i.x,n.y+i.y,n.z+i.z],rotation:[a.x+Math.PI/c*l.x,a.y+Math.PI/d*l.y,a.z+Math.PI/u*l.z],scale:[s.x*o*r.x,s.y*o*r.y,s.z*o*r.z]}},ct=e=>e.map((e=>(e.children&&e.children.length>0?e.children=ct(e.children):e.material&&(e.material instanceof Array?e.material=e.material.map((e=>e.clone())):e.material=e.material.clone()),e))),dt=e=>{let t=e.clone();return t.children=ct(t.children),t},ut=e=>{let t=[];return Array.isArray(e)?t=e:null!=e&&(t=[e]),t},pt=(e,t)=>{e.traverse((e=>{e.isMesh&&(Array.isArray(e.material)?e.material.forEach((e=>{e.color.set(t)})):e.material.color.set(t))}))},mt=(e,t)=>{let o=[];if(!e||!e.length)return[];return function e(n){n.forEach((n=>{const a=n.name;"string"==typeof a&&t.some((e=>a.indexOf(e)>-1))&&o.push(n),n.children&&e(n.children)}))}(e),o},ft=nt.keys,ht=(e,t=16777215)=>{const o=e.type;let n=10,a=t,s={x:0,y:0,z:0},i={x:0,y:0,z:0},l={x:0,y:0,z:0},r={x:0,y:0,z:0},c={x:0,y:0,z:0};switch(o){case ft.TEXT:break;case ft.JSQ:s.y=10,s.z=20,l.y=62;break;case ft.LDB:case ft.LQB:s.z=o===ft.LDB?75:60,l.y=45,i.y=o===ft.LDB?90:-90,r.x=-.4,r.y=46.7,r.z=-15.7,c.x=-.4,c.y=34,c.z=12.5;break;case ft.XBC:case ft.LXJ:s.y=16,s.z=40,l.y=78,r.x=36,r.y=67,r.z=42,c.x=-25,c.y=85,c.z=20;break;case ft.LGJ:case ft.LGJ_2:case ft.LGJ_3:case ft.LGJ_4:s.y=16,s.z=40,l.y=78,r.x=-40,r.y=64,r.z=42,c.x=0,c.y=75,c.z=20;break;case ft.LQT:s.x=-60,l.y=85,r.x=-27.6,r.y=70,r.z=-25.2,c.x=-27.6,c.y=70,c.z=25.2;break;case ft.GL:s.x=83,s.y=2,l.y=125,r.y=125;break;case ft.BSHRQ:n=12,s.y=8,s.z=33,l.y=105,r.y=105;break;case ft.BSHLQ:s.y=16,s.z=40,l.y=88,r.x=-43,r.y=90,r.z=-20;break;case ft.FLRB:s.x=50,s.y=2,l.y=123,r.y=123;break;case ft.FJY_X:case ft.FJZ_X:n=6,s.y=80,s.z=30,l.y=80,r.y=80;break;case ft.FJY:case ft.FJZ:n=6,s.y=103,l.y=110,r.y=110}let d=e.font||{},u=d.position||{};u&&Object.keys(u).forEach((e=>{s[e]=u[e]}));let p=d.rotation||{};return p&&(Object.keys(p).forEach((e=>{i[e]=p[e]})),i.x=Math.PI/180*i.x,i.y=Math.PI/180*i.y,i.z=Math.PI/180*i.z),d.size&&(n=d.size),d.color&&(a=d.color),{size:n,color:a,txPos:s,txRot:i,warnPos:l,statusPos:r,disabledPos:c}},yt=(e,t,o)=>{if(!t)return;const n=ht(e)[o?"disabledPos":"statusPos"];let a=dt(t);return a.position.set(n.x,n.y,n.z),a.visible=!1,a},gt=(e,t)=>{e.data&&e.data.type?t(e):e.isScene?t(null):gt(e.parent,t)},vt=(e,t,o)=>{let n=e.clientWidth/2,a=e.clientHeight/2,s=t.position.clone();const i=t.scale;s.y+=i.x/2;let l=s.project(o);return{left:l.x*n+n,top:-l.y*a+a}},bt=e=>{e&&e.traverse&&(e.traverse((e=>{e.material&&e.material.dispose(),e.geometry&&e.geometry.dispose(),null==e||e.clear()})),null==e||e.clear())},wt=e=>new Promise((t=>{const o=window.indexedDB.deleteDatabase(e);o.onsuccess=e=>{t(!0)},o.onerror=e=>{t(!1)}})),xt=async(e,t="THREE__MODEL_DB",o=1)=>{if(!window.indexedDB)return Promise.resolve(null);await((e,t,o)=>new Promise((n=>{window.indexedDB.open(e).onsuccess=a=>{const s=a.target.result,i=s.version;s.close(),i!==t?wt(e).then((e=>{n(e?t:i)})):s.objectStoreNames.contains(o)?n(i):wt(e).then((e=>{n(e?t:i)}))}})))(t,o,e);let n=window.indexedDB.open(t,o);return new Promise((t=>{n.onupgradeneeded=t=>{const o=t.target.result;o.objectStoreNames.contains(e)||o.createObjectStore(e,{keyPath:"path"})},n.onsuccess=e=>{const o=e.target.result;t(o)},n.onerror=e=>{t(null)}}))},_t=Ie(e({name:"three-scene",__name:"index",props:{devEnv:{type:Boolean},id:{},bgColor:{type:[String,Boolean],default:void 0},skyCode:{default:"217"},skyCodes:{default:()=>["216","217","218","219","220","221","222","223","224","225"]},skyPath:{default:"/img/sky"},hdr:{},grid:{type:Boolean},baseUrl:{},models:{},config:{},objects:{},dotKey:{default:"DOT"},dotShowStrict:{type:Boolean,default:!0},loadCache:{type:Boolean,default:!0},lightHelper:{type:Boolean},axesHelper:{type:Boolean},scale:{default:1},dbName:{},tbName:{},dbVersion:{},mainBodyChangeColor:{type:Boolean},mainBodyMeshName:{default:()=>["主体"]},getColorCall:{},formatObject:{},dotUpdateObjectCall:{},updateObjectCall:{},randomUpdateObjectCall:{},animationModelType:{},pipeMeshName:{},pipeModelType:{},statusMeshName:{},colorMeshName:{},colorModelType:{default:()=>["FM","XFM"]},textModelType:{},anchorType:{default:()=>[]},floorModelType:{},cruisePoints:{},cruiseSegment:{},cruiseSpeed:{},cruiseTubeShow:{type:Boolean},pathBg:{},pathWidth:{},pathMap:{},pathTension:{},pathMapSpeed:{},cruisePathOffset:{}},emits:["loaded","update","select","dblclick","click-dot","click-dialog-dot"],setup(e,{expose:t,emit:o}){const n=e;j((()=>n.objects),(e=>{tt.isEnd&&io()}));const d=B(),u=new T;let y,b,Me,Ee,Le,ze,Se;u.background=new P("#fff");const je=Symbol("__WARNING_STATUS_MODEL_KEY__"),Be=Symbol("__REMOTE_STATUS_MODEL_KEY__"),Te=Symbol("__LOCAL_STATUS_MODEL_KEY__"),Pe=Symbol("__DISABLED_STATUS_MODEL_KEY__"),Ne=Symbol("__CHANGE_COLOR_MATERIAL_KEY__"),Ae=Symbol("__CHANGE_STATUS_MESH_KEY__"),Fe=Symbol("__PIPE_TEXTURE_KEY__"),Re=Symbol("__MAIN_BODY_MESH_KEY__"),$e=()=>{if(Le=new Q(16777215,1.5),u.add(Le),ze=((e=16777215,t=1,o=800,n=4096,a=1,s=2e3)=>{const i=new _(e,t);return i.position.set(500,800,800),i.castShadow=!0,i.shadow.camera.radius=10,i.shadow.camera.near=a,i.shadow.camera.far=s,i.shadow.camera.top=o,i.shadow.camera.right=o,i.shadow.camera.left=-o,i.shadow.camera.bottom=-o,i.shadow.mapSize.set(n,n),i})(16777215,1.5),u.add(ze),Se=new _(16777215,1.5),Se.position.set(-500,800,-800),u.add(Se),n.lightHelper){const e=new Y(ze,1);u.add(e);const t=new Y(Se,1);u.add(t)}},De=()=>{const e=d.value;if(!y)return;const t=(null==e?void 0:e.clientWidth)??0,o=(null==e?void 0:e.clientHeight)??0,n=t/o;y.aspect=n,y.updateProjectionMatrix(),_t&&(_t.aspect=n,_t.updateProjectionMatrix()),b.setSize(t,o),ro&&ro.setSize(t,o)};let Ie;const Je=()=>{Ie=requestAnimationFrame(Je),He(),Nt(),b.render(u,Ve.isCruise?_t:y),ro&&ro.render(u,Ve.isCruise?_t:y)},Ue=(e,t)=>{if(0==e.length||0==t.length)return[];let o=[];return e.forEach((e=>{if(e instanceof Array){let n=[];e.filter((e=>{if(e instanceof Array){const o=t.filter((t=>e.includes(t.deviceCode)));return o.length&&o.forEach((e=>{n.includes(e)||n.push(e)})),o.length>0}const o=t.find((t=>t.deviceCode==e));return o&&!n.includes(o)&&n.push(o),!!o})).length==e.length&&(o=o.concat(n))}else{const n=t.find((t=>t.deviceCode==e));n&&o.push(n)}})),o},He=()=>{U(),Me.update();let e=Qe.getDelta();if(Ve.devices.length&&Ve.devices.forEach((t=>{let o=t.data;if(!o)return;let a=t.extra,s=t[je],i=t[Fe];if(a&&((null==o?void 0:o.status)??0)>0&&a.mixer.update(e),s&&((null==o?void 0:o.error)||0)>0&&s.mixer.update(e),i){const e=o.bind||[],t=fo.value.filter((e=>e.type!==n.dotKey&&!(n.pipeModelType||[]).includes(e.type)&&e.deviceCode&&((null==e?void 0:e.status)??0)>0)),a=Ue(e,t),s=a.length>0;let l=.01;if(o.left&&o.right){const{left:e,right:t}=o,n=Ue(t,a).length>0;l=Ue(e,a).length>0&&n?0:n?-.01:.01}s&&(i.material.map.offset.y-=l),i.material.opacity=s?.3:0}})),ot.show&&ot.select.length){const e=d.value,t=vt(e,ot.select[0],Ve.isCruise?_t:y);ot.pos=t,ot.style.left=t.left+"px",ot.style.top=t.top+"px"}};j((()=>n.bgColor),(e=>{u.background=new P(e)})),j((()=>n.skyCode),(e=>{n.bgColor||(it(u,n.baseUrl,n.skyPath,e),n.devEnv&&(Xe.value=e))}));const Xe=B(n.skyCode),Ge=()=>{const e=n.skyCodes||[];let t=e.findIndex((e=>e==Xe.value))+1;t>=e.length&&(t=0),Xe.value=e[t],it(u,n.baseUrl,n.skyPath,Xe.value)},Ke=o;let Qe,Ye,We,Ze;const qe=n.tbName||nt.indexdb.tbName,ct=()=>{if(n.hdr){const e=n.baseUrl+n.hdr;(new te).load(e,(t=>{no(e),t.mapping=oe,u.environment=t,t.dispose()}))}};j((()=>n.cruisePoints),(async()=>{await ne(),ft(),wt(),Bt()}),{immediate:!0});const ft=()=>{Ot&&(bt(Ot),u.remove(Ot),Ot=void 0)},wt=()=>{Ve.isCruise=!1,Me.enabled=!Ve.isCruise,Lt=Ve.isCruise};let _t,Ot,Ct,kt,Mt,Et,Lt=!1,zt=0,St=1,jt=0;const Bt=()=>{const e=Date.now();if(e-jt<300)return;jt=e,zt=0;let t=[];const o=n.cruisePoints||[];if(0!=o.length){for(let e=0;e<o.length;e++){const n=o[e];t.push(new ae(n[0],n[1],n[2]))}if(_t=st(d.value,1,1e6),_t.lookAt(Me.target),Mt=new se(t,!0,"catmullrom",n.pathTension??0),Ot=new ie,u.add(Ot),n.cruiseTubeShow){Ct=new k(new le(2),new re({color:0,opacity:.8,transparent:!0})),Ot.add(Ct),kt=(new ce).setFromPoints(t);const e=new de({color:255,opacity:1,transparent:!0}),o=new ue(kt,e);Ot.add(o);const n=new pe(Mt,100,2,3,!0),a=new me({color:16711935,opacity:.1,transparent:!0}),s=new k(n,a),i=new re({color:16715760,opacity:.3,wireframe:!0,transparent:!0}),l=new k(n,i);s.add(l),Ot.add(s)}Tt()}else Mt=void 0},Tt=async()=>{const e=n.pathBg||n.baseUrl+"/model/pipe/arrow.png",t=n.pathMap||[.1,1],o=await(new fe).loadAsync(e);if(!Ot)return;o.wrapS=he,o.repeat.x=t[0],o.repeat.y=t[1],o.anisotropy=b.capabilities.getMaxAnisotropy(),Et=o;const a=new C({map:o,opacity:.5,transparent:!0,depthWrite:!1}),s=new ae(0,1,0),i=new ve;i.set(Mt.getPoints(1e3),5,1,s,!1);const l=new ye;l.update(i,{width:n.pathWidth??15,arrow:!1});const r=new k(l,a);r.name="path",Ot.add(r)},Pt=()=>1e3*(n.cruiseSegment??2),Nt=()=>{if(!Mt)return;Et&&(Et.offset.x-=n.pathMapSpeed??.006),Lt&&(zt+=St*(n.cruiseSpeed??1));const e=Pt(),t=zt%e/e,o=Mt.getPointAt(t),a=n.cruisePathOffset??3;if(n.cruiseTubeShow&&Ct){const e=At(a,o);Ct.position.copy(e)}if(!Ve.isCruise)return;const s=.03;let i=t-s;t<s&&(i=t+.97);const l=At(a,Mt.getPointAt(i));_t.position.copy(l),_t.lookAt(At(a,o))},At=(e,t)=>new ae(t.x,t.y+e,t.z),Ft=i({click:!1,tsp:0}),Rt=e=>{Ht(e,Ye),We.setFromCamera(Ye,Ve.isCruise?_t:y);const t=Ve.devices;let o=We.intersectObjects(t,!0);if(o.length){const e=o[0].object;gt(e,(t=>{if(!t)return;Ke("dblclick",t);const o=t.data,n=et.list.findIndex((e=>t.uuid===e.uuid));"function"==typeof o.onDblclick&&o.onDblclick(H(o),e,t,n),n>-1&&$t(n)}))}},$t=e=>{var t,o,a,s;if(0===et.list.length)return;const i=void 0!==e&&e>-1;if((null==(t=n.config)?void 0:t.floorExpandHiddenOther)&&Ve.devices.forEach((e=>{var t;e.visible=(t=e,et.list.findIndex((e=>t.uuid===e.uuid))>-1||!i)})),et.list.forEach(((t,o)=>{var a,s,l;const r=t._pos;let c=o-(i?e:o);const d=(null==(a=n.config)?void 0:a.floorExpandMargin)||200,u=(null==(s=n.config)?void 0:s.floorExpandMode)||"UD",p=c*d,m=((null==r?void 0:r.y)??0)+p,f=e==o?((null==r?void 0:r.z)??0)+d:(null==r?void 0:r.z)??0;if("UD"===u){if(t.position.y===m)return}else if("BA"===u&&t.position.z===f)return;if(null==(l=t.data)?void 0:l.mark){const n=t.data.mark,a=Ve.devices.filter((e=>{var t;return(null==(t=e.data)?void 0:t.followMark)===n}));Dt(u,a,p,e==o?d:0)}new w(t.position).to({y:"UD"===u?m:t.position.y,z:"BA"===u?f:t.position.z},500).easing(x.Quadratic.Out).start()})),!(null==(o=n.config)?void 0:o.floorExpandChangeViewAngle))return;let l,r;if(i){const t=et.list[e]||{};l=null==(a=t.data)?void 0:a.to,l&&(r=(null==(s=t.data)?void 0:s.target)||t._pos)}l=lo(l,r),(e=>{const t=y.position;return Math.abs(t.x-e.x)<1&&Math.abs(t.y-e.y)<1&&Math.abs(t.z-e.z)<1})(l)||lt(y,l,Me.target)},Dt=(e,t,o,n)=>{0!==t.length&&t.forEach((t=>{const a=t._pos,s="UD"==e?((null==a?void 0:a.y)??0)+o:(null==a?void 0:a.y)??0,i="BA"==e?((null==a?void 0:a.z)??0)+n:(null==a?void 0:a.z)??0;new w(t.position).to({y:s,z:i},500).easing(x.Quadratic.Out).start()}))},It=e=>{Ft.click=!0,Ft.tsp=e.timeStamp},Jt=e=>{Xt(e),Ft.click},Ut=e=>{var t,o;Ft.click=!1;const a=e.timeStamp-Ft.tsp<nt.rightClickBackDiffTime;2==e.button?a&&"function"==typeof(null==(t=n.config)?void 0:t.back)&&(null==(o=n.config)||o.back(screen)):0==e.button?a&&Xt(e):e.button},Ht=(e,t)=>{if(!e||!t)return;const o=d.value;let n=(null==o?void 0:o.getBoundingClientRect())??{left:0,top:0};t.x=(e.clientX-n.left)/(1*o.clientWidth)*2-1,t.y=-(e.clientY-n.top)/(1*o.clientHeight)*2+1},Xt=e=>{const t=d.value;Ht(e,Ye),We.setFromCamera(Ye,Ve.isCruise?_t:y);let o="pointerdown"==e.type||"pointerup"==e.type;const a=u.children.filter((e=>e.visible&&!!e.data&&n.anchorType.includes(e.data.type)));let s=We.intersectObjects(a,o);if(t.style.cursor=s.length>0?"pointer":"auto",o)if(s.length){const e=s[0].object;gt(e,(e=>{if(!e)return;const t=e.data;if(!t.type)return void(ot.show=!1);const o=H(t);Ke("select",o),"function"==typeof t.onClick?t.onClick(o):(ot.select=[e],ot.show=!0,Gt())}))}else ot.select.length=0,ot.show=!1},Gt=()=>{const e=d.value,t=ot.select[0],o=t.data;ot.data=o,ot.title=(null==o?void 0:o.name)||"";const n=vt(e,t,Ve.isCruise?_t:y);ot.pos=n,ot.style.left=n.left+"px",ot.style.top=n.top+"px",Ke("click-dialog-dot",o,n)};let Kt,Qt,Yt,Wt;const Zt=()=>{const e=n.models,t=e.length;let o=0;if(0==t)return tt.isEnd=!0,void(tt.show=!1);tt.isEnd=!1,tt.percentage=0;const a=async()=>{const s=e[o],{key:i,name:l,map:r,url:c,size:d,range:u,font:p,warning:m,remote:f,local:h,disabled:y}=s;if(tt.list.push({name:`${l} Model`,pro:0}),r){let e=(new fe).load(n.baseUrl+r),t=new be({map:e}),o=new we(t),a=d,s=d;u&&(a=u.x,s=u.y),o.scale.set(a,s,1),o.name="sprite",Ve.loadPart[i]=o}else p?await Vt(p,d):m?Kt=await eo(i||je,m,d):f?Qt=await eo(i||Be,f,d):h?Yt=await eo(i||Te,h,d):y?Wt=await eo(i||Pe,y,d):c&&await eo(i,c,d,s);o++,tt.loaded+=d*Ve.modelSizeKB,o==t?(tt.isEnd=!0,io()):a()};tt.show=!0,a()};let qt;const Vt=(e,t=0)=>{const o=new xe;return!at(e)&&e.indexOf(n.baseUrl)<0&&(e=n.baseUrl+e),new Promise((async n=>{const a=await to(e,t);if(a)return qt=o.parse(JSON.parse(a)),void setTimeout((()=>{n(qt)}),10);o.load(e,(t=>{qt=t,no(e),n(t)}))}))},eo=(e,t,o=0,a)=>{const s=new _e;s.setDecoderPath("draco/gltf/");const i=new Oe;return i.setDRACOLoader(s),new Promise((async s=>{const l=Ve.colors.normal[e]||Ve.colors.normal.color;!at(t)&&t.indexOf(n.baseUrl)<0&&(t=n.baseUrl+t);const r=await to(t,o);if(r){const t=r.scene.children[0],o=oo(e,l,t,r.animations,a);return void s(o)}let c=t.split(".").pop().toLowerCase();if("glb"!==c)throw new Error("模型类型错误,必须为 GLB 格式，当前格式："+c);i.load(t,(o=>{let n=o.scene.children[0];const i=oo(e,l,n,o.animations,a);no(t),s(i)}),so)}))},to=(e,t=0)=>{const o=new Oe;return new Promise((async a=>{n.loadCache||a(null);const s=ee.get(e);if(s)s instanceof ArrayBuffer?(so({loaded:s.byteLength}),o.parse(s,"",(t=>{ee.add(e,t),a(t)}))):(so({loaded:t*Ve.modelSizeKB}),setTimeout((()=>{a(s)}),10));else{const t=await((e,t,o)=>{if(!e||!t||!o)return Promise.resolve(null);const n=e.transaction([t],"readonly").objectStore(t).get(o);return new Promise(((e,t)=>{n.onsuccess=t=>{const o=t.target.result;e(o)},n.onerror=e=>{t(e)}}))})(Ze,qe,e);if(t&&t.data){const e=t.data;"string"==typeof e?(so({loaded:e.length}),ee.add(t.path,e),setTimeout((()=>{a(e)}),10)):(so({loaded:e.byteLength}),o.parse(e,"",(e=>{ee.add(t.path,e),a(e)})))}else a(null)}}))},oo=(e,t,o,a,s)=>{var i;if(!o)return;let l;if((null==(i=n.pipeModelType)?void 0:i.includes(e))&&s){const{pipeMap:e,repeat:t=[1,1]}=s;l=(new fe).load(n.baseUrl+e),l.wrapS=he,l.wrapT=he,l.repeat.set(t[0]??1,t[1]??1)}const r=dt(o);return r.traverse((e=>{var o;l&&(null==(o=n.pipeMeshName)?void 0:o.includes(e.name))?e.material=new me({side:Ce,transparent:!0,opacity:0,map:l.clone()}):((e,t=6776165,o,n)=>{const{type:a,name:s}=e;a.indexOf("Light"),nt.mesh.receiveShadowName.some((e=>s.indexOf(e)>-1))?e.traverse((e=>{e.isMesh&&(e.receiveShadow=!0)})):o.some((e=>s.indexOf(e)>-1))?pt(e,t):e.isMesh&&(n&&(e.material.envMap=n),e.castShadow=!0)})(e,t,n.colorMeshName||[])})),r.animations=a,Ve.loadPart[e]=r,r},no=e=>{if(!n.loadCache)return;const t=ee.get(e);if(t&&Ze){Ze.transaction(qe,"readwrite").objectStore(qe).add({path:e,data:t})}},ao=async(e,t)=>{const o="_BASE_";if(!e){const e=Ve.loadPart[o];if(e){const t=u.children.find((t=>t.uuid===e.uuid));u.remove(t),bt(e),Ve.loadPart[o]=null}return}const n=await eo(o,e),{position:a,scale:s,rotation:i}=rt(n,t);return n.scale.set(...s),n.position.set(...a),n.rotation.set(...i),u.add(n),Promise.resolve(n)},so=e=>{const{loaded:t}=e,o=tt.total;let n=Number((t+tt.loaded)/o*100);n>100&&(n=100),tt.percentage=Number(n.toFixed(2))},io=async()=>{var e,t,o,a;tt.percentage=100,tt.show=!1,ot.show=!1,Ve.devices.forEach((e=>{const t=u.children.find((t=>{var o,n;return(null==(o=t.data)?void 0:o.id)==(null==(n=e.data)?void 0:n.id)}));bt(e),bt(t),u.remove(t)})),Ve.devices.length=0,et.list.length=0,await ne(),ao(),ho(),await mo(),"function"==typeof(null==(e=n.config)?void 0:e.load)&&(null==(t=n.config)||t.load(u));const s=(null==(o=n.config)?void 0:o.floorExpandIndex)||-1,i=lo();s>-1&&et.list.length?($t(s),(null==(a=n.config)?void 0:a.floorExpandChangeViewAngle)||lt(y,i,Me.target).then((()=>{Ke("loaded")}))):lt(y,i,Me.target).then((()=>{Ke("loaded")}))},lo=(e,t)=>{const o=n.config||{},a=e||o.to||{x:-104,y:7,z:58},s=t||o.target||{x:0,y:0,z:0};return Me.target.set(s.x,s.y,s.z),a};let ro;j((()=>n.dotShowStrict),(()=>co()));const co=()=>{const e=Ve.devices;for(let t=0;t<e.length;t++){const o=e[t];if(!o.data)continue;o.data.type===n.dotKey&&uo(o)}},uo=e=>{var t;if("function"!=typeof n.dotUpdateObjectCall)throw Error("未传人点位更新对象回调方法 dotUpdateObjectCall");const o=e.data,a=n.dotUpdateObjectCall(o,Ve.devices);if("object"!=typeof a)throw Error("点位更新回调方法返回类型不是 Object，当前返回类型为："+typeof a);Object.keys(a).forEach((e=>{o[e]=a[e]})),e.visible=o.show||!n.dotShowStrict;const s=null==(t=e.element)?void 0:t.getElementsByClassName("inner")[0];if(s){const{size:e,color:t}=o.font||{};null!=e&&(s.style.fontSize="string"==typeof e?e:e+"px"),null!=t&&(s.style.color=t),s.textContent=`${o.value||0}${o.unit}`}},po=async e=>{var t,o;if(!e)return;const a=e.type;let s=Ve.loadPart[a];if(!s)return void(e.url?await ao(e.url,e):a==n.dotKey&&(e=>{const t=document.createElement("div"),{size:o,color:n}=e.font||{};t.className="dot",t.innerHTML=`\n  <div class="bg"></div>\n  <span class="inner" style="${null!=o?`font-size: ${"string"==typeof o?o:o+"px"};`:""} ${null!=n?`color: ${n}`:""}"></span>\n  `,t.style.pointerEvents="auto",t.addEventListener("click",(t=>{Ke("click-dot",H(e))}));const a=new ke(t),s=e.position;a.position.set(null==s?void 0:s.x,null==s?void 0:s.y,null==s?void 0:s.z),a.name=e.name,a.data=e,u.add(a),Ve.devices.push(a),uo(a)})(e));const i=n.colorMeshName||[],l=n.animationModelType||[],r=n.floorModelType||[],c=n.textModelType||[];let d=dt(s);const{position:p,scale:m,rotation:f}=rt(d,e),[h,y,g]=p;if(d.scale.set(...m),c.includes(a)&&qt){const t=new M;t.add(d);let o=((e,t,o)=>{if(!t)return;const n=ht(e,o);let a=new O(e.name||"",{font:t,size:n.size||5,depth:0,curveSegments:12,bevelThickness:1,bevelSize:.1,bevelEnabled:!0});const s=n.txRot;a.rotateX(s.x),a.rotateY(s.y),a.rotateZ(s.z);const i=n.txPos;a.computeBoundingBox(),a.computeVertexNormals();let l=.5*(a.boundingBox.max.x-a.boundingBox.min.x),r=.5*(a.boundingBox.max.z-a.boundingBox.min.z),c=new C({color:null!=n.color?n.color:16777215,flatShading:!1}),d=new k(a,c);return d.castShadow=!0,d.position.set((i.x||0)-l,i.y||0,(i.z||0)-r),d})(e,qt,Ve.colors.normal.text);t.add(o),t.name=e.name,d=t}if(l.includes(a)){if("Group"!==d.type&&(Kt||Qt||Yt||Wt)){const e=new M;e.add(d),d=e}if(Kt){const{group:t,action:o,mixer:n}=((e,t,o,n=100,a=1)=>{if(!o)return;const s=ht(t).warnPos;let i=new M,l=dt(o);l.scale.set(a,a,a),l.position.set(s.x,s.y,s.z),i.add(l);let r=new E(12717056,8,n,0);r.name="灯光",r.position.y=s.y+30,i.add(r),i.name=e;let c=new L(i),d=new z("红色.material.color",[0,.25,.75],[1,0,0,1,1,0,1,0,0]),u=new z("灯光.color",[0,.25,.75],[1,0,0,1,1,0,1,0,0]),p=new z("警告标识.scale",[0,.5,1],[1,1,1,1.2,1.2,2,1,1,1]),m=new S("warning_",1,[d,u,p]),f=c.clipAction(m);return f.paused=!0,f.play(),i.visible=!1,{group:i,action:f,mixer:c}})(je,e,Kt);d.add(t),d[je]={action:o,mixer:n}}if(Qt){const t=yt(e,Qt);d.add(t),d[Be]=t}if(Yt){const t=yt(e,Yt);d.add(t),d[Te]=t}if(Wt){const t=yt(e,Wt,!0);d.add(t),d[Pe]=t}if(n.mainBodyChangeColor){const e=((null==(t=d.children[0])?void 0:t.children)||[]).filter((e=>(n.mainBodyMeshName||[]).some((t=>e.name.indexOf(t)>-1)))),o=Ve.colors.normal;let a=o.main||o.color,s=ut(a);s.length&&e.forEach(((e,t)=>{pt(e,s[t%s.length])})),d[Re]=e}const o=mt(d.children,i);let a,l=new L(d);s.animations.length&&(a=l.clipAction(s.animations[0]),a.paused=!0,a.timeScale=1.5,a.play()),d.extra={action:a,mixer:l,meshs:o}}d.position.set(h,y,g),d.rotation.set(...f),d.data=e;const v=d.children.filter((e=>"string"==typeof e.name&&i.some((t=>e.name.indexOf(t)>-1))));v.length&&(d[Ne]=v);const b=mt(d.children,n.statusMeshName||[]);if(b.length&&(b.forEach((e=>{e.visible=!1})),d[Ae]=b),null==(o=n.pipeModelType)?void 0:o.includes(a)){const t=d.children.find((e=>{var t;return null==(t=n.pipeMeshName)?void 0:t.includes(e.name)}));if(t){t.material.map=t.material.map.clone();const o=e.map;if(o){const e=t.material.map.repeat;t.material.map.repeat.set(e.x*(o[0]??1),e.y*(o[1]??1))}d[Fe]=t}}return u.add(d),(e.followMark||e.mark)&&(d._pos={x:h,y:y,z:g}),Ve.devices.push(d),r.includes(a)&&(d._pos={x:h,y:y,z:g},et.list.push(d)),Promise.resolve()},mo=()=>{let e=0,t=fo.value.length;return new Promise((o=>{if(0==t)return;const n=async()=>{const a=fo.value[e];await po(a),e++,e<t?n():o(e)};n()}))},fo=B([]),ho=()=>{fo.value.length=0;const e=H(n.objects)||[];if("function"!=typeof n.formatObject)throw Error("未传入格式化函数 formatObject");const t=n.formatObject(e);fo.value=t},yo=()=>{},go=e=>{St=1;const t=e.keyCode;if(Ve.isCruise)switch(t){case 32:Lt=!Lt;break;case 38:case 87:Lt||(zt+=10);break;case 83:case 40:Lt||(zt-=10,zt<0&&(zt=Pt()))}},vo=e=>{const t=e.keyCode;if(Ve.isCruise&&e.repeat)switch(t){case 38:case 87:Lt?(St*=1.5,St>10&&(St=10)):zt+=5;break;case 83:case 40:Lt||(zt-=5,zt<0&&(zt=Pt()))}};window.addEventListener("keydown",vo,!1),window.addEventListener("keyup",go,!1);const bo=()=>{(n.cruisePoints||[]).length&&(Ve.isCruise=!Ve.isCruise,Me.enabled=!Ve.isCruise,Lt=Ve.isCruise)},wo=()=>{const e=n.pipeModelType||[],t=[];if("function"!=typeof n.randomUpdateObjectCall)throw Error("未传入随机更新回调函数 randomUpdateObjectCall");Ve.devices.forEach(((o,a)=>{if(!o.data)return;const s=o.data;let i=s.type;if(i===n.dotKey)return void uo(o);if(e.includes(i))return;const l=n.randomUpdateObjectCall(s);if(!l)return;if("object"!=typeof l)throw Error("更新回调函数返回对象不为 Object，当前类型："+typeof l);Object.keys(l).forEach((e=>{s[e]=l[e]})),t.push(H(s));let{status:r=0,error:c=0,remote:d=0,local:u=0,disabled:p=0}=s;const m=c>0?"error":r>0?"runing":"normal",f=Ve.colors[m];let h=f[i]||f.color;if("function"==typeof n.getColorCall){const e=n.getColorCall(s);e&&(h=e)}xo({type:i,el:o,colorObj:f,color:h,paused:0==r,error:c>0,remote:d>0,local:u>0,disabled:p>0})})),Ke("update",t,!0)},xo=e=>{let{el:t,colorObj:o,color:a,type:s,paused:i,error:l}=e;const r=ut(a)[0];if(t[Ae]){t[Ae].forEach((e=>{e.visible=!i}))}if(n.colorModelType.includes(s)&&null!=r){return void(t[Ne]||[]).forEach((e=>{pt(e,r)}))}const c=t.extra;if(c&&(c.action&&(c.action.paused=i),null!=r)){(c.meshs||[]).forEach((e=>{pt(e,r)}))}const d=t[je];if(d){const e=t.children.find((e=>e.name==je));e&&(e.visible=l,d.action.paused=!l)}if(t[Be]&&(t[Be].visible=e.remote),t[Te]&&(t[Te].visible=e.local),t[Pe]&&(t[Pe].visible=e.disabled),n.mainBodyChangeColor&&t[Re]){const e=o.main;let n=ut(e);n.length&&t[Re].forEach(((e,t)=>{pt(e,n[t%n.length])}))}},_o=()=>{n.models.forEach((e=>{const t=e.size*Ve.modelSizeKB;tt.total+=t}));const e=d.value;if(b=(e=>{const t=e.clientWidth,o=e.clientHeight,n=new f({antialias:!0,alpha:!0});return n.outputEncoding=void 0,n.toneMapping=h,n.toneMappingExposure=2,n.gammaOutput=!0,n.setSize(t,o),n.setPixelRatio(window.devicePixelRatio),e.appendChild(n.domElement),n})(e),y=st(e,1,1e6),(()=>{ro=new ge;const e=d.value;ro.domElement.className="three-scene__dot-wrap",ro.domElement.style.pointerEvents="none";const t=(null==e?void 0:e.clientWidth)??0,o=(null==e?void 0:e.clientHeight)??0;ro.setSize(t,o),ro.domElement.style.position="absolute",ro.domElement.style.top="0px";const n=d.value;null==n||n.appendChild(ro.domElement)})(),$e(),Me=((e,t)=>{const o=new g(e,t.domElement);return o.minDistance=1,o.maxPolarAngle=.45*Math.PI,o.target.set(0,0,0),o})(y,b),Me.maxPolarAngle=.46*Math.PI,Me.screenSpacePanning=!1,n.grid&&(Ee=(()=>{let e=new v(800,80,10592673,10592673);return e.material.opacity=.3,e.material.transparent=!0,e})(),u.add(Ee)),n.axesHelper){let e=new X(50);u.add(e)}Ve.isCruise=!1,St=1,null!=n.bgColor?u.background=n.bgColor?new P(n.bgColor):null:it(u,n.baseUrl,n.skyPath,n.skyCode),ct(),b.shadowMap.enabled=!0,b.shadowMap.type=W,Qe=new Z,Ye=new q,We=new V,n.loadCache?xt(qe,n.dbName||nt.indexdb.dbName,n.dbVersion||nt.indexdb.version).then((e=>{e?(ee.enabled=!0,Ze=e,Zt()):Zt()})):Zt(),b.domElement.addEventListener("dblclick",Rt),b.domElement.addEventListener("pointerdown",It),b.domElement.addEventListener("pointermove",Jt),b.domElement.addEventListener("pointerup",Ut)};return a((()=>{if(!n.models||0==n.models.length)throw new Error("模型数据不可为空");_o(),Je(),window.addEventListener("resize",De,!1)})),s((()=>{clearInterval(Ve.timer),window.removeEventListener("resize",De),window.removeEventListener("keyup",go),window.removeEventListener("keydown",vo),cancelAnimationFrame(Ie);try{u.clear(),b.dispose(),b.forceContextLoss(),b.content=null;let e=b.domElement.getContext("webgl");e&&e.getExtension("WEBGL_lose_context").loseContext()}catch(e){}})),t({floorAnimate:$t,setControls:e=>{"object"==typeof e&&Object.keys(e).forEach((t=>{Me[t]=e[t]}))},resize:De,update:()=>{const e=n.pipeModelType||[],t=[];if("function"!=typeof n.updateObjectCall)throw Error("未传入更新回调函数 updateObjectCall");Ve.devices.forEach(((o,a)=>{let s=o.data;if(!s)return;let i=s.type;if(i===n.dotKey)return void uo(o);if(e.includes(i))return;if(!s.deviceCode)return;const l=n.updateObjectCall(s);if(!l)return;if("object"!=typeof l)throw Error("更新回调函数返回对象不为 Object，当前类型："+typeof l);Object.keys(l).forEach((e=>{s[e]=l[e]})),t.push(H(s));let{status:r=0,error:c=0,remote:d=0,local:u=0,disabled:p=0}=s;const m=c>0?"error":r>0?"runing":"normal",f=Ve.colors[m];let h=f[i]||f.color;if("function"==typeof n.getColorCall){const e=n.getColorCall(s);e&&(h=e)}xo({type:i,el:o,colorObj:f,color:h,paused:0==r,error:c>0,remote:d>0,local:u>0,disabled:p>0})})),Ke("update",t)}}),(e,t)=>{var o;const n=G;return p(),N("div",{class:A(e.$style["three-scene"])},[e.devEnv?(p(),N("div",{key:0,class:A([e.$style.operation,"operation"]),onDblclick:t[0]||(t[0]=F((()=>{}),["stop"]))},[m(n,{onClick:wo,type:"success"},{default:r((()=>t[2]||(t[2]=[K("随机更新")]))),_:1}),(null==(o=e.cruisePoints)?void 0:o.length)?(p(),l(n,{key:0,onClick:bo,type:"warning"},{default:r((()=>t[3]||(t[3]=[K("巡航")]))),_:1})):R("",!0),m(n,{onClick:yo,type:"success"},{default:r((()=>t[4]||(t[4]=[K("场景坐标")]))),_:1}),m(n,{onClick:Ge,type:"warning"},{default:r((()=>t[5]||(t[5]=[K("切换背景")]))),_:1})],34)):R("",!0),$("div",{ref_key:"containerRef",ref:d,class:A(e.$style.container),onKeyup:go},null,34),c(tt).show?(p(),N("div",{key:1,class:A(["loading",e.$style.loading]),style:D({"--bg-color":e.bgColor?String(e.bgColor):""}),onDblclick:t[1]||(t[1]=F((()=>{}),["stop"]))},[$("div",{class:A(e.$style.progress),style:D({"--percentage":c(tt).percentage+"%"})},[$("div",{class:A(e.$style["bar-out"])},[$("div",{class:A(e.$style.bar)},null,2)],2),$("div",{class:A(e.$style.text)},I(c(tt).percentage)+"%",3)],6)],38)):R("",!0),c(ot).show?(p(),N("div",{key:2,class:A(e.$style.dialog),style:D(c(ot).style)},[J(e.$slots,"dialog",{data:c(ot).data,title:c(ot).title,pos:c(ot).pos})],6)):R("",!0)],2)}}}),[["__cssModules",{$style:{"three-scene":"_three-scene_1mewx_2",container:"_container_1mewx_11",operation:"_operation_1mewx_15",loading:"_loading_1mewx_22",progress:"_progress_1mewx_37","bar-out":"_bar-out_1mewx_41",bar:"_bar_1mewx_41","striped-flow":"_striped-flow_1mewx_1",text:"_text_1mewx_57",dialog:"_dialog_1mewx_73"}}]]),Ot={class:"plane-device__content"},Ct=["onClick","onMousedown"],kt={class:"device-item__wrap"},Mt=["src"],Et={class:"device-item--mark"},Lt={class:"device-item--text"},zt={key:2,class:"device-item--name"},St=e({name:"plane-device",__name:"index",props:{list:{},active:{},type:{},locked:{type:Boolean},display:{type:Boolean},showName:{type:Boolean},hideType:{}},emits:["click","mousedown","mouseup"],setup(e,{emit:t}){const o=Je(),n=e,a=e=>{var t;return!n.display||!(null==(t=n.hideType)?void 0:t.includes(e.type))},s=t,i=e=>{const{error:t=0,status:n=0}=e;let a=t>0?"error":n>0?"run":"normal",s=e.type;return[Ue.LDB,Ue.LQB].includes(s)?s="LDB":[Ue.LXJ,Ue.BSHLQ].includes(s)?s="LXJ":[Ue.LDFM,Ue.LQFM].includes(s)&&(s="FM"),`${o.oss}/img/device/${a}/${s}.png`},l=(e="")=>"℃"==e?"T":"kPa"==e?"AP":"m³/h"==e?"F":"";return(e,t)=>(p(),N("div",{class:A(["plane-device",{"is-locked":e.locked}])},[$("div",Ot,[(p(!0),N(Me,null,Ee(e.list,((o,n)=>Le((p(),N("div",{key:n,class:A(["device-item",{[o.type]:!0,"is-active":e.active==n}]),style:D({left:`${o.style.x}px`,top:`${o.style.y}px`,color:o.color,marginTop:`${o.my}px`,marginLeft:`${o.mx}px`,zIndex:o.zIndex}),onClick:t=>s("click",n,o,e.type),onMousedown:F((t=>s("mousedown",t,n,o,e.type)),["stop"]),onMouseup:t[0]||(t[0]=e=>s("mouseup",e))},[$("div",kt,[o.type!=c(Ue).DOT?(p(),N("img",{key:0,src:i(o),style:D({transform:`rotate(${o.rotate}deg)`})},null,12,Mt)):(p(),N(Me,{key:1},[$("div",Et,I(l(o.unit)),1),$("div",Lt,I(o.value??0)+I(o.unit),1)],64)),e.showName?(p(),N("div",zt,I(o.name)+I(o.deviceCode?`(${o.deviceCode})`:""),1)):R("",!0)])],46,Ct)),[[ze,a(o)]]))),128))])],2))}}),jt=[_t,St,e({name:"e-echarts",__name:"index",props:{height:{default:"100%"},width:{default:"100%"},zIndex:{},theme:{default:"light"},delay:{default:0},autoSize:{type:Boolean}},emits:["click-dom","click","dblclick","mousedown","mousemove","mouseup","mouseover","mouseout","globalout","contextmenu"],setup(e,{expose:t,emit:o}){const n=e,i=Re();j((()=>i.sidebar.opened),(e=>{n.autoSize&&setTimeout(m,300)}));const l=B();let r;const c=async()=>{const e=l.value;r=je(e),u()},d=o,u=()=>{r.on("click",(e=>{d("click",e)})),r.on("dblclick",(e=>{d("dblclick",e)})),r.on("mousedown",(e=>{d("mousedown",e)})),r.on("mousemove",(e=>{d("mousemove",e)})),r.on("mouseup",(e=>{d("mouseup",e)})),r.on("mouseover",(e=>{d("mouseover",e)})),r.on("mouseout",(e=>{d("mouseout",e)})),r.on("globalout",(e=>{d("globalout",e)})),r.on("contextmenu",(e=>{d("contextmenu",e)}))},m=()=>{r&&r.resize()};return a((()=>{n.delay>0?setTimeout((()=>{c(),n.autoSize&&window.addEventListener("resize",m,!1)}),n.delay):(c(),n.autoSize&&window.addEventListener("resize",m,!1))})),s((()=>{window.removeEventListener("resize",m,!1),r&&r.dispose()})),t({resize:m,loading:(e={})=>{let t={color:"#31d3f3",zlevel:9,textColor:"#fff",maskColor:"rgba(255, 255, 255, 0.1)"};Object.keys(e).forEach((o=>{t[o]=e[o]})),r&&r.showLoading(t)},hideLoading:()=>{r&&r.hideLoading()},registerMap:(e,t,o)=>new Se(e,t,o),setOption:e=>{r&&r.setOption(e)},update:e=>{r&&r.setOption(e)},dispatchAction:e=>{r&&r.dispatchAction(e)},getOption:()=>r?r.getOption():null,clear:()=>{r&&r.clear()}}),(e,t)=>(p(),N("div",{ref_key:"echartRef",ref:l,class:"e-echarts",style:D({height:"number"==typeof e.height?`${e.height}px`:e.height,width:"number"==typeof e.width?`${e.width}px`:e.width,zIndex:e.zIndex}),onClick:t[0]||(t[0]=e=>d("click-dom"))}," e-echart ",4))}})];let Bt="",Tt=!1;He.beforeEach((async(e,t,o)=>{o();try{await(async()=>{try{const e=(await fetch("/sys/manifest.json?v="+Date.now(),{method:"head"})).headers.get("ETag");Tt=!!Bt&&e!==Bt,Bt=e}catch(e){return Promise.reject(e)}})(),Tt&&Be.alert("系统有更新，请点击“立即刷新”刷新界面！","温馨提示",{showCancelButton:!0,confirmButtonText:"立即刷新",callback:e=>{"confirm"==e&&location.reload()}})}catch(n){}})),Te.configure({showSpinner:!1});const{t:Pt}=Xe.global;Ge.interceptors.request.use((e=>{let t=Ke().token;return t&&(e.headers.Authorization=t),e}),(e=>Promise.reject(e))),Ge.interceptors.response.use((e=>{var t;return 20010090===(null==(t=e.data)?void 0:t.code)&&Ke().resetToken().then((()=>{window.location.reload()})),e}),(e=>Promise.reject(e))),He.beforeEach((async(e,t,o)=>{Te.start();const n=document,a=e.meta.title;Re().i18n?n.title=a?Pt(`route.${a}`).toUpperCase():"loading...":n.title=a;const s=Ke(),i=s.token,l=`${Qe}/login`;if(i)if(e.path==l)o({path:`${Qe}/`}),Te.done();else{if(e.path==`${Qe}/index`)return o({path:`${Qe}/`}),void Te.done();if(s.powers&&s.powers.length>0)o();else try{const{permissions:t}=await s.getUserInfo(),n=Ye();(await n.generateRoutes(t)).forEach((e=>{He.hasRoute(e.name)||He.addRoute(e)})),o({...e,replace:!0})}catch(r){await s.resetToken(),o(`${l}?redirect=${e.path}`),Te.done()}}else e.path==l?o():(o(`${l}?redirect=${e.path}`),Te.done())})),He.afterEach((()=>{Te.done()}));const Nt=(e,t,o)=>{let n={};return"string"==typeof e||e instanceof Array?n=e:(null!=t&&(n.msg=t),null!=o&&(n.code=o),"object"==typeof e&&Object.keys(e).forEach((t=>{n[t]=e[t]}))),n},At=Nt,Ft=[{url:"/user/login",method:"post",response:()=>At({token_type:"bearer",access_token:Pe.mock("@guid")})},{url:"/user/logout",method:"get",response:()=>At({},"退出登录")},{url:"/user/changePwd",method:"post",response:()=>At({},"密码修改成功")},{url:"/user/getUserInfo",method:"get",response:()=>At({sysUser:{id:Pe.mock("@id"),name:Pe.mock("@cname"),account:Pe.mock("@first"),avatar:Pe.Random.image("50x50",Pe.mock("@hex"),"E")},permissions:["ALL_SN"]})}];Pe.Random.extend({phone:function(){return this.pick(["132","135","188","158","178"])+Pe.mock(/\d{8}/)},family:function(){return this.pick(["汉族","满族","彝族","藏族","傣族"])}});const Rt=Nt,$t=[{url:"/test/list",method:"get",response:()=>Rt(Pe.mock({"Total|20-100":100,"Data|10":[{Name:"@cname",Phone:"@phone",Email:"@email",Family:"@family",Id:"@id","Age|10-40":100,"Income|3000-40000":100,Birthday:"@datetime(yyyy-MM-dd)",Region:"@region",Province:"@province",City:"@city",County:"@county",Remark:"@csentence",hasChildren:"@boolean","childrens|2":[{Name:"@cname",Phone:"@phone",Email:"@email",Family:"@family",Id:"@id","Age|10-40":100,"Income|3000-40000":100,Birthday:"@datetime(yyyy-MM-dd)",Region:"@region",Province:"@province",City:"@city",County:"@county",Remark:"@csentence"}]}]}))},{url:"/test/add",method:"post",response:()=>Rt({},"添加成功")},{url:"/test/update",method:"put",response:()=>Rt({},"更新成功")},{url:"/test/get",method:"get",response:()=>Rt(Pe.mock({name:"@cname",phone:"@phone",email:"@email",family:"@family",id:"@id","age|10-40":100,"income|3000-40000":100,birthday:"@datetime(yyyy-MM-dd)",region:"@region",province:"@province",city:"@city",county:"@county",remark:"@csentence"}))},{url:"/test/del",method:"delete",response:()=>Rt({},"删除成功")},{url:"/test/items",method:"get",response:()=>Rt(Pe.mock({"Data|3-10":[{"label|1-5":"★","value|+1":1,"disabled|1-3":!0}]}))},{url:"/test/group",method:"get",response:()=>Rt(Pe.mock({"Data|1-3":[{"label|1":["Vue","Vite","Typescript","Pinia"],"value|+1":1,"disabled|1-3":!0,"children|3-8":[{"label|1-5":"★","value|+1":1,"disabled|1-3":!0}]}]}))}],Dt=[...[{url:"/monitor/get_config",method:"get",response:e=>{const{id:t}=e.query||{};if("123456"==t)return Nt({id:1,name:"制冷站监测系统"})}}]],It=[{url:"/d3/map",method:"get",response:()=>Nt(Pe.mock({"list|5-34":[{code:"@guid",province:"@province","total|0-100000":0,"projects|1-10":[{"lng|80-120.0-6":0,"lat|25-45.0-6":0,name:"@cword(5,10)","carbon|0-10000":0,"use|0-1000000":0,id:"@guid"}]}],lines:[{path:"乌鲁木齐市 - 东城区",coords:[[87.617733,43.792818],[116.418757,39.917544]]},{path:"乌鲁木齐市 - 深圳市",coords:[[114.085947,22.547],[87.617733,43.792818]]},{path:"拉萨市 - 东城区",coords:[[91.132212,29.660361],[116.418757,39.917544]]},{path:"拉萨市 - 南京市",coords:[[91.132212,29.660361],[118.767413,32.041544]]},{path:"拉萨市 - 昆明市",coords:[[91.132212,29.660361],[102.712251,25.040609]]},{path:"拉萨市 - 深圳市",coords:[[114.085947,22.547],[91.132212,29.660361]]},{path:"昆明市 - 深圳市",coords:[[114.085947,22.547],[102.712251,25.040609]]},{path:"昆明市 - 长沙市",coords:[[102.712251,25.040609],[112.982279,28.19409]]},{path:"西宁市 - 深圳市",coords:[[114.085947,22.547],[101.778916,36.623178]]},{path:"兰州市 - 深圳市",coords:[[114.085947,22.547],[103.823557,36.058039]]},{path:"太原市 - 深圳市",coords:[[114.085947,22.547],[112.549248,37.857014]]},{path:"西安市 - 深圳市",coords:[[114.085947,22.547],[108.948024,34.263161]]},{path:"南昌市 - 深圳市",coords:[[114.085947,22.547],[115.892151,28.676493]]},{path:"海口市 - 深圳市",coords:[[114.085947,22.547],[110.33119,20.031971]]},{path:"嘉兴市 - 深圳市",coords:[[114.085947,22.547],[120.750865,30.762653]]},{path:"成都市 - 深圳市",coords:[[114.085947,22.547],[104.065735,30.659462]]},{path:"唐山市 - 深圳市",coords:[[114.085947,22.547],[118.175393,39.635113]]}]}))}],Jt={FLOOR_ONE:138,FLOOR_ATTIC:350,FLOOR_COMMON:60},Ut=["FLOOR_ONE","FLOOR_COMMON","FLOOR_COMMON","FLOOR_COMMON","FLOOR_COMMON","FLOOR_COMMON","FLOOR_COMMON","FLOOR_COMMON","FLOOR_COMMON","FLOOR_COMMON","FLOOR_COMMON","FLOOR_COMMON","FLOOR_COMMON","FLOOR_COMMON","FLOOR_COMMON","FLOOR_COMMON","FLOOR_COMMON","FLOOR_COMMON","FLOOR_COMMON","FLOOR_COMMON","FLOOR_COMMON","FLOOR_ATTIC"];let Ht=[{name:"摄像头",type:"COLD_CAMERA",position:{x:0,y:500,z:300}},{name:"房间入口",type:"COLD_ROOM_INLET",position:{x:100,y:500,z:300}},{name:"定位",type:"COLD_GPS",position:{x:200,y:500,z:300}},{name:"DOT",unit:"%",type:"DOT",position:{x:300,y:500,z:350}}],Xt=0;for(let Wt=0;Wt<Ut.length;Wt++)Xt+=Jt[Ut[Wt-1]]??0,Ht.push({name:`${Wt+1}楼`,type:Ut[Wt],mark:Ut[Wt]+"_"+Wt,position:{x:0,y:Xt,z:0}});Ht.push({name:"DOT",unit:"%",type:"DOT",followMark:"FLOOR_COMMON_3",position:{x:0,y:260,z:100}});const Gt=[...It,...[{url:"/d3/floor",method:"get",response:()=>Nt({JsonList:Ht,ModelUrl:"/oss/model/floor/场景.glb",Name:"楼层展示",ConfigJson:{floorExpandMargin:450,floorExpandMode:"BA",target:{x:0,y:459,z:0},to:{x:17.6,y:673,z:1660}}})}]],Kt={splitList:[{start:100,end:100,label:"北京公司"},{start:101,end:101,label:"上海公司"},{start:102,end:102,label:"杭州公司"},{start:103,end:103,label:"武汉公司"},{start:104,end:104,label:"广深公司"},{start:105,end:105,label:"西安公司"},{start:106,end:106,label:"西北公司"}],cityJson:[{name:"北京",value:100},{name:"天津",value:100},{name:"山东",value:100},{name:"辽宁",value:100},{name:"黑龙江",value:100},{name:"上海",value:101},{name:"江苏",value:101},{name:"安徽",value:101},{name:"浙江",value:102},{name:"江西",value:102},{name:"福建",value:102},{name:"湖北",value:103},{name:"湖南",value:103},{name:"河南",value:103},{name:"广东",value:104},{name:"广西",value:104},{name:"重庆",value:105},{name:"陕西",value:105},{name:"四川",value:105},{name:"贵州",value:105},{name:"云南",value:105},{name:"新疆",value:106},{name:"西藏",value:106}],areaName:{"安徽":"anhui.json","澳门":"aomen.json","北京":"beijing.json","重庆":"chongqing.json","福建":"fujian.json","甘肃":"gansu.json","广东":"guangdong.json","广西":"guangxi.json","贵州":"guizhou.json","海南":"hainan.json","河北":"hebei.json","黑龙江":"heilongjiang.json","河南":"henan.json","湖北":"hubei.json","湖南":"hunan.json","江苏":"jiangsu.json","江西":"jiangxi.json","吉林":"jilin.json","辽宁":"liaoning.json","内蒙古":"neimenggu.json","宁夏":"ningxia.json","青海":"qinghai.json","山东":"shandong.json","上海":"shanghai.json","山西":"shanxi.json","山西1":"shanxi1.json","四川":"sichuan.json","台湾":"taiwan.json","天津":"tianjin.json","香港":"xianggang.json","新疆":"xinjiang.json","西藏":"xizang.json","云南":"yunnan.json","浙江":"zhejiang.json"},points:[{value:[116.418757,39.917544],name:"东城区"},{value:[87.617733,43.792818],name:"乌鲁木齐市"},{value:[91.132212,29.660361],name:"拉萨市"},{value:[118.175393,39.635113],name:"唐山市"},{value:[101.778916,36.623178],name:"西宁市"},{value:[103.823557,36.058039],name:"兰州市"},{value:[112.549248,37.857014],name:"太原市"},{value:[108.948024,34.263161],name:"西安市"},{value:[118.767413,32.041544],name:"南京市"},{value:[102.712251,25.040609],name:"昆明市"},{value:[104.065735,30.659462],name:"成都市"},{value:[112.982279,28.19409],name:"长沙市"},{value:[115.892151,28.676493],name:"南昌市"},{value:[110.33119,20.031971],name:"海口市"},{value:[120.750865,30.762653],name:"嘉兴市"},{value:[114.085947,22.547],name:"深圳市"}],scatters:[{value:[117.012247,39.139446],name:"天津西青印象城-商场",city:"天津",id:2201},{value:[113.686037,34.775838],name:"郑州金水印象汇",city:"郑州,金水",id:37101},{value:[114.352482,36.103442],name:"安阳印象汇",city:"河南,安阳",id:37201},{value:[120.153576,30.287459],name:"杭州西溪印象城",city:"浙江,杭州",id:57101},{value:[121.153576,30.287459],name:"杭州奥体印象城",city:"浙江,杭州",id:57102},{value:[121.549792,29.868388],name:"宁波东部印象城",city:"浙江,宁波",id:57401},{value:[121.949792,29.868388],name:"宁波鄞州印象城",city:"浙江,宁波",id:57402},{value:[121.949792,29.568388],name:"宁波海曙印象城",city:"浙江,宁波",id:57403},{value:[120.672111,28.000575],name:"温州印象城",city:"浙江,温州",id:57701},{value:[118.589421,24.908853],name:"泉州印象汇",city:"福建,泉州",id:59501},{value:[117.661801,24.510897],name:"漳州印象汇",city:"福建,漳州",id:59601},{value:[112.355042,28.570066],name:"益阳印象汇",city:"湖南,益阳",id:73701},{value:[113.746262,23.046237],name:"东莞南城印象汇",city:"广东,东莞",id:76901}],lines:[{path:"乌鲁木齐市 - 东城区",coords:[[87.617733,43.792818],[116.418757,39.917544]],lineStyle:{color:"#ffffff"}},{path:"乌鲁木齐市 - 深圳市",coords:[[114.085947,22.547],[87.617733,43.792818]],lineStyle:{color:"#ffffff"}},{path:"拉萨市 - 东城区",coords:[[91.132212,29.660361],[116.418757,39.917544]],lineStyle:{color:"#ffffff"}},{path:"拉萨市 - 南京市",coords:[[91.132212,29.660361],[118.767413,32.041544]],lineStyle:{color:"#ffffff"}},{path:"拉萨市 - 昆明市",coords:[[91.132212,29.660361],[102.712251,25.040609]],lineStyle:{color:"#ffffff"}},{path:"拉萨市 - 深圳市",coords:[[114.085947,22.547],[91.132212,29.660361]],lineStyle:{color:"#ffffff"}},{path:"昆明市 - 深圳市",coords:[[114.085947,22.547],[102.712251,25.040609]],lineStyle:{color:"#ffffff"}},{path:"昆明市 - 长沙市",coords:[[102.712251,25.040609],[112.982279,28.19409]],lineStyle:{color:"#ffffff"}},{path:"西宁市 - 深圳市",coords:[[114.085947,22.547],[101.778916,36.623178]],lineStyle:{color:"#ffffff"}},{path:"兰州市 - 深圳市",coords:[[114.085947,22.547],[103.823557,36.058039]],lineStyle:{color:"#ffffff"}},{path:"太原市 - 深圳市",coords:[[114.085947,22.547],[112.549248,37.857014]],lineStyle:{color:"#ffffff"}},{path:"西安市 - 深圳市",coords:[[114.085947,22.547],[108.948024,34.263161]],lineStyle:{color:"#ffffff"}},{path:"南昌市 - 深圳市",coords:[[114.085947,22.547],[115.892151,28.676493]],lineStyle:{color:"#ffffff"}},{path:"海口市 - 深圳市",coords:[[114.085947,22.547],[110.33119,20.031971]],lineStyle:{color:"#ffffff"}},{path:"嘉兴市 - 深圳市",coords:[[114.085947,22.547],[120.750865,30.762653]],lineStyle:{color:"#ffffff"}},{path:"成都市 - 深圳市",coords:[[114.085947,22.547],[104.065735,30.659462]],lineStyle:{color:"#ffffff"}},{path:"唐山市 - 深圳市",coords:[[114.085947,22.547],[118.175393,39.635113]],lineStyle:{color:"#ffffff"}}]},Qt=[...Ft,...$t,...Dt,...Gt,...[...[{url:"/echarts/map",method:"get",response:()=>Nt(Pe.mock({"list|5-34":[{code:"@guid",province:"@province","total|0-100000":0,"projects|1-10":[{"lng|80-120.0-6":0,"lat|25-45.0-6":0,name:"@cword(5,10)","carbon|0-10000":0,"use|0-1000000":0,id:"@guid"}]}]}).list)},{url:"/echarts/get",methods:"get",response:()=>Nt(Kt)}]]].map((e=>(e.url="/mock"+e.url,e)));const Yt=Ae(qe);Yt.directive("focus",{mounted(e){e.focus()}}),Yt.use(Fe()).use(He).use(Xe).use(We).use((function(e){jt.forEach((t=>{e.component(t.name,t)}))})).use(Ze).mount("#app"),Ne([...Qt]);export{_t as _,St as a};
