var e=Object.defineProperty,s=(s,t,a)=>(((s,t,a)=>{t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a})(s,"symbol"!=typeof t?t+"":t,a),a);import{ex as t,ey as a,ez as n,bc as r,eA as o,dU as i,dS as d,eB as l,e as c,Y as u,i as p,l as m,o as h,g,h as v}from"./vendor-ccff1e05.js";import{v as b,u as f,a as w,o as x}from"./scene-resize-4d8942ca.js";import"./index-1d4c3275.js";const{pass:y,mrt:_,output:j,emissive:M}=l;class P extends b{constructor(e){super(e),s(this,"gui"),s(this,"postProcessing");const o=y(this.scene,this.camera);o.setMRT(_({output:j,emissive:M}));const i=o.getTextureNode(),d=o.getTextureNode("emissive"),l=t(d,2.5,.5);this.renderer.toneMapping=a;const c=new n(this.renderer);c.outputNode=i.add(l),this.postProcessing=c,this.gui=new r,this.addGui(l)}setEnv(e){this.scene.environment=e,this.scene.background=e}createRender(){return new o}createAmbientLight(e,s){return new i(e,s)}createDirectionalLight(e,s){return new d(e,s)}addGui(e){var s;const t=this.gui,a=t.addFolder("发光");a.add(e.threshold,"value",0,1).step(.01).name("阈值/起点"),a.add(e.strength,"value",0,3).step(.01).name("强度"),a.add(e.radius,"value",0,1).step(.01).name("半径"),a.open();const n=t.addFolder("色调映射");n.add(this.renderer,"toneMappingExposure",.1,3).name("曝光"),n.open(),t.domElement.className+=" gui-wrap",null==(s=this.container.parentNode)||s.appendChild(t.domElement)}animate(){this.postProcessing.renderAsync()}}const z={class:"three-page"},N=c({__name:"index",setup(e){const s=u({base:"",models:[{key:"helmet",name:"头盔",size:3.4,url:"/oss/model/gpu/头盔.glb"}],objects:[{type:"helmet",name:"头盔"}]}),{progress:t,loadModels:a,getModel:n,initModels:r}=f.useModelLoader({baseUrl:s.base}),o=p(),i={baseUrl:s.base,env:"/oss/textures/hdr/moonless_golf_1k.hdr",camera:{position:[0,0,10]}};let d;return m((()=>{i.container=o.value,d=new P(i).run(),w(d).resize(),a(s.models,(()=>{t.percentage=100,t.show=!1,r(s.objects,(e=>{const{type:s}=e,t=n(s);if(!t)return Promise.resolve();let a=x.modelDeepClone(t);const{position:r,scale:o,rotation:i}=x.get_P_S_R_param(a,e),[l,c,u]=r;return a.scale.set(...o),a.position.set(l,c,u),a.rotation.set(...i),d.addObject(a),Promise.resolve()}))}))})),(e,s)=>(h(),g("div",z,[v("div",{class:"h-100",ref_key:"containerRef",ref:o},null,512)]))}});export{N as default};
//# sourceMappingURL=index-d7b46d79.js.map
