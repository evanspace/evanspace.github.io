var e=Object.defineProperty,t=(t,s,n)=>(((t,s,n)=>{s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n})(t,"symbol"!=typeof s?s+"":s,n),n);import{m as s,u as n}from"./scene-resize-d21ed253.js";import{b6 as a,dA as o,ek as i,be as r,el as d,bc as c,ba as l,ej as u,em as m,e as p,i as h,l as w,o as f,g,h as b}from"./vendor-43c1f6dd.js";import"./index-3b97ade4.js";const v=m,x=new a,N=v.uniform(.2);class y extends s{constructor(e){super(e),t(this,"gui"),t(this,"smokeInstancedSprite"),t(this,"fireInstancedSprite");const s=this.createGround();this.addObject(s),this.addModel(),this.gui=new o,this.addGui()}createRender(){return new i(this.options.render)}addModel(){const e=v.range(.1,1),t=v.range(new r(-2,3,-2),new r(2,5,2)),s=v.time.add(5).mul(N),n=s.mul(e).mod(1),a=v.range(.3,2),o=v.range(.1,4),i=n.div(e),m=v.positionLocal.y.oneMinus().max(.2),p=v.texture(x.load("/oss/textures/effect/smoke1.png"),v.rotateUV(v.uv(),s.mul(o))).a.mul(i.oneMinus()),h=v.mix(v.color(16777215),v.color(2236962),v.positionLocal.y.mul(.5).clamp()),w=new d;w.colorNode=v.mix(v.color(15891724),h,i.mul(2.5).min(1)).mul(m),w.opacityNode=p,w.positionNode=t.mul(n),w.scaleNode=a.mul(n.max(.3)),w.depthWrite=!1,w.transparent=!0;const f=new c(new l(1,1),w);f.scale.setScalar(40),f.count=2e3,f.position.y=10,f.castShadow=!0,this.smokeInstancedSprite=f,this.addObject(f);const g=new l(1,1),b=new d;b.colorNode=v.mix(v.color(12005143),v.color(12005143),i),b.positionNode=v.range(new r(-1,1,-1),new r(1,2,1)).mul(n),b.scaleNode=w.scaleNode,b.opacityNode=p.mul(.5),b.blending=u,b.transparent=!0,b.depthWrite=!1;const y=new c(g,b);y.scale.setScalar(40),y.count=1e3,y.position.y=10,y.castShadow=!0,this.fireInstancedSprite=y,this.addObject(y)}addGui(){var e;const t=this.gui;t.add(N,"value",.01,1,.01).name("烟雾速度"),t.add(this.fireInstancedSprite,"count",200,2e3).name("烟雾浓度").onChange((e=>{this.smokeInstancedSprite.count=2*e})),t.domElement.className+=" gui-wrap",null==(e=this.container.parentNode)||e.appendChild(t.domElement)}}const S={class:"three-page"},j=p({__name:"index",setup(e){const t=h(),s={grid:{visible:!0},axes:{visible:!0},render:{logarithmicDepthBuffer:!1}};let a;return w((()=>{s.container=t.value,a=new y(s),a.run(),n(a).resize()})),(e,s)=>(f(),g("div",S,[b("div",{class:"h-100",ref_key:"containerRef",ref:t},null,512)]))}});export{j as default};
