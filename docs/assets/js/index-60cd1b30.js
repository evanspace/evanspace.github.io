import{dQ as e,dR as a,dS as t,dT as n,e as o,i,dU as s,d5 as r,Y as d,l,af as c,o as m,g as u,h as p,dV as h,dW as w,dX as g,bn as f,be as x,bp as v,bq as C,br as y,dY as b,dp as S,cZ as E,bf as z,bg as P,d1 as M}from"./vendor-5808cc93.js";import{f as D}from"./index-1dbebe74.js";const W={class:"page h-100"},R=o({__name:"index",setup(o){const R=D(),F=i(),G=new s;let _,j,A,H;G.background=new r("#fff");const L=()=>{H=new h(16777215,1.5),G.add(H),((e=16777215,a=1,t=800,o=2048,i=1,s=2e3)=>{const r=new n(e,a);r.position.set(500,800,500),r.castShadow=!0,r.shadow.camera.near=i,r.shadow.camera.far=s,r.shadow.camera.right=t,r.shadow.camera.left=-t,r.shadow.camera.top=t,r.shadow.camera.bottom=-t,r.shadow.mapSize.set(o,o)})(16777215,1.5)},T=()=>{const e=F.value;if(!_)return;const a=e.clientWidth,t=e.clientHeight,n=a/t;_.aspect=n,_.updateProjectionMatrix(),j.setSize(a,t)};let k;const I=()=>{k=requestAnimationFrame(I),q(),j.render(G,_)},q=()=>{let e=.001*performance.now();$.position.y=20*Math.sin(e)+5,$.rotation.x=.5*e,$.rotation.z=.51*e,N.material.uniforms.time.value+=1/60},Y=d({turbidity:10,rayleigh:2,mieCoefficient:.005,mieDirectionalG:.2,elevation:2,azimuth:180,exposure:null});let B;let N;const Q=()=>{const e=new x(1e4,1e4);N=new v(e,{textureWidth:512,textureHeight:512,waterNormals:(new C).load(`${R.oss}/textures/waternormals.jpg`,(e=>{e.wrapS=e.wrapT=y})),sunDirection:new f,sunColor:16777215,waterColor:7695,distortionScale:3.7,fog:void 0!==G.fog}),N.rotation.x=-Math.PI/2,G.add(N)};let U;const V=()=>{U=new b,U.scale.setScalar(1e4),G.add(U)};let X;const Z=()=>{const e=U.material.uniforms;e.turbidity.value=Y.turbidity,e.rayleigh.value=Y.rayleigh,e.mieCoefficient.value=Y.mieCoefficient,e.mieDirectionalG.value=Y.mieDirectionalG;const a=S.degToRad(90-Y.elevation),t=S.degToRad(Y.azimuth);X.setFromSphericalCoords(1,a,t),U.material.uniforms.sunPosition.value.copy(X),N.material.uniforms.sunDirection.value.copy(X).normalize(),G.environment=B.fromScene(U).texture,j.toneMappingExposure=Y.exposure};let $;const J=()=>{let e=new E(30,30,30),a=new z({roughness:0,color:1365});$=new P(e,a),G.add($)},K=()=>{const n=F.value;j=(a=>{const t=a.clientWidth,n=a.clientHeight,o=new e({antialias:!0});return o.setSize(t,n),o.setPixelRatio(window.devicePixelRatio),a.appendChild(o.domElement),o})(n),_=((e,t=.1,n=1e4)=>{const o=e.clientWidth,i=e.clientHeight,s=new a(36,o/i,t,n);return s.position.set(-350,510,700),s})(n,1,1e6),L(),A=((e,a)=>{const n=new t(e,a.domElement);return n.minDistance=.1,n.maxPolarAngle=.495*Math.PI*1.1,n.target.set(0,20,0),n})(_,j),A.maxPolarAngle=.45*Math.PI,A.screenSpacePanning=!1,Q(),V(),j.toneMapping=w,j.toneMappingExposure=1,Y.exposure=j.toneMappingExposure,B=new g(j),X=new f,Z(),J(),(e=>{const a=new M,t=a.addFolder("Sky");t.add(Y,"turbidity",0,100,.1).name("浑浊").onChange(Z),t.add(Y,"rayleigh",0,4,.001).name("锐利").onChange(Z),t.add(Y,"mieCoefficient",0,.1,.001).name("散射系数").onChange(Z),t.add(Y,"mieDirectionalG",0,1,.001).name("方向").onChange(Z),t.add(Y,"elevation",0,90,.1).name("高度").onChange(Z),t.add(Y,"azimuth",-180,180,.1).name("方位").onChange(Z),t.add(Y,"exposure",0,1,1e-4).name("光晕强度").onChange(Z);const n=a.addFolder("Water"),o=N.material.uniforms;n.add(o.distortionScale,"value",0,100,.1).name("变形尺度"),n.add(o.size,"value",.1,10,.1).name("大小"),a.domElement.style="position: absolute; top: 10px; right: 10px",e.appendChild(a.domElement)})(n)};return l((()=>{K(),I(),window.addEventListener("resize",T,!1)})),c((()=>{window.addEventListener("resize",T,!1),cancelAnimationFrame(k);try{G.clear(),j.dispose(),j.forceContextLoss(),j.content=null;let e=j.domElement.getContext("webgl");e&&e.getExtension("WEBGL_lose_context").loseContext()}catch(e){}})),(e,a)=>(m(),u("div",W,[p("div",{ref_key:"containerRef",ref:F,class:"container h-100",style:{position:"relative"}},null,512)]))}});export{R as default};
