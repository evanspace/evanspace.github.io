import{c as e,aT as t,aU as o,e as n,l as r,ae as s,Z as a,m as i,q as c,u as d,B as l,aV as u,o as m,s as p,N as h,aW as y,aX as f,aY as g,aZ as k}from"./vendor-828bb737.js";import{u as v,d as b,a as w,i as E,s as P,b as I,r as R,c as $,e as A,f as L,g as N}from"./common-404c9468.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const _=e({__name:"App",setup(e){const h=v(),y={zhCN:{...t,...b},en:{...o,...w}},f=n((()=>h.language)),g=(e,t="href")=>{const o=e.dataset[t];return e.removeAttribute("data-"+t),""+o};(()=>{const e=document.querySelector('link[rel="icon"]');e.href=g(e);const t=document.querySelector('link[rel="manifest"]');t.href=g(t)})(),r((()=>{k(),window.addEventListener("resize",k,!1)})),s((()=>{window.removeEventListener("resize",k)}));const k=()=>{h.sidebar.opened&&document.body.clientWidth,P()},E=a({width:1920,size:14}),P=()=>{let e=(document.getElementById("app").clientWidth||E.width)*(E.size/E.width);document.documentElement.style.fontSize=e+"px"};return(e,t)=>{const o=l("router-view"),n=u;return m(),i(n,{locale:y[d(f)],namespace:"el"},{default:c((()=>[p(o)])),_:1},8,["locale"])}}}),j=[];h.configure({showSpinner:!1});const{t:z}=E.global;P.interceptors.request.use((e=>{let t=I().token;return t&&(e.headers.Authorization=t),e}),(e=>Promise.reject(e))),P.interceptors.response.use((e=>{var t;return 20010090===(null==(t=e.data)?void 0:t.code)&&I().resetToken().then((()=>{window.location.reload()})),e}),(e=>Promise.reject(e))),R.beforeEach((async(e,t,o)=>{h.start();const n=document,r=e.meta.title;v().i18n?n.title=r?z(`route.${r}`).toUpperCase():"loading...":n.title=r;const s=I(),a=s.token,i=`${$}/login`;if(a)if(e.path==i)o({path:`${$}/`}),h.done();else{if(e.path==`${$}/index`)return o({path:`${$}/`}),void h.done();if(s.powers&&s.powers.length>0)o();else try{const{permissions:t}=await s.getUserInfo(),n=A();(await n.generateRoutes(t)).forEach((e=>{R.hasRoute(e.name)||R.addRoute(e)})),o({...e,replace:!0})}catch(c){await s.resetToken(),o(`${i}?redirect=${e.path}`),h.done()}}else e.path==i?o():(o(`${i}?redirect=${e.path}`),h.done())})),R.afterEach((()=>{h.done()}));let C={code:0,msg:"",data:null,_header:null};const M=(e,t="ok",o=0,n)=>(C.msg=t,C.code=o,"string"==typeof e||e instanceof Array?C.data=e:Object.keys(e).forEach((t=>{C[t]=e[t]})),null!==n&&"object"==typeof n&&Object.keys(n).length>0&&(C._header=n),C),S=M,q=[{url:"/user/login",method:"post",response:()=>S({token_type:"bearer",access_token:y.mock("@guid")})},{url:"/user/logout",method:"get",response:()=>S({},"退出登录")},{url:"/user/changePwd",method:"post",response:()=>S({},"密码修改成功")},{url:"/user/getUserInfo",method:"get",response:()=>S({sysUser:{id:y.mock("@id"),name:y.mock("@cname"),account:y.mock("@first"),avatar:y.Random.image("50x50",y.mock("@hex"),"E")},permissions:["ALL_SN"]})}];y.Random.extend({phone:function(){return this.pick(["132","135","188","158","178"])+y.mock(/\d{8}/)},family:function(){return this.pick(["汉族","满族","彝族","藏族","傣族"])}});const x=M,O=[...q,...[{url:"/test/list",method:"get",response:()=>x(y.mock({"Total|20-100":100,"Data|10":[{Name:"@cname",Phone:"@phone",Email:"@email",Family:"@family",Id:"@id","Age|10-40":100,"Income|3000-40000":100,Birthday:"@datetime(yyyy-MM-dd)",Region:"@region",Province:"@province",City:"@city",County:"@county",Remark:"@csentence",hasChildren:"@boolean","childrens|2":[{Name:"@cname",Phone:"@phone",Email:"@email",Family:"@family",Id:"@id","Age|10-40":100,"Income|3000-40000":100,Birthday:"@datetime(yyyy-MM-dd)",Region:"@region",Province:"@province",City:"@city",County:"@county",Remark:"@csentence"}]}]}))},{url:"/test/add",method:"post",response:()=>x({},"添加成功")},{url:"/test/update",method:"put",response:()=>x({},"更新成功")},{url:"/test/get",method:"get",response:()=>x(y.mock({name:"@cname",phone:"@phone",email:"@email",family:"@family",id:"@id","age|10-40":100,"income|3000-40000":100,birthday:"@datetime(yyyy-MM-dd)",region:"@region",province:"@province",city:"@city",county:"@county",remark:"@csentence"}))},{url:"/test/del",method:"delete",response:()=>x({},"删除成功")},{url:"/test/items",method:"get",response:()=>x(y.mock({"Data|3-10":[{"label|1-5":"★","value|+1":1,"disabled|1-3":!0}]}))},{url:"/test/group",method:"get",response:()=>x(y.mock({"Data|1-3":[{"label|1":["Vue","Vite","Typescript","Pinia"],"value|+1":1,"disabled|1-3":!0,"children|3-8":[{"label|1-5":"★","value|+1":1,"disabled|1-3":!0}]}]}))}]].map((e=>(e.url="/mock"+e.url,e)));const T=g(_);T.directive("focus",{mounted(e){e.focus()}}),T.use(k()).use(R).use(E).use(L).use((function(e){j.forEach((t=>{e.component(t.name,t)}))})).use(N).mount("#app"),f([...O]);
