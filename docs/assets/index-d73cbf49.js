import{w as e,a as s,t as a,u as o,x as r,s as l}from"./element-plus-c17a5b2d.js";import{u as t,b as d}from"./index-db953908.js";import{u as p}from"./vue-router-d68a7028.js";import{d as i,r as n,G as u,c as m,K as w,O as c,o as f,a as j,u as v,S as g,bj as b,bh as _}from"./@vue-a65f2bcd.js";import{_ as h}from"./common-483d9c9f.js";import"./lodash-es-e892efce.js";import"./async-validator-cf877c1f.js";import"./@vueuse-98deaf90.js";import"./@element-plus-a81da9ad.js";import"./@ctrl-91de2ec7.js";import"./@popperjs-b78c3215.js";import"./pinia-7137c8a0.js";import"./vue-i18n-685a72aa.js";import"./@intlify-6938da42.js";import"./vue-d9a30721.js";import"./path-to-regexp-b4f1402b.js";import"./path-browserify-1e9555d6.js";import"./nprogress-8c9189ea.js";import"./vite-plugin-mock-91d15c87.js";import"./mockjs-aec3d243.js";import"./axios-9048dd51.js";const P={class:"content"},y=(e=>(b("data-v-669ebc71"),e=e(),_(),e))((()=>j("div",{class:"clearfix"},[j("span",null,"修改密码")],-1))),$={class:"change-pwd"},V=h(i({__name:"index",setup(i){const b=n(null),_=u({password:"",newPassword:"",confirmNewPassword:""}),h=n(!1),V={password:[{required:!0,trigger:"blur",message:"请输入旧密码。"}],newPassword:[{trigger:"blur",required:!0,validator:(e,s,a)=>{if(""===s)a(new Error("请输入密码"));else{const e=b.value;""!==_.confirmNewPassword&&e.validateField("confirmNewPassword"),(s.length<6||s.length>24)&&a(new Error("确保至少包含6个或最多24个字符"));/^(?![a-zA-Z]+$)(?![A-Z0-9]+$)(?![A-Z\W_!@#$%^&*`~()-+=]+$)(?![a-z0-9]+$)(?![a-z\W_!@#$%^&*`~()-+=]+$)(?![0-9\W_!@#$%^&*`~()-+=]+$)[a-zA-Z0-9\W_!@#$%^&*`~()-+=]/.test(s)||a(new Error("密码必须包含数字，特殊字符，小写字母，大写字母其中三项")),s===_.password&&a(new Error("新密码不能与旧密码相同")),a()}}}],confirmNewPassword:[{trigger:"blur",required:!0,validator:(e,s,a)=>{""===s?a(new Error("请再次输入密码")):s!==_.newPassword?a(new Error("两个输入不匹配！")):a()}}]},x=t(),N=p(),E=()=>{b.value.validate((e=>{if(!e)return!1;h.value=!0;const a={..._};x.changePwd(a).then((async()=>{s({type:"success",title:"提示",message:"密码修改成功！"}),await x.logout(),N.push(`${d}/login`)}))}))},k=()=>{b.value.resetFields()};return(s,t)=>{const d=a,p=o,i=r,n=l,u=e;return f(),m("div",P,[w(u,{class:"box-card"},{header:c((()=>[y])),default:c((()=>[j("div",$,[w(n,{ref_key:"formRef",ref:b,model:v(_),rules:V,"status-icon":"","label-position":"top"},{default:c((()=>[w(p,{label:"旧密码",prop:"password"},{default:c((()=>[w(d,{modelValue:v(_).password,"onUpdate:modelValue":t[0]||(t[0]=e=>v(_).password=e),type:"password",placeholder:"旧密码",clearable:"","show-password":"",autocomplete:"off"},null,8,["modelValue"])])),_:1}),w(p,{label:"新密码",prop:"newPassword"},{default:c((()=>[w(d,{modelValue:v(_).newPassword,"onUpdate:modelValue":t[1]||(t[1]=e=>v(_).newPassword=e),type:"password",placeholder:"新密码",clearable:"","show-password":"",autocomplete:"off"},null,8,["modelValue"])])),_:1}),w(p,{label:"确认新密码",prop:"confirmNewPassword"},{default:c((()=>[w(d,{modelValue:v(_).confirmNewPassword,"onUpdate:modelValue":t[2]||(t[2]=e=>v(_).confirmNewPassword=e),type:"password",placeholder:"确认密码",clearable:"","show-password":"",autocomplete:"off"},null,8,["modelValue"])])),_:1}),w(p,null,{default:c((()=>[w(i,{type:"primary",loading:v(h),onClick:E},{default:c((()=>[g("提交")])),_:1},8,["loading"]),w(i,{onClick:k},{default:c((()=>[g("重置")])),_:1})])),_:1})])),_:1},8,["model"])])])),_:1})])}}}),[["__scopeId","data-v-669ebc71"]]);export{V as default};
