import{e,j as a,ba as n,bb as t,_ as o,m as i,af as s,o as r,g as l,h as d,bf as c,bX as m,bY as u,bd as p,bZ as g,b_ as f,bx as h,by as w,b$ as x,c0 as v,c1 as b,c2 as C,b4 as y,bT as E}from"./vendor-ab6a925e.js";import{c as z,a as M,b as S,e as _}from"./common-5f43fc94.js";import{e as j}from"./common-2f951942.js";const D={class:"page h-100"},P=e({__name:"index",setup(e){const P=j(),F=a(),G=new n;let L,T,W,k;G.background=new t("#fff");const A=()=>{const e=F.value;if(!L)return;const a=e.clientWidth,n=e.clientHeight,t=a/n;L.aspect=t,L.updateProjectionMatrix(),T.setSize(a,n)};let R;const H=()=>{R=requestAnimationFrame(H),I(),T.render(G,L)},I=()=>{let e=.001*performance.now();J.position.y=20*Math.sin(e)+5,J.rotation.x=.5*e,J.rotation.z=.51*e,B.material.uniforms.time.value+=1/60},$=o({turbidity:10,rayleigh:2,mieCoefficient:.005,mieDirectionalG:.2,elevation:2,azimuth:180,exposure:null});let q;let B;const N=()=>{const e=new g(1e4,1e4);B=new f(e,{textureWidth:512,textureHeight:512,waterNormals:(new h).load(`${P.oss}/textures/waternormals.jpg`,(e=>{e.wrapS=e.wrapT=w})),sunDirection:new p,sunColor:16777215,waterColor:7695,distortionScale:3.7,fog:void 0!==G.fog}),B.rotation.x=-Math.PI/2,G.add(B)};let O;const X=()=>{O=new x,O.scale.setScalar(1e4),G.add(O)};let Y;const Z=()=>{const e=O.material.uniforms;e.turbidity.value=$.turbidity,e.rayleigh.value=$.rayleigh,e.mieCoefficient.value=$.mieCoefficient,e.mieDirectionalG.value=$.mieDirectionalG;const a=v.degToRad(90-$.elevation),n=v.degToRad($.azimuth);Y.setFromSphericalCoords(1,a,n),O.material.uniforms.sunPosition.value.copy(Y),B.material.uniforms.sunDirection.value.copy(Y).normalize(),G.environment=q.fromScene(O).texture,T.toneMappingExposure=$.exposure};let J;const K=()=>{let e=new b(30,30,30),a=new C({roughness:0,color:1365});J=new y(e,a),G.add(J)},Q=()=>{const e=F.value;T=z(e),L=M(e,1,1e6),k=new c(16777215,1.5),G.add(k),_(16777215,1.5),W=S(L,T),W.maxPolarAngle=.45*Math.PI,W.screenSpacePanning=!1,N(),X(),T.toneMapping=m,T.outputEncoding=void 0,T.toneMappingExposure=1,$.exposure=T.toneMappingExposure,q=new u(T),Y=new p,Z(),K(),(e=>{const a=new E,n=a.addFolder("Sky");n.add($,"turbidity",0,100,.1).name("浑浊").onChange(Z),n.add($,"rayleigh",0,4,.001).name("锐利").onChange(Z),n.add($,"mieCoefficient",0,.1,.001).name("散射系数").onChange(Z),n.add($,"mieDirectionalG",0,1,.001).name("方向").onChange(Z),n.add($,"elevation",0,90,.1).name("高度").onChange(Z),n.add($,"azimuth",-180,180,.1).name("方位").onChange(Z),n.add($,"exposure",0,1,1e-4).name("光晕强度").onChange(Z);const t=a.addFolder("Water"),o=B.material.uniforms;t.add(o.distortionScale,"value",0,100,.1).name("变形尺度"),t.add(o.size,"value",.1,10,.1).name("大小"),a.domElement.style="position: absolute; top: 10px; right: 10px",e.appendChild(a.domElement)})(e)};return i((()=>{Q(),H(),window.addEventListener("resize",A,!1)})),s((()=>{window.addEventListener("resize",A,!1),cancelAnimationFrame(R);try{G.clear(),T.dispose(),T.forceContextLoss(),T.content=null;let e=T.domElement.getContext("webgl");e&&e.getExtension("WEBGL_lose_context").loseContext()}catch(e){}})),(e,a)=>(r(),l("div",D,[d("div",{ref_key:"containerRef",ref:F,class:"container h-100",style:{position:"relative"}},null,512)]))}});export{P as default};
