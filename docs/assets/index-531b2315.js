import{s as e,t,u as a,v as i}from"./element-plus-b235a374.js";import{h as o,r as s,G as r,w as l,f as n,z as d,c,o as u,i as m,K as h,u as p,a as g,O as f,X as v,a8 as x}from"./@vue-a135adea.js";import{u as y,o as w,q as b}from"./@element-plus-53304ce0.js";import{u as j,A as k,b as _}from"./index-2dfdc011.js";import{a as M,u as z}from"./vue-router-c8083132.js";import"./lodash-es-7cdd8bf7.js";import"./async-validator-cf877c1f.js";import"./@vueuse-1c227f78.js";import"./@ctrl-91de2ec7.js";import"./@popperjs-b78c3215.js";import"./pinia-2f66cc81.js";import"./vue-demi-71ba0ef2.js";import"./common-b50db88d.js";import"./nprogress-bb8bbc26.js";import"./@intlify-70f8e63b.js";import"./source-map-cb1fe5b8.js";import"./axios-a8ee11a1.js";import"./vue-i18n-0c7d7e0b.js";import"./vue-8247fce3.js";import"./path-to-regexp-b4f1402b.js";import"./path-browserify-5a9d894f.js";import"./vite-plugin-mock-29454ef3.js";import"./mockjs-c92738cf.js";const C=o({__name:"title",props:{name:String,height:Number,color:{type:String,default:"#ffffff"},size:{type:Number,default:80},mouseRadius:{type:Number,default:30}},setup(e){const t=e,a=window.requestAnimationFrame||window.requestAnimationFrame||window.requestAnimationFrame||window.requestAnimationFrame||window.requestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},i=s("canvasRef"),o={x:null,y:null},m=r({sizeX:2,sizeY:2,oldColor:""}),h=r([]),p=s([]);let g,f,v;const x=()=>{let e=i.value;g=e,f=e.getContext("2d"),g.width=window.innerWidth,g.height=t.height||window.innerHeight;let a=document.createElement("canvas");a.width=600,a.height=200;let o=a.getContext("2d");o.textAlign="center",o.textBaseline="middle",o.font=`bold ${t.size}px 微软雅黑`,o.fillStyle=t.color,o.fillText(t.name||"平台",a.width/2,a.height/2),v=a,y()},y=()=>{b(),j(),z()},w=r({ite:0,start:0,end:0}),b=()=>{h.length=0,p.length=0,p.values=[],w.ite=100,w.start=0,w.end=w.start+w.ite},j=()=>{let e=g,t=v,a=(e.width-t.width)/2,i=(e.height-t.height)/2;f.clearRect(0,0,e.width,e.height),f.drawImage(t,a,i,t.width,t.height);const o=f.getImageData(a,i,t.width,t.height);for(let s=0;s<t.width;s+=m.sizeX)for(let e=0;e<t.height;e+=m.sizeY){const r=4*(e*o.width+s);if(o.data[r+3]>=125){const l=`rgba(${o.data[r]} , ${o.data[r+1]} ,  ${o.data[r+2]} , ${o.data[r+3]})`;let n,d=s+20*Math.random(),c=200*-Math.random()+400,u=t.height/2-40*Math.random()+20;n=u<i+t.height/2?300*Math.random():300*-Math.random(),h.push({x:d+a,y:u+i,ex:s+a,ey:e+i,vx:c,vy:n,color:l,a:1500,width:m.sizeX,height:m.sizeY,stop:!1,checkLength:5,maxCheckTimes:10,checkTimes:0});let p=h[h.length-1];k(p)}}},k=e=>{m.oldColor!=e.color&&(f.fillStyle=e.color,m.oldColor=e.color),f.fillRect(e.x-e.width/2,e.y-e.height/2,e.width,e.height)},_=e=>{"WORD_CANVAS"==e.target.id?(o.x=e.clientX-e.target.getBoundingClientRect().left,o.y=e.clientY-e.target.getBoundingClientRect().top):(o.x=null,o.y=null)};let M=!1;const z=()=>{h.sort(((e,t)=>e.ex-t.ex)),M||(M=!0,C((e=>{if(p.length<h.length){w.end>h.length-1&&(w.end=h.length-1);let e=h.slice(w.start,w.end);p.values=p.values.concat(e),w.start+=w.ite,w.end+=w.ite}p.values.forEach((t=>{R(t,e)}))})))},C=e=>{if("function"==typeof e){let t=16;f.clearRect(0,0,g.width,g.height),e(t),a((()=>{C(e)}))}},R=(e,t)=>{q(e,t),k(e),A(e)},q=(e,t)=>{if(e.stop)e.x=e.ex,e.y=e.ey;else{t/=1e3;const a=e.ex-e.x,i=e.ey-e.y,o=Math.atan(i/a);let s=Math.abs(e.a*Math.cos(o));s=e.x>e.ex?-s:s;let r=Math.abs(e.a*Math.sin(o));r=e.y>e.ey?-r:r,e.vx+=s*t,e.vy+=r*t,e.vx*=.95,e.vy*=.95,e.x+=e.vx*t,e.y+=e.vy*t,Math.abs(e.x-e.ex)<=e.checkLength&&Math.abs(e.y-e.ey)<=e.checkLength?(e.checkTimes++,e.checkTimes>=e.maxCheckTimes&&(e.stop=!0)):e.checkTimes=0}},A=e=>{if(!o.x)return void r();const a=t.mouseRadius,i=Math.sqrt(Math.pow(o.x-e.x,2)+Math.pow(o.y-e.y,2)),s=Math.atan((o.y-e.y)/(o.x-e.x));if(i<a){e.stop=!1,e.checkTimes=0,e.recordX||(e.recordX=e.ex,e.recordY=e.ey),e.a=2e3+1e3*(1-i/a);let t=Math.abs((a-i)*Math.cos(s)),r=Math.abs((a-i)*Math.sin(s));t=o.x>e.x?-t:t,r=o.y>e.y?-r:r,e.ex=e.x+t,e.ey=e.y+r}else r();function r(){e.recordX&&(e.stop=!1,e.checkTimes=0,e.a=1500,e.ex=e.recordX,e.ey=e.recordY,e.recordX=null,e.recordY=null)}};return l(t,(()=>{x()})),n((()=>{window.addEventListener("mousemove",_,!1),x(),window.addEventListener("resize",x,!1)})),d((()=>{window.removeEventListener("mousemove",_),window.removeEventListener("resize",x)})),(e,t)=>(u(),c("canvas",{ref_key:"canvasRef",ref:i,id:"WORD_CANVAS",style:{position:"relative","z-index":"2"}},null,512))}}),R={class:"login-page"},q={class:"login-page__panel flex flex-ac"},A={class:"login-page__left f-x"},V=["src"],T={class:"login-page__right"},X=g("div",{class:"bg"},null,-1),L=g("h1",{class:"title"},[g("span",null,"请登录！")],-1),S=o({__name:"index",setup(o){const n={mounted:e=>{e.querySelector("input").focus()}},d=new URL("/imgs/login-icon.png",self.location).href,S=r({username:"",password:"",code:"",randomStr:""}),E=r({username:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],code:[{required:!0,validator:(e,t,a)=>{!t&&(t=""),""==t?a(new Error("请输入验证码!")):a()},trigger:"blur"}]}),K=s(!1),Y=s(""),$=s({}),F=s(null),N=s(null),O=j(),U=M(),B=z(),D=m((()=>k.base.title));l(U,(({query:e})=>{e&&(Y.value="error"!=e.redirect&&e.redirect||"",$.value=(e=>Object.keys(e).reduce(((t,a)=>("redirect"!==a&&(t[a]=e[a]),t)),{}))(e))}),{immediate:!0});const I=()=>{const e=F.value;e&&e.validate((e=>{e&&O.login(S,N.value).then((e=>{Y.value.indexOf(k.base.domian)<0?B.push({path:Y.value||`${_}/`,query:$.value}):window.location.href=decodeURIComponent(Y.value)}))}))},W=({shiftKey:e,key:t,keyCode:a}={})=>{13!=a?(t&&1===t.length&&(K.value=!!(e&&t>="a"&&t<="z"||!e&&t>="A"&&t<="Z")),"CapsLock"===t&&!0===K.value&&(K.value=!1)):I()};return(o,s)=>{const r=t,l=a,m=i,j=e;return u(),c("div",R,[h(C,{name:p(D),height:200,color:"#ffffff",size:35,"mouse-radius":50},null,8,["name"]),g("div",q,[g("div",A,[g("img",{src:p(d),alt:""},null,8,V)]),g("div",T,[g("div",{class:"login-page--right_form",ref_key:"loadingRef",ref:N},[X,L,h(j,{class:"form",ref_key:"loginRef",ref:F,model:p(S),rules:p(E)},{default:f((()=>[h(l,{prop:"username",key:"username"},{default:f((()=>[v(h(r,{clearable:"",modelValue:p(S).username,"onUpdate:modelValue":s[0]||(s[0]=e=>p(S).username=e),placeholder:"账户",tabindex:"1",size:"large","prefix-icon":p(y),onKeyup:x(I,["enter"])},null,8,["modelValue","prefix-icon","onKeyup"]),[[n]])])),_:1}),h(m,{visible:p(K),content:"大小写锁定",placement:"right",manual:""},{default:f((()=>[h(l,{prop:"password",key:"password"},{default:f((()=>[h(r,{clearable:"",placeholder:"密码",tabindex:"2",modelValue:p(S).password,"onUpdate:modelValue":s[1]||(s[1]=e=>p(S).password=e),type:"password","show-password":"",size:"large","prefix-icon":p(w),onKeyup:W,onBlur:s[2]||(s[2]=e=>K.value=!1)},null,8,["modelValue","prefix-icon"])])),_:1})])),_:1},8,["visible"]),h(l,{prop:"code",key:"code"},{default:f((()=>[h(r,{modelValue:p(S).code,"onUpdate:modelValue":s[3]||(s[3]=e=>p(S).code=e),clearable:"",placeholder:"验证码",maxlength:"6",tabindex:"3",size:"large","prefix-icon":p(b),onKeyup:x(I,["enter"])},null,8,["modelValue","prefix-icon","onKeyup"])])),_:1}),g("div",{class:"btn-wrap"},[g("div",{class:"btn",onClick:I},"login")])])),_:1},8,["model","rules"])],512)])])])}}});export{S as default};
