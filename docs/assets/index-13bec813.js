import{w as e,a as s,t as a,u as o,x as r,s as l}from"./element-plus-b235a374.js";import{u as t,b as d}from"./index-c79856fa.js";import{u as p}from"./vue-router-c8083132.js";import{h as i,r as n,G as m,c as u,K as w,O as c,o as f,a as j,u as v,S as g,be as b,bc as _}from"./@vue-a135adea.js";import{_ as h}from"./common-b50db88d.js";import"./lodash-es-7cdd8bf7.js";import"./async-validator-cf877c1f.js";import"./@vueuse-1c227f78.js";import"./@element-plus-53304ce0.js";import"./@ctrl-91de2ec7.js";import"./@popperjs-b78c3215.js";import"./pinia-2f66cc81.js";import"./vue-demi-71ba0ef2.js";import"./vue-i18n-0c7d7e0b.js";import"./@intlify-70f8e63b.js";import"./source-map-cb1fe5b8.js";import"./vue-8247fce3.js";import"./path-to-regexp-b4f1402b.js";import"./path-browserify-5a9d894f.js";import"./nprogress-bb8bbc26.js";import"./vite-plugin-mock-29454ef3.js";import"./mockjs-c92738cf.js";import"./axios-a8ee11a1.js";const P={class:"content"},y=(e=>(b("data-v-27ad2f5b"),e=e(),_(),e))((()=>j("div",{class:"clearfix"},[j("span",null,"修改密码")],-1))),$={class:"change-pwd"},V=h(i({__name:"index",setup(i){const b=n(null),_=m({password:"",newPassword:"",confirmNewPassword:""}),h=n(!1),V={password:[{required:!0,trigger:"blur",message:"请输入旧密码。"}],newPassword:[{trigger:"blur",required:!0,validator:(e,s,a)=>{if(""===s)a(new Error("请输入密码"));else{const e=b.value;""!==_.confirmNewPassword&&e.validateField("confirmNewPassword"),(s.length<6||s.length>24)&&a(new Error("确保至少包含6个或最多24个字符"));/^(?![a-zA-Z]+$)(?![A-Z0-9]+$)(?![A-Z\W_!@#$%^&*`~()-+=]+$)(?![a-z0-9]+$)(?![a-z\W_!@#$%^&*`~()-+=]+$)(?![0-9\W_!@#$%^&*`~()-+=]+$)[a-zA-Z0-9\W_!@#$%^&*`~()-+=]/.test(s)||a(new Error("密码必须包含数字，特殊字符，小写字母，大写字母其中三项")),s===_.password&&a(new Error("新密码不能与旧密码相同")),a()}}}],confirmNewPassword:[{trigger:"blur",required:!0,validator:(e,s,a)=>{""===s?a(new Error("请再次输入密码")):s!==_.newPassword?a(new Error("两个输入不匹配！")):a()}}]},x=t(),N=p(),k=()=>{b.value.validate((e=>{if(!e)return!1;h.value=!0;const a={..._};x.changePwd(a).then((async()=>{s({type:"success",title:"提示",message:"密码修改成功！"}),await x.logout(),N.push(`${d}/login`)}))}))},E=()=>{b.value.resetFields()};return(s,t)=>{const d=a,p=o,i=r,n=l,m=e;return f(),u("div",P,[w(m,{class:"box-card"},{header:c((()=>[y])),default:c((()=>[j("div",$,[w(n,{ref_key:"formRef",ref:b,model:v(_),rules:V,"status-icon":"","label-position":"top"},{default:c((()=>[w(p,{label:"旧密码",prop:"password"},{default:c((()=>[w(d,{modelValue:v(_).password,"onUpdate:modelValue":t[0]||(t[0]=e=>v(_).password=e),type:"password",placeholder:"旧密码",clearable:"","show-password":"",autocomplete:"off"},null,8,["modelValue"])])),_:1}),w(p,{label:"新密码",prop:"newPassword"},{default:c((()=>[w(d,{modelValue:v(_).newPassword,"onUpdate:modelValue":t[1]||(t[1]=e=>v(_).newPassword=e),type:"password",placeholder:"新密码",clearable:"","show-password":"",autocomplete:"off"},null,8,["modelValue"])])),_:1}),w(p,{label:"确认新密码",prop:"confirmNewPassword"},{default:c((()=>[w(d,{modelValue:v(_).confirmNewPassword,"onUpdate:modelValue":t[2]||(t[2]=e=>v(_).confirmNewPassword=e),type:"password",placeholder:"确认密码",clearable:"","show-password":"",autocomplete:"off"},null,8,["modelValue"])])),_:1}),w(p,null,{default:c((()=>[w(i,{type:"primary",loading:v(h),onClick:k},{default:c((()=>[g("提交")])),_:1},8,["loading"]),w(i,{onClick:E},{default:c((()=>[g("重置")])),_:1})])),_:1})])),_:1},8,["model"])])])),_:1})])}}}),[["__scopeId","data-v-27ad2f5b"]]);export{V as default};
